<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 dplyr에 의한 데이터 다듬기 | R과 통계분석</title>
  <meta name="description" content="null" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 dplyr에 의한 데이터 다듬기 | R과 통계분석" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="null" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 dplyr에 의한 데이터 다듬기 | R과 통계분석" />
  
  <meta name="twitter:description" content="null" />
  

<meta name="author" content="박동련" />


<meta name="date" content="2022-02-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="데이터-입력.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>소개하기</a></li>
<li class="chapter" data-level="1" data-path="r-시작하기.html"><a href="r-시작하기.html"><i class="fa fa-check"></i><b>1</b> R 시작하기</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-시작하기.html"><a href="r-시작하기.html#r의-소개"><i class="fa fa-check"></i><b>1.1</b> R의 소개</a></li>
<li class="chapter" data-level="1.2" data-path="r-시작하기.html"><a href="r-시작하기.html#r의-설치"><i class="fa fa-check"></i><b>1.2</b> R의 설치</a></li>
<li class="chapter" data-level="1.3" data-path="r-시작하기.html"><a href="r-시작하기.html#rstudio의-설치-및-r의-실행"><i class="fa fa-check"></i><b>1.3</b> RStudio의 설치 및 R의 실행</a></li>
<li class="chapter" data-level="1.4" data-path="r-시작하기.html"><a href="r-시작하기.html#작업공간"><i class="fa fa-check"></i><b>1.4</b> 작업공간</a></li>
<li class="chapter" data-level="1.5" data-path="r-시작하기.html"><a href="r-시작하기.html#스크립트-파일의-활용"><i class="fa fa-check"></i><b>1.5</b> 스크립트 파일의 활용</a></li>
<li class="chapter" data-level="1.6" data-path="r-시작하기.html"><a href="r-시작하기.html#section-batch"><i class="fa fa-check"></i><b>1.6</b> 일괄처리</a></li>
<li class="chapter" data-level="1.7" data-path="r-시작하기.html"><a href="r-시작하기.html#section-package"><i class="fa fa-check"></i><b>1.7</b> R의 확장: 패키지</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="r-시작하기.html"><a href="r-시작하기.html#패키지의-종류"><i class="fa fa-check"></i><b>1.7.1</b> 패키지의 종류</a></li>
<li class="chapter" data-level="1.7.2" data-path="r-시작하기.html"><a href="r-시작하기.html#패키지의-설치-및-사용"><i class="fa fa-check"></i><b>1.7.2</b> 패키지의 설치 및 사용</a></li>
<li class="chapter" data-level="1.7.3" data-path="r-시작하기.html"><a href="r-시작하기.html#패키지-tidyverse의-소개"><i class="fa fa-check"></i><b>1.7.3</b> 패키지 tidyverse의 소개</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structure.html"><a href="data-structure.html"><i class="fa fa-check"></i><b>2</b> R 데이터 구조</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structure.html"><a href="data-structure.html#벡터"><i class="fa fa-check"></i><b>2.1</b> 벡터</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-structure.html"><a href="data-structure.html#벡터의-기본-특성"><i class="fa fa-check"></i><b>2.1.1</b> 벡터의 기본 특성</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-structure.html"><a href="data-structure.html#다양한-형태를-갖는-벡터의-생성"><i class="fa fa-check"></i><b>2.1.2</b> 다양한 형태를 갖는 벡터의 생성</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-structure.html"><a href="data-structure.html#문자열을-위한-함수"><i class="fa fa-check"></i><b>2.1.3</b> 문자열을 위한 함수</a></li>
<li class="chapter" data-level="2.1.4" data-path="data-structure.html"><a href="data-structure.html#벡터의-연산"><i class="fa fa-check"></i><b>2.1.4</b> 벡터의 연산</a></li>
<li class="chapter" data-level="2.1.5" data-path="data-structure.html"><a href="data-structure.html#벡터의-비교"><i class="fa fa-check"></i><b>2.1.5</b> 벡터의 비교</a></li>
<li class="chapter" data-level="2.1.6" data-path="data-structure.html"><a href="data-structure.html#벡터의-인덱싱"><i class="fa fa-check"></i><b>2.1.6</b> 벡터의 인덱싱</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-structure.html"><a href="data-structure.html#요인"><i class="fa fa-check"></i><b>2.2</b> 요인</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-structure.html"><a href="data-structure.html#요인의-기본-특성"><i class="fa fa-check"></i><b>2.2.1</b> 요인의 기본 특성</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-structure.html"><a href="data-structure.html#숫자형-벡터를-요인으로-변환"><i class="fa fa-check"></i><b>2.2.2</b> 숫자형 벡터를 요인으로 변환</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-structure.html"><a href="data-structure.html#날짜"><i class="fa fa-check"></i><b>2.3</b> 날짜</a></li>
<li class="chapter" data-level="2.4" data-path="data-structure.html"><a href="data-structure.html#행렬-및-배열"><i class="fa fa-check"></i><b>2.4</b> 행렬 및 배열</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-structure.html"><a href="data-structure.html#행렬과-배열의-기본-특성"><i class="fa fa-check"></i><b>2.4.1</b> 행렬과 배열의 기본 특성</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-structure.html"><a href="data-structure.html#행렬의-연산"><i class="fa fa-check"></i><b>2.4.2</b> 행렬의 연산</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-structure.html"><a href="data-structure.html#데이터-프레임"><i class="fa fa-check"></i><b>2.5</b> 데이터 프레임</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-structure.html"><a href="data-structure.html#데이터-프레임의-생성"><i class="fa fa-check"></i><b>2.5.1</b> 데이터 프레임의 생성</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-structure.html"><a href="data-structure.html#데이터-프레임의-인덱싱"><i class="fa fa-check"></i><b>2.5.2</b> 데이터 프레임의 인덱싱</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-structure.html"><a href="data-structure.html#함수-with"><i class="fa fa-check"></i><b>2.5.3</b> 함수 <code>with()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-structure.html"><a href="data-structure.html#tibble-개선된-형태의-데이터-프레임"><i class="fa fa-check"></i><b>2.6</b> Tibble: 개선된 형태의 데이터 프레임</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data-structure.html"><a href="data-structure.html#tibble-생성"><i class="fa fa-check"></i><b>2.6.1</b> Tibble 생성</a></li>
<li class="chapter" data-level="2.6.2" data-path="data-structure.html"><a href="data-structure.html#tibble과-전통적인-데이터-프레임의-차이"><i class="fa fa-check"></i><b>2.6.2</b> Tibble과 전통적인 데이터 프레임의 차이</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-structure.html"><a href="data-structure.html#section-list"><i class="fa fa-check"></i><b>2.7</b> 리스트</a></li>
<li class="chapter" data-level="2.8" data-path="data-structure.html"><a href="data-structure.html#연습문제"><i class="fa fa-check"></i><b>2.8</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="데이터-입력.html"><a href="데이터-입력.html"><i class="fa fa-check"></i><b>3</b> 데이터 입력</a>
<ul>
<li class="chapter" data-level="3.1" data-path="데이터-입력.html"><a href="데이터-입력.html#텍스트-파일-불러오기-패키지-readr-함수의-활용"><i class="fa fa-check"></i><b>3.1</b> 텍스트 파일 불러오기: 패키지 <code>readr</code> 함수의 활용</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="데이터-입력.html"><a href="데이터-입력.html#함수-read_table로-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.1.1</b> 함수 <code>read_table()</code>로 데이터 파일 불러오기</a></li>
<li class="chapter" data-level="3.1.2" data-path="데이터-입력.html"><a href="데이터-입력.html#함수-read_csv로-csv-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.1.2</b> 함수 <code>read_csv()</code>로 CSV 데이터 파일 불러오기</a></li>
<li class="chapter" data-level="3.1.3" data-path="데이터-입력.html"><a href="데이터-입력.html#함수-read_fwf로-고정-포맷-구조를-갖는-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.1.3</b> 함수 <code>read_fwf()</code>로 고정 포맷 구조를 갖는 데이터 파일 불러오기</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="데이터-입력.html"><a href="데이터-입력.html#excel-파일-불러오기"><i class="fa fa-check"></i><b>3.2</b> Excel 파일 불러오기</a></li>
<li class="chapter" data-level="3.3" data-path="데이터-입력.html"><a href="데이터-입력.html#sas-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.3</b> SAS 데이터 파일 불러오기</a></li>
<li class="chapter" data-level="3.4" data-path="데이터-입력.html"><a href="데이터-입력.html#html-테이블-불러오기"><i class="fa fa-check"></i><b>3.4</b> HTML 테이블 불러오기</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html"><i class="fa fa-check"></i><b>4</b> <code>dplyr</code>에 의한 데이터 다듬기</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#행을-작업-대상으로-하는-함수"><i class="fa fa-check"></i><b>4.1</b> 행을 작업 대상으로 하는 함수</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#조건에-의한-행-선택-filter"><i class="fa fa-check"></i><b>4.1.1</b> 조건에 의한 행 선택: <code>filter()</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#위치에-의한-행-선택-slice-및-그와-관련된-함수"><i class="fa fa-check"></i><b>4.1.2</b> 위치에 의한 행 선택: <code>slice()</code> 및 그와 관련된 함수</a></li>
<li class="chapter" data-level="4.1.3" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#행의-정렬-arrange"><i class="fa fa-check"></i><b>4.1.3</b> 행의 정렬: <code>arrange()</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#중복된-행의-제거-distinct"><i class="fa fa-check"></i><b>4.1.4</b> 중복된 행의 제거: <code>distinct()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#열을-작업-대상으로-하는-함수"><i class="fa fa-check"></i><b>4.2</b> 열을 작업 대상으로 하는 함수</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#열의-선택-select"><i class="fa fa-check"></i><b>4.2.1</b> 열의 선택: <code>select()</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#열-이름-변경-rename과-rename_with"><i class="fa fa-check"></i><b>4.2.2</b> 열 이름 변경: <code>rename()</code>과 <code>rename_with()</code></a></li>
<li class="chapter" data-level="4.2.3" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#열의-위치-변경-relocate"><i class="fa fa-check"></i><b>4.2.3</b> 열의 위치 변경: <code>relocate()</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#새로운-열의-추가-mutate와-transmute"><i class="fa fa-check"></i><b>4.2.4</b> 새로운 열의 추가: <code>mutate()</code>와 <code>transmute()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="dplyr에-의한-데이터-다듬기.html"><a href="dplyr에-의한-데이터-다듬기.html#여러-행-자료의-요약-summarise"><i class="fa fa-check"></i><b>4.3</b> 여러 행 자료의 요약: <code>summarise()</code></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R과 통계분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dplyr에-의한-데이터-다듬기" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> <code>dplyr</code>에 의한 데이터 다듬기</h1>
<p>R에 입력된 데이터 세트는 대부분의 경우 바로 통계분석이 가능한 상태가 아니다. 분석에
필요한 적절한 변수가 없거나, 특정 조건을 만족하는 자료만을 선택해야 하거나, 자료의
순서를 바꿔야 하거나, 그룹별로 자료를 합치거나 또는 나눠야 하는 등등의 작업이 필요한
경우가 대부분이다. 이러한 데이터 다듬기는 최적의 통계 예측모형적합 등을 위해 반드시
필요한 절차이지만, 시간이 매우 많이 소요되는 힘든 작업이다. 따라서 일관된 법칙에 따라 편리하고 효율적으로 적용할 수 있는 데이터 다듬기 기법이 절실하게 필요한 상황이라고 하겠다.</p>
<p>통계 데이터 세트는 변수가 열, 관찰값이 행을 이루고 있는 2차원 구조를 가지고 있으며
데이터 프레임으로 입력된다. 이 장에서 살펴볼 내용은 패키지 <code>dplyr</code>에서 수행할 수 있는
다양한 데이터 프레임 다듬기 기법이다. 먼저 데이터 프레임 다듬기 작업에 사용되는 매우
중요하면서도 기본적인 <code>dplyr</code> 함수들을 살펴볼 것이다. 이어서 이러한 기본 <code>dplyr</code> 함수들
이 그룹으로 구분된 데이터에 대해서는 어떻게 작용을 하는지 살펴볼 것이며, 여러 개의
변수들을 대상으로 반복적으로 실행해야 하는 동일한 작업을 함수 <code>across()</code>를 이용하면
얼마나 간편하게 할 수 있는지를 살펴볼 것이다. 또한 행 단위로 작업이 이루어져야 하는
경우에 함수 <code>rowwise()</code>가 어떤 역할을 하는지도 살펴볼 것이다.</p>
<p>기본 <code>dplyr</code> 함수들은 세 가지 그룹으로 나누어 볼 수 있다. 함수 <code>filter()</code>, <code>slice()</code>,
<code>arrange()</code>, <code>distinct()</code>와 같이 데이터 프레임의 행을 작업 대상으로 하는 함수가 있고,
함수 <code>select()</code>, <code>rename()</code>, <code>mutate()</code>, <code>relocate()</code>와 같이 열을 대상으로 작업을 하는
함수가 있으며, 요약 통계량을 계산하는 함수 <code>summarise()</code>가 있다.</p>
<p>기본 <code>dplyr</code> 함수들이 공통으로 갖고 있는 특징은 데이터 프레임(또는 tibble)이 함수들의 첫 번째 입력요소라는 것이다. 두 번째 특징은 각 함수 안에서 입력된 데이터 프레임의
변수를 인덱싱 기호(<code>$</code>) 없이 사용할 수 있다는 것이다. 마지막 특징은 이 함수들이 생성하는 결과는 또 다른 데이터 프레임(또는 tibble)이라는 것이다. 기본 함수들이 갖고 있는 이러한 특징을 이용해서 조금 더 효율적인 프로그램이 가능하도록 dplyr에서는 pipe 기능을 사용할 수 있다.</p>
<ul>
<li>Pipe 기능</li>
</ul>
<p>Pipe 기능이란 한 명령문의 결과물을 바로 다음 명령문의 입력 요소로 직접 사용할 수 있도록 명령문들을 서로 연결하는 기능을 의미한다. 이것이 가능하다면, 분석 중간 단계로
생성되는 무수한 객체들을 따로 저장할 필요가 없기 때문에 프로그램 자체가 매우 깔끔하게 정리되며, 분석 흐름을 쉽게 이해할 수 있게 된다. Pipe 연산자 <code>%&gt;%</code>는 <code>tidyverse</code>에 속한 패키지인 <code>magrittr</code>에서 정의된 것으로 <code>tidyverse</code>에 속한 다른 패키지에서도 사용이 가능하다. RStudio에서 pipe 연산자 <code>%&gt;%</code>의 입력은 Shift+Ctrl+M 키를 함께 누르면 된다.</p>
<p>기본적인 형태는 <code>lhs %&gt;% rhs</code>인데, <code>lhs</code>는 데이터 객체이거나 데이터 객체를 생성하는
함수가 되고, <code>rhs</code>는 <code>lhs</code>를 입력 요소로 하는 함수가 된다. 예를 들어 <code>x %&gt;% f()</code>는 객체 <code>x</code>를 함수 <code>f()</code>의 입력 요소로 하는 <code>f(x)</code>를 의미한다. 만일 <code>rhs</code>에 다른 요소가 있다면 <code>lhs</code>는
<code>rhs</code>의 첫 번째 입력 요소가 된다. 따라서 <code>x %&gt;% f(y)</code>는 <code>f(x,y)</code>를 의미한다. 만일 <code>lhs</code>가
<code>rhs</code>의 첫 번째 요소가 아닌 경우에는 원하는 위치에 점(.)을 찍어야 한다. 예를 들어, <code>x %&gt;% f(y,.)</code>은 <code>f(y,x)</code>를 의미한다.</p>
<div id="행을-작업-대상으로-하는-함수" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> 행을 작업 대상으로 하는 함수</h2>
<div id="조건에-의한-행-선택-filter" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> 조건에 의한 행 선택: <code>filter()</code></h3>
<p>함수 <code>filter()</code>를 이용하면, 주어진 데이터 프레임에서 특정한 조건을 만족하는 행을 선택
할 수 있다. 조건을 설정할 때는 비교 연산자(<code>&gt;, &gt;=, &lt;, &lt;=, !=, ==</code>)와 논리 연산자(<code>&amp;, |, !</code>)가 사용되며, 연산자 <code>%in%</code>이 매우 유용하게 사용된다.
예제를 통해 자세한 사용법을 확인해 보자.</p>
<ul>
<li>예제: <code>mtcars</code></li>
</ul>
<p>변수 <code>mpg</code>의 값이 30 이상인 자동차를 선택해 보자. 함수 <code>filter()</code>에 전통적인 데이터 프레임을 입력하면 결과로 전통적인 데이터 프레임이 출력되고, tibble을 입력하면 결과가
tibble로 출력된다. 데이터 프레임 <code>mtcars</code>를 tibble로 전환하고 선택 조건과 더불어 함수
<code>filter()</code>에 입력해 보자.</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="dplyr에-의한-데이터-다듬기.html#cb647-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="dplyr에-의한-데이터-다듬기.html#cb648-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mtcars)</span>
<span id="cb648-2"><a href="dplyr에-의한-데이터-다듬기.html#cb648-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mpg <span class="sc">&gt;=</span> <span class="dv">30</span>)</span></code></pre></div>
<pre><code># A tibble: 4 x 11
    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  32.4     4  78.7    66  4.08  2.2   19.5     1     1     4     1
2  30.4     4  75.7    52  4.93  1.62  18.5     1     1     4     2
3  33.9     4  71.1    65  4.22  1.84  19.9     1     1     4     1
4  30.4     4  95.1   113  3.77  1.51  16.9     1     1     5     2</code></pre>
<p>변수 <code>mpg</code>의 값이 30 이상이고 변수 wt의 값이 1.8 미만인 자동차를 선택해 보자.
논리 연산자 <code>&amp;</code> 대신에 콤마(,)를 사용할 수 있다.</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="dplyr에-의한-데이터-다듬기.html#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mpg <span class="sc">&gt;=</span> <span class="dv">30</span>, wt <span class="sc">&lt;</span> <span class="fl">1.8</span>)</span></code></pre></div>
<pre><code># A tibble: 2 x 11
    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  30.4     4  75.7    52  4.93  1.62  18.5     1     1     4     2
2  30.4     4  95.1   113  3.77  1.51  16.9     1     1     5     2</code></pre>
<p>변수 <code>mpg</code>의 값이 30 이하이고, 변수 <code>cyl</code>의 값이 6 또는 8이며, 변수 <code>am</code>의 값이 1인 자동차를 선택해 보자. 이 경우에, 변수 <code>cyl</code>의 값이 6 또는 8인 사건에 대하여 논리 연산자를
사용해서 <code>cyl == 6|cyl == 8</code>으로 조건을 설정하는 것보다는, <code>cyl %in% c(6,8)</code>로 쓰는 것이 훨씬 간단한 방법이 된다.</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="dplyr에-의한-데이터-다듬기.html#cb652-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mpg <span class="sc">&lt;=</span> <span class="dv">30</span>, cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>), am <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code># A tibble: 5 x 11
    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  21       6   160   110  3.9   2.62  16.5     0     1     4     4
2  21       6   160   110  3.9   2.88  17.0     0     1     4     4
3  15.8     8   351   264  4.22  3.17  14.5     0     1     5     4
4  19.7     6   145   175  3.62  2.77  15.5     0     1     5     6
5  15       8   301   335  3.54  3.57  14.6     0     1     5     8</code></pre>
<p>변수 <code>mpg</code>의 값이 <code>mpg</code>의 중앙값과 <span class="math inline">\(Q_{3}\)</span> 사이에 있는 자동차를 선택해 보자.
여기서 <span class="math inline">\(Q_{3}\)</span>는 0.75분위수를 의미하는 것으로서, <span class="math inline">\(p\)</span> 분위수란 전체 데이터 중 <span class="math inline">\((100 \times p)\)</span>%데이터보다는 크고, 나머지 <span class="math inline">\((100 \times (1-p))\)</span>% 데이터보다는 작은 수를 의미한다.
분위수의 계산은 함수 <code>quantile()</code>로 하는데, 벡터 <code>x</code>의 0.75분위수의 계산은 <code>quantile(x, probs=0.75)</code>로 할 수 있다.</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="dplyr에-의한-데이터-다듬기.html#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb654-2"><a href="dplyr에-의한-데이터-다듬기.html#cb654-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">filter</span>(</span>
<span id="cb654-3"><a href="dplyr에-의한-데이터-다듬기.html#cb654-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     mpg <span class="sc">&gt;=</span> <span class="fu">median</span>(mpg), mpg <span class="sc">&lt;=</span> <span class="fu">quantile</span>(mpg, <span class="at">probs =</span> <span class="fl">0.75</span>)</span>
<span id="cb654-4"><a href="dplyr에-의한-데이터-다듬기.html#cb654-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   )</span></code></pre></div>
<pre><code># A tibble: 10 x 11
     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
 6  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
 7  21.5     4  120.    97  3.7   2.46  20.0     1     0     3     1
 8  19.2     8  400    175  3.08  3.84  17.0     0     0     3     2
 9  19.7     6  145    175  3.62  2.77  15.5     0     1     5     6
10  21.4     4  121    109  4.11  2.78  18.6     1     1     4     2</code></pre>
<p>벡터 <code>x</code>가 특정 두 숫자 사이에 있는지를 확인하는 방법은 <code>x &gt;= left &amp; x &lt;= right</code>가 되는데, 이것을 함수 <code>between()</code>을 이용해서 <code>between(x,left,right)</code>로 할 수 있다.</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="dplyr에-의한-데이터-다듬기.html#cb656-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">between</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>[1] FALSE  TRUE  TRUE  TRUE FALSE</code></pre>
<p>따라서 위 예제는 다음과 같이 실행해도 동일한 결과를 얻는다.</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="dplyr에-의한-데이터-다듬기.html#cb658-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb658-2"><a href="dplyr에-의한-데이터-다듬기.html#cb658-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">filter</span>(</span>
<span id="cb658-3"><a href="dplyr에-의한-데이터-다듬기.html#cb658-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     <span class="fu">between</span>(mpg, <span class="fu">median</span>(mpg), <span class="fu">quantile</span>(mpg, <span class="at">probs =</span> <span class="fl">0.75</span>))</span>
<span id="cb658-4"><a href="dplyr에-의한-데이터-다듬기.html#cb658-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>     )</span></code></pre></div>
<pre><code># A tibble: 10 x 11
     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
 6  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
 7  21.5     4  120.    97  3.7   2.46  20.0     1     0     3     1
 8  19.2     8  400    175  3.08  3.84  17.0     0     0     3     2
 9  19.7     6  145    175  3.62  2.77  15.5     0     1     5     6
10  21.4     4  121    109  4.11  2.78  18.6     1     1     4     2</code></pre>
<ul>
<li>예제: <code>airquality</code></li>
</ul>
<p>데이터 프레임 <code>airquality</code>는 1973년 5월부터 9월까지 미국 뉴욕시의 공기의 질과 관련된
조사 결과를 담은 데이터 세트이다. <code>airs</code>라는 이름의 tibble로 전환하고, 처음 5개 케이스
를 출력해 보자.</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="dplyr에-의한-데이터-다듬기.html#cb660-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> airs <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(airquality) <span class="sc">%&gt;%</span> </span>
<span id="cb660-2"><a href="dplyr에-의한-데이터-다듬기.html#cb660-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 153 x 6
  Ozone Solar.R  Wind  Temp Month   Day
  &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1    41     190   7.4    67     5     1
2    36     118   8      72     5     2
3    12     149  12.6    74     5     3
# ... with 150 more rows</code></pre>
<p>변수 <code>Ozone</code> 또는 <code>Solar.R</code>이 결측값인 행을 선택해 보자. 결측값의 확인은 함수
<code>is.na()</code>로 할 수 있다.</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="dplyr에-의한-데이터-다듬기.html#cb662-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> airs <span class="sc">%&gt;%</span> </span>
<span id="cb662-2"><a href="dplyr에-의한-데이터-다듬기.html#cb662-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">filter</span>(<span class="fu">is.na</span>(Ozone) <span class="sc">|</span> <span class="fu">is.na</span>(Solar.R)) <span class="sc">%&gt;%</span> </span>
<span id="cb662-3"><a href="dplyr에-의한-데이터-다듬기.html#cb662-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code># A tibble: 42 x 6
  Ozone Solar.R  Wind  Temp Month   Day
  &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1    NA      NA  14.3    56     5     5
2    28      NA  14.9    66     5     6
3    NA     194   8.6    69     5    10
4     7      NA   6.9    74     5    11
5    NA      66  16.6    57     5    25
# ... with 37 more rows</code></pre>
</div>
<div id="위치에-의한-행-선택-slice-및-그와-관련된-함수" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> 위치에 의한 행 선택: <code>slice()</code> 및 그와 관련된 함수</h3>
<p>위치에 의한 행 선택이란 데이터 프레임에서 선택하고자 하는 행 번호를 지정해서 선택하는 것을 의미한다.</p>
<ul>
<li>함수 <code>slice()</code>에 의한 행 선택</li>
</ul>
<p>함수 <code>slice()</code>에는 행의 번호를 직접 지정해서 특정 행을 선택하거나 제거할 수 있다.
양의 정수를 입력하면 해당 위치의 행이 선택되고, 음의 정수를 입력하면 해당 위치의 행이
제거된다. 입력되는 정수는 모두 양수이거나 모두 음수이어야 한다. 데이터 프레임 <code>iris</code>를
tibble로 전환하고 5번째 행부터 10번째 행까지 선택해 보자.</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="dplyr에-의한-데이터-다듬기.html#cb664-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span>
<span id="cb664-2"><a href="dplyr에-의한-데이터-다듬기.html#cb664-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
1          5           3.6          1.4         0.2 setosa 
2          5.4         3.9          1.7         0.4 setosa 
3          4.6         3.4          1.4         0.3 setosa 
4          5           3.4          1.5         0.2 setosa 
5          4.4         2.9          1.4         0.2 setosa 
6          4.9         3.1          1.5         0.1 setosa </code></pre>
<p>이번에는 5번째 행부터 10번째 행을 제거해 보자.</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="dplyr에-의한-데이터-다듬기.html#cb666-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb666-2"><a href="dplyr에-의한-데이터-다듬기.html#cb666-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">slice</span>(<span class="sc">-</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb666-3"><a href="dplyr에-의한-데이터-다듬기.html#cb666-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 144 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
1          5.1         3.5          1.4         0.2 setosa 
2          4.9         3            1.4         0.2 setosa 
3          4.7         3.2          1.3         0.2 setosa 
# ... with 141 more rows</code></pre>
<p>이번에는 <code>iris</code>의 마지막 행을 선택해 보자. 이 경우 유용하게 사용될 함수가 <code>n()</code>이다.
이 함수는 데이터 프레임의 행의 개수를 세는 함수로서 단독으로는 사용될 수 없고 <code>dplyr</code>
기본 함수들과 함께 사용되어야 한다.</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="dplyr에-의한-데이터-다듬기.html#cb668-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb668-2"><a href="dplyr에-의한-데이터-다듬기.html#cb668-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">slice</span>(<span class="fu">n</span>())</span></code></pre></div>
<pre><code># A tibble: 1 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species  
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;    
1          5.9           3          5.1         1.8 virginica</code></pre>
<ul>
<li>함수 <code>slice_head()</code>와 <code>slice_tail</code>()에 의한 행 선택</li>
</ul>
<p>데이터 프레임의 처음 몇 개 행을 선택하거나 마지막 몇 개 행을 선택하고자 할 때 사용되는 함수이다. 행의 개수를 지정하는 경우에는 <code>n</code>을 사용하고 행의 비율을 지정하는 경우에
는 <code>prop</code>를 사용하면 된다. 데이터 프레임 <code>iris</code>의 처음 3개 행과 마지막 3개 행을 각각 선택해 보자.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="dplyr에-의한-데이터-다듬기.html#cb670-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb670-2"><a href="dplyr에-의한-데이터-다듬기.html#cb670-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
1          5.1         3.5          1.4         0.2 setosa 
2          4.9         3            1.4         0.2 setosa 
3          4.7         3.2          1.3         0.2 setosa </code></pre>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="dplyr에-의한-데이터-다듬기.html#cb672-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb672-2"><a href="dplyr에-의한-데이터-다듬기.html#cb672-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species  
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;    
1          6.5         3            5.2         2   virginica
2          6.2         3.4          5.4         2.3 virginica
3          5.9         3            5.1         1.8 virginica</code></pre>
<ul>
<li>함수 <code>slice_sample()</code>에 의한 행 선택</li>
</ul>
<p>데이터 프레임의 일부 행을 단순임의추출방법으로 선택할 때 사용되는 함수이다.
행의 개수를 지정해서 추출하는 경우에는 <code>n</code>을 사용하고, 행의 비율을 지정해서 추출하는 경우에는 <code>prop</code>를 사용하면 된다.
두 함수 모두 비복원추출이 디폴트로 적용되며, 만일 복원추출을 원한다면, <code>replace=TRUE</code>를 입력하면 된다.
데이터 프레임 <code>iris</code>에서 3개 행을 임의추출해 보자. 또한 전체 행 중 2%의 행을 비복원추출과 복원추출로 각각 선택해 보자.</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="dplyr에-의한-데이터-다듬기.html#cb674-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb674-2"><a href="dplyr에-의한-데이터-다듬기.html#cb674-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species   
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;     
1          6           2.9          4.5         1.5 versicolor
2          5.7         2.9          4.2         1.3 versicolor
3          5.5         2.5          4           1.3 versicolor</code></pre>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="dplyr에-의한-데이터-다듬기.html#cb676-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb676-2"><a href="dplyr에-의한-데이터-다듬기.html#cb676-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species   
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;     
1          6.7         3.3          5.7         2.5 virginica 
2          6.4         3.2          5.3         2.3 virginica 
3          5.4         3            4.5         1.5 versicolor</code></pre>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="dplyr에-의한-데이터-다듬기.html#cb678-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb678-2"><a href="dplyr에-의한-데이터-다듬기.html#cb678-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.02</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species   
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;     
1          5           2.3          3.3         1   versicolor
2          7.2         3            5.8         1.6 virginica 
3          5.9         3            5.1         1.8 virginica </code></pre>
<ul>
<li>함수 <code>slice_max()</code>와 <code>slice_min()</code>에 의한 행 선택</li>
</ul>
<p>특정 변수가 가장 큰 값을 갖거나 혹은 가장 작은 값을 갖는 행을 선택할 때 사용되는
함수이다. 기준으로 사용할 변수를 입력하고 이어서 행의 개수를 지정하는 경우에는 <code>n</code>을,
행의 비율을 지정하는 경우에는 <code>prop</code>를 입력하면 된다. 데이터 프레임 <code>iris</code>에서 변수
<code>Sepal.Width</code>의 값이 가장 큰 두 개 행을 선택해 보자.</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="dplyr에-의한-데이터-다듬기.html#cb680-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb680-2"><a href="dplyr에-의한-데이터-다듬기.html#cb680-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">slice_max</span>(Sepal.Width, <span class="at">n =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code># A tibble: 2 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
1          5.7         4.4          1.5         0.4 setosa 
2          5.5         4.2          1.4         0.2 setosa </code></pre>
<p>이번에는 <code>Petal.Length</code>의 값이 가장 작은 두 개 행을 선택해 보자.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="dplyr에-의한-데이터-다듬기.html#cb682-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb682-2"><a href="dplyr에-의한-데이터-다듬기.html#cb682-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">slice_min</span>(Petal.Length, <span class="at">n =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code># A tibble: 2 x 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
1          4.6         3.6          1           0.2 setosa 
2          4.3         3            1.1         0.1 setosa </code></pre>
</div>
<div id="행의-정렬-arrange" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> 행의 정렬: <code>arrange()</code></h3>
<p>함수 <code>arrange()</code>는 특정 변수를 기준으로 데이터 프레임의 행을 재배열할 때 사용된다.
함수에는 정렬의 기준이 되는 변수를 입력하면 되는데, 2개 이상의 정렬 기준 변수를 입력하게 되면 추가된 변수는 앞선 변수가 같은 값을 갖는 행들의 정렬 기준으로 사용된다.
정렬은 오름차순이 디폴트이며, 내림차순으로 배열하고자 할 때에는 기준 변수를
함수 <code>desc()</code>와 함께 사용해야 한다.</p>
<ul>
<li>예제: <code>mtcars</code></li>
</ul>
<p>데이터 프레임 <code>mtcars</code>를 tibble로 전환하고 변수 <code>mpg</code>의 값이 좋지 않은 자동차 순서로
다시 배열해 보자. 연비가 좋지 않다는 것은 연비가 낮다는 것을 의미하는 것이므로 변수
<code>mpg</code>를 오름차순 정렬 변수로 사용하면 된다.</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="dplyr에-의한-데이터-다듬기.html#cb684-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mtcars)</span>
<span id="cb684-2"><a href="dplyr에-의한-데이터-다듬기.html#cb684-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb684-3"><a href="dplyr에-의한-데이터-다듬기.html#cb684-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">arrange</span>(mpg)</span></code></pre></div>
<pre><code># A tibble: 32 x 11
     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  10.4     8  472    205  2.93  5.25  18.0     0     0     3     4
 2  10.4     8  460    215  3     5.42  17.8     0     0     3     4
 3  13.3     8  350    245  3.73  3.84  15.4     0     0     3     4
 4  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 5  14.7     8  440    230  3.23  5.34  17.4     0     0     3     4
 6  15       8  301    335  3.54  3.57  14.6     0     1     5     8
 7  15.2     8  276.   180  3.07  3.78  18       0     0     3     3
 8  15.2     8  304    150  3.15  3.44  17.3     0     0     3     2
 9  15.5     8  318    150  2.76  3.52  16.9     0     0     3     2
10  15.8     8  351    264  4.22  3.17  14.5     0     1     5     4
# ... with 22 more rows</code></pre>
<p>데이터 프레임 <code>mtcars_t</code>를 변수 <code>mpg</code>의 값이 좋지 않은 자동차 순서로 다시 배열을
하되, <code>mpg</code> 값이 같은 자동차의 경우에는 변수 <code>wt</code>의 값이 높은 자동차부터 배열해 보자.
변수 <code>wt</code>를 두 번째 정렬 기준 변수로 입력하되, 내림차순 정렬이 필요하므로 함수 <code>desc()</code>를
이용한다.</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="dplyr에-의한-데이터-다듬기.html#cb686-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb686-2"><a href="dplyr에-의한-데이터-다듬기.html#cb686-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">arrange</span>(mpg, <span class="fu">desc</span>(wt))</span></code></pre></div>
<pre><code># A tibble: 32 x 11
     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  10.4     8  460    215  3     5.42  17.8     0     0     3     4
 2  10.4     8  472    205  2.93  5.25  18.0     0     0     3     4
 3  13.3     8  350    245  3.73  3.84  15.4     0     0     3     4
 4  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 5  14.7     8  440    230  3.23  5.34  17.4     0     0     3     4
 6  15       8  301    335  3.54  3.57  14.6     0     1     5     8
 7  15.2     8  276.   180  3.07  3.78  18       0     0     3     3
 8  15.2     8  304    150  3.15  3.44  17.3     0     0     3     2
 9  15.5     8  318    150  2.76  3.52  16.9     0     0     3     2
10  15.8     8  351    264  4.22  3.17  14.5     0     1     5     4
# ... with 22 more rows</code></pre>
<ul>
<li>예제: <code>airquality</code></li>
</ul>
<p>데이터 프레임 <code>airquality</code>를 tibble로 전환하고, 5월 1일부터 5월 10일까지의 자료만을
대상으로 변수 <code>Ozone</code>의 값이 가장 낮았던 날부터 다시 배열해 보자.</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="dplyr에-의한-데이터-다듬기.html#cb688-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> airs_1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(airquality) <span class="sc">%&gt;%</span>  </span>
<span id="cb688-2"><a href="dplyr에-의한-데이터-다듬기.html#cb688-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">filter</span>(Month <span class="sc">==</span> <span class="dv">5</span>, Day <span class="sc">&lt;=</span> <span class="dv">10</span>) </span>
<span id="cb688-3"><a href="dplyr에-의한-데이터-다듬기.html#cb688-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> airs_1 <span class="sc">%&gt;%</span> </span>
<span id="cb688-4"><a href="dplyr에-의한-데이터-다듬기.html#cb688-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">arrange</span>(Ozone)</span></code></pre></div>
<pre><code># A tibble: 10 x 6
   Ozone Solar.R  Wind  Temp Month   Day
   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1     8      19  20.1    61     5     9
 2    12     149  12.6    74     5     3
 3    18     313  11.5    62     5     4
 4    19      99  13.8    59     5     8
 5    23     299   8.6    65     5     7
 6    28      NA  14.9    66     5     6
 7    36     118   8      72     5     2
 8    41     190   7.4    67     5     1
 9    NA      NA  14.3    56     5     5
10    NA     194   8.6    69     5    10</code></pre>
<p>위의 정렬 결과를 보면 변수 <code>Ozone</code>이 결측값인 행이 가장 뒤로 배열되어 있다. 이것이
문제는 아니지만, 어떤 경우에는 결측값인 행을 가장 앞으로 배열하는 것이 필요할 때도
있다. 데이터 프레임 <code>airs_1</code>을 변수 <code>Ozone</code>이 결측값인 행부터 다시 배열해 보자. 이것은
배열 기준으로 논리형 벡터를 사용해야 되는 문제인데, <code>TRUE</code>와 <code>FALSE</code>의 배열에서 <code>FALSE</code>가
우선 순위에 있기 때문에 <code>!is.na(Ozone)</code>을 배열 기준으로 사용하면 된다.</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="dplyr에-의한-데이터-다듬기.html#cb690-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> airs_1 <span class="sc">%&gt;%</span> </span>
<span id="cb690-2"><a href="dplyr에-의한-데이터-다듬기.html#cb690-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">arrange</span>(<span class="sc">!</span><span class="fu">is.na</span>(Ozone))</span></code></pre></div>
<pre><code># A tibble: 10 x 6
   Ozone Solar.R  Wind  Temp Month   Day
   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1    NA      NA  14.3    56     5     5
 2    NA     194   8.6    69     5    10
 3    41     190   7.4    67     5     1
 4    36     118   8      72     5     2
 5    12     149  12.6    74     5     3
 6    18     313  11.5    62     5     4
 7    28      NA  14.9    66     5     6
 8    23     299   8.6    65     5     7
 9    19      99  13.8    59     5     8
10     8      19  20.1    61     5     9</code></pre>
<p>이번에는 데이터 프레임 <code>airs_1</code>을 변수 <code>Ozone</code>의 값이 가장 높은 날부터 다시 배열하되
결측값이 있는 행을 가장 앞으로 배열해 보자.
이때는 <code>!is.na(Ozone)</code>을 첫 번째 배열 기준으로 하여 결측값이 있는 행을 가장 앞으로 배치하고, <code>desc(Ozone)</code>을 두 번째 배열 기준으로 입력해서 결측값이 아닌 행들을 변수 <code>Ozone</code>의 내림차순으로 다시 배열해야 된다.</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="dplyr에-의한-데이터-다듬기.html#cb692-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> airs_1 <span class="sc">%&gt;%</span> </span>
<span id="cb692-2"><a href="dplyr에-의한-데이터-다듬기.html#cb692-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">arrange</span>(<span class="sc">!</span><span class="fu">is.na</span>(Ozone), <span class="fu">desc</span>(Ozone))</span></code></pre></div>
<pre><code># A tibble: 10 x 6
   Ozone Solar.R  Wind  Temp Month   Day
   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1    NA      NA  14.3    56     5     5
 2    NA     194   8.6    69     5    10
 3    41     190   7.4    67     5     1
 4    36     118   8      72     5     2
 5    28      NA  14.9    66     5     6
 6    23     299   8.6    65     5     7
 7    19      99  13.8    59     5     8
 8    18     313  11.5    62     5     4
 9    12     149  12.6    74     5     3
10     8      19  20.1    61     5     9</code></pre>
</div>
<div id="중복된-행의-제거-distinct" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> 중복된 행의 제거: <code>distinct()</code></h3>
<p>함수 <code>distinct()</code>는 중복 입력된 행을 제거할 때 사용된다.
함수에는 중복 여부를 결정할 변수를 입력하면 되는데, 입력한 변수가 없다면 모든 변수들을 대상으로 중복 여부를 결정한다.
옵션 <code>.keep_all=TRUE</code>가 지정되면 데이터 프레임의 모든 변수가 유지되는데,
이 경우에는 중복된 행 중에 처음 나타난 행이 유지된다.
단순한 형태의 데이터 프레임으로 함수 <code>distinct()</code>의 작동 방식을 살펴보자.</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="dplyr에-의한-데이터-다듬기.html#cb694-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">times =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">x1 =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb694-2"><a href="dplyr에-의한-데이터-다듬기.html#cb694-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df1</span></code></pre></div>
<pre><code># A tibble: 9 x 2
     id    x1
  &lt;int&gt; &lt;int&gt;
1     1     1
2     1     2
3     2     1
4     2     2
5     2     3
6     3     1
7     3     2
8     3     3
9     3     4</code></pre>
<p>변수 <code>id</code>가 중복되지 않은 행들을 선택해 보자. 중복된 행 중에 처음 나타난 행이 유지됨을 알 수 있다.</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="dplyr에-의한-데이터-다듬기.html#cb696-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df1 <span class="sc">%&gt;%</span> </span>
<span id="cb696-2"><a href="dplyr에-의한-데이터-다듬기.html#cb696-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 2
     id    x1
  &lt;int&gt; &lt;int&gt;
1     1     1
2     2     1
3     3     1</code></pre>
<p>변수 <code>id</code>가 중복된 행 중에 첫 번째 위치한 행이 아닌, 변수 x1이 가장 큰 값을 갖는 행을 선택해 보자.
이 문제는 변수 <code>id</code>가 중복된 행들을 변수 <code>x1</code>의 내림차순으로 정렬한 데이터 프레임을 대상으로 중복된 행을 제거하면 된다.</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="dplyr에-의한-데이터-다듬기.html#cb698-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df1 <span class="sc">%&gt;%</span> </span>
<span id="cb698-2"><a href="dplyr에-의한-데이터-다듬기.html#cb698-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">arrange</span>(id, <span class="fu">desc</span>(x1)) <span class="sc">%&gt;%</span> </span>
<span id="cb698-3"><a href="dplyr에-의한-데이터-다듬기.html#cb698-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 2
     id    x1
  &lt;int&gt; &lt;int&gt;
1     1     2
2     2     3
3     3     4</code></pre>
<p>함수 <code>distinct()</code>로 모든 변수의 값이 중복된 행을 제거하는 예제를 살펴보자.</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="dplyr에-의한-데이터-다듬기.html#cb700-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">2</span>), <span class="at">x1 =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb700-2"><a href="dplyr에-의한-데이터-다듬기.html#cb700-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df2</span></code></pre></div>
<pre><code># A tibble: 6 x 2
     id    x1
  &lt;int&gt; &lt;dbl&gt;
1     1     2
2     1     2
3     2     3
4     2     1
5     3     4
6     3     4</code></pre>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="dplyr에-의한-데이터-다듬기.html#cb702-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df2 <span class="sc">%&gt;%</span> </span>
<span id="cb702-2"><a href="dplyr에-의한-데이터-다듬기.html#cb702-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">distinct</span>()</span></code></pre></div>
<pre><code># A tibble: 4 x 2
     id    x1
  &lt;int&gt; &lt;dbl&gt;
1     1     2
2     2     3
3     2     1
4     3     4</code></pre>
</div>
</div>
<div id="열을-작업-대상으로-하는-함수" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> 열을 작업 대상으로 하는 함수</h2>
<div id="열의-선택-select" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> 열의 선택: <code>select()</code></h3>
<p>데이터 세트의 크기가 커짐에 따라 변수의 개수가 수백 또는 수천이 되는 경우를 접하는
것이 더 이상 드문 상황은 아니다.
이러한 경우, 분석에 필요한 변수를 선택하여 데이터 세트의 크기를 줄이는 것은 매우 중요한 작업이 된다.
함수 <code>select()</code>에서는 패키지 <code>tidyselect</code>에 의해 구현되는 효과적인 변수 선택 방법을 이용할 수 있다.
여기에서 작동되는 <code>&lt;tidy-select&gt;</code> 방식은 기본적으로 변수들의 집합을 구성하는 것으로 생각하면 된다.
구체적인 선택 방법은 열 번호 또는 열 이름에 의한 방법과 변수의 유형에 의한 방법, 그리고 변
수 선택과 관련된 몇몇 함수들을 이용하는 방법으로 구분할 수 있다.</p>
<ol style="list-style-type: decimal">
<li>열 번호(또는 열 이름)에 의한 선택</li>
</ol>
<p>가장 기본적인 방법은 열 번호를 콤마로 구분하여 나열하는 것이다. 이렇게 나열된 열들은 차례로 합집합을 구성하여 포함된 모든 열을 선택하게 된다.
연속된 열 변호는 콜론(:) 연산자를 이용해서 나타낼 수 있다.</p>
<p>예제로서 데이터 프레임 <code>mtcars</code>의 행 이름을 변수 <code>row.name</code>으로 추가하고 tibble로 전환해 보자.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="dplyr에-의한-데이터-다듬기.html#cb704-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb704-2"><a href="dplyr에-의한-데이터-다듬기.html#cb704-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;row.name&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb704-3"><a href="dplyr에-의한-데이터-다듬기.html#cb704-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb704-4"><a href="dplyr에-의한-데이터-다듬기.html#cb704-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 32 x 12
  row.name       mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Mazda RX4     21       6   160   110  3.9   2.62  16.5     0     1     4     4
2 Mazda RX4 W~  21       6   160   110  3.9   2.88  17.0     0     1     4     4
3 Datsun 710    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
# ... with 29 more rows</code></pre>
<p>이어서 첫 번째에서 세 번째 변수, 그리고 일곱 번째 변수를 선택해 보자. 이 경우에는
열 번호를 함수 <code>c()</code> 없이 그냥 나열해도 결과는 동일하다.</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="dplyr에-의한-데이터-다듬기.html#cb706-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb706-2"><a href="dplyr에-의한-데이터-다듬기.html#cb706-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span>)</span></code></pre></div>
<pre><code># A tibble: 32 x 4
   row.name            mpg   cyl    wt
   &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4          21       6  2.62
 2 Mazda RX4 Wag      21       6  2.88
 3 Datsun 710         22.8     4  2.32
 4 Hornet 4 Drive     21.4     6  3.22
 5 Hornet Sportabout  18.7     8  3.44
 6 Valiant            18.1     6  3.46
 7 Duster 360         14.3     8  3.57
 8 Merc 240D          24.4     4  3.19
 9 Merc 230           22.8     4  3.15
10 Merc 280           19.2     6  3.44
# ... with 22 more rows</code></pre>
<p>열(변수) 이름은 열 번호와 같은 취급을 받는다. 따라서 다음 방법도 같은 결과를 생성한다.</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="dplyr에-의한-데이터-다듬기.html#cb708-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb708-2"><a href="dplyr에-의한-데이터-다듬기.html#cb708-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(row.name<span class="sc">:</span>cyl, wt)</span></code></pre></div>
<pre><code># A tibble: 32 x 4
   row.name            mpg   cyl    wt
   &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4          21       6  2.62
 2 Mazda RX4 Wag      21       6  2.88
 3 Datsun 710         22.8     4  2.32
 4 Hornet 4 Drive     21.4     6  3.22
 5 Hornet Sportabout  18.7     8  3.44
 6 Valiant            18.1     6  3.46
 7 Duster 360         14.3     8  3.57
 8 Merc 240D          24.4     4  3.19
 9 Merc 230           22.8     4  3.15
10 Merc 280           19.2     6  3.44
# ... with 22 more rows</code></pre>
<p>열을 제거하고자 하는 경우에는 논리 부정 연산자(!) 또는 마이너스(-) 연산자를 사용해야
한다. 함수 <code>c()</code> 안에 제거하고자 하는 열 번호를 나열하고 논리 부정 연산자를 그 앞에 붙이면 나열된 열로 이루어진 집합의 여집합을 구성하는 것이므로 결과적으로 해당되는 열들이 제거되는 것이다. 첫 번째에서 세 번째 변수, 그리고 일곱 번째 변수를 제거해 보자.</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="dplyr에-의한-데이터-다듬기.html#cb710-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb710-2"><a href="dplyr에-의한-데이터-다듬기.html#cb710-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span>))</span></code></pre></div>
<pre><code># A tibble: 32 x 8
    disp    hp  drat  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  160    110  3.9   16.5     0     1     4     4
 2  160    110  3.9   17.0     0     1     4     4
 3  108     93  3.85  18.6     1     1     4     1
 4  258    110  3.08  19.4     1     0     3     1
 5  360    175  3.15  17.0     0     0     3     2
 6  225    105  2.76  20.2     1     0     3     1
 7  360    245  3.21  15.8     0     0     3     4
 8  147.    62  3.69  20       1     0     4     2
 9  141.    95  3.92  22.9     1     0     4     2
10  168.   123  3.92  18.3     1     0     4     4
# ... with 22 more rows</code></pre>
<p>마이너스 연산자는 차집합을 구성하게 된다. 예컨대 <code>select(1:4, -1)</code>은 처음 네 변수
중 첫 번째 변수를 제거하라는 의미가 된다. 그러나 만일 <code>select(1:4, !1)</code>과 같이 논리
부정 연산자를 대신 사용하면 처음 네 변수와 첫 번째 변수를 제외한 나머지 변수와의 합
집합을 구성하는 것이 되어서 결국 모든 변수를 다 선택하게 된다.</p>
<p>비록 두 연산자의 의미는 다르지만, 마이너스 연산자가 첫 번째로 입력되면 같은 효과를
볼 수 있다. 따라서 첫 번째에서 세 번째 변수, 그리고 일곱 번째 변수의 제거는 다음과 같이 할 수도 있다.</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="dplyr에-의한-데이터-다듬기.html#cb712-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb712-2"><a href="dplyr에-의한-데이터-다듬기.html#cb712-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span>))</span></code></pre></div>
<pre><code># A tibble: 32 x 8
    disp    hp  drat  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  160    110  3.9   16.5     0     1     4     4
 2  160    110  3.9   17.0     0     1     4     4
 3  108     93  3.85  18.6     1     1     4     1
 4  258    110  3.08  19.4     1     0     3     1
 5  360    175  3.15  17.0     0     0     3     2
 6  225    105  2.76  20.2     1     0     3     1
 7  360    245  3.21  15.8     0     0     3     4
 8  147.    62  3.69  20       1     0     4     2
 9  141.    95  3.92  22.9     1     0     4     2
10  168.   123  3.92  18.3     1     0     4     4
# ... with 22 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>변수 유형에 의한 선택</li>
</ol>
<p>특정 유형의 변수를 선택해야 하는 경우 유용하게 사용할 수 있는 방법이다.
변수의 유형 파악은 함수 <code>is.numeric()</code> 또는 <code>is.character()</code> 등 <code>is.*()</code> 형태의 함수로 할 수 있다.
이러한 함수들은 결과가 <code>TRUE</code> 또는 <code>FALSE</code> 중 하나가 되는데, 이런 함수를 <code>predicate</code> 함수라고 한다. 변수 유형에 의한 선택이란 함수 <code>where()</code> 안에 특정 <code>predicate</code> 함수를 입력해서 그 결과가 <code>TRUE</code>가 되는 변수를 선택하는 방법이다.</p>
<p>패키지 <code>ggplot2</code>의 데이터 프레임 <code>mpg</code>를 살펴보자.</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="dplyr에-의한-데이터-다듬기.html#cb714-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mpg <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 234 x 11
  manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class 
  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa~
2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa~
3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa~
# ... with 231 more rows</code></pre>
<p>데이터 프레임 <code>mpg</code>에서 숫자형 변수만 선택해 보자.</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="dplyr에-의한-데이터-다듬기.html#cb716-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb716-2"><a href="dplyr에-의한-데이터-다듬기.html#cb716-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span></code></pre></div>
<pre><code># A tibble: 234 x 5
   displ  year   cyl   cty   hwy
   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1   1.8  1999     4    18    29
 2   1.8  1999     4    21    29
 3   2    2008     4    20    31
 4   2    2008     4    21    30
 5   2.8  1999     6    16    26
 6   2.8  1999     6    18    26
 7   3.1  2008     6    18    27
 8   1.8  1999     4    18    26
 9   1.8  1999     4    16    25
10   2    2008     4    20    28
# ... with 224 more rows</code></pre>
<p>몇 가지 변수 유형을 함께 고려해야 하는 경우에는 논리 연산자 <code>&amp;</code>와 <code>|</code>을 사용하게 된다.</p>
<p>예를 들어 숫자형 변수이거나 문자형 변수의 선택은 다음과 같다.</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="dplyr에-의한-데이터-다듬기.html#cb718-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb718-2"><a href="dplyr에-의한-데이터-다듬기.html#cb718-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">|</span> <span class="fu">where</span>(is.character))</span></code></pre></div>
<pre><code># A tibble: 234 x 11
   displ  year   cyl   cty   hwy manufacturer model      trans drv   fl    class
   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1   1.8  1999     4    18    29 audi         a4         auto~ f     p     comp~
 2   1.8  1999     4    21    29 audi         a4         manu~ f     p     comp~
 3   2    2008     4    20    31 audi         a4         manu~ f     p     comp~
 4   2    2008     4    21    30 audi         a4         auto~ f     p     comp~
 5   2.8  1999     6    16    26 audi         a4         auto~ f     p     comp~
 6   2.8  1999     6    18    26 audi         a4         manu~ f     p     comp~
 7   3.1  2008     6    18    27 audi         a4         auto~ f     p     comp~
 8   1.8  1999     4    18    26 audi         a4 quattro manu~ 4     p     comp~
 9   1.8  1999     4    16    25 audi         a4 quattro auto~ 4     p     comp~
10   2    2008     4    20    28 audi         a4 quattro manu~ 4     p     comp~
# ... with 224 more rows</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>변수 선택과 관련된 함수의 이용</li>
</ol>
<p>변수 선택에 매우 유용하게 사용되는 함수들이 있다. 먼저 특정 위치의 열을 선택할 때
사용할 수 있는 함수들이다.</p>
<ul>
<li><p><code>everything()</code> : 모든 변수 선택</p></li>
<li><p><code>last_col()</code> : 마지막 변수 선택</p></li>
</ul>
<p>변수 이름을 구성하고 있는 문자열에 대한 매칭 작업으로 변수를 선택할 때 사용할 수
있는 함수들이다.</p>
<ul>
<li><p><code>starts_with("x")</code>: 이름이 <code>x</code>로 시작하는 변수 선택</p></li>
<li><p><code>ends_with("x")</code>: 이름이 <code>x</code>로 끝나는 변수 선택</p></li>
<li><p><code>contains("x")</code>: 이름에 <code>x</code>가 있는 변수 선택</p></li>
<li><p><code>num_range("x", 1:10)</code>: <code>x1</code>, <code>x2</code>, … , <code>x10</code>과 동일</p></li>
</ul>
<p>변수 이름이 입력된 문자형 벡터를 이용하여 변수를 선택할 때 사용할 수 있는 함수들
이다.</p>
<ul>
<li><p><code>all_of(vec)</code>: 문자형 벡터 <code>vec</code>에 이름이 입력된 변수 선택. 해당 데이터 프레임에 없는 변수 이름이 <code>vec</code>에 입력되어 있으면 오류 발생.</p></li>
<li><p><code>any_of(vec)</code>: 함수 <code>all_of()</code>와 동일함. 단, 데이터 프레임에 없는 변수 이름이 입력
되어도 오류가 발생하지 않음.</p></li>
</ul>
<p>예제로 데이터 프레임 <code>mtcars_t</code>에서 첫 번째 변수와 마지막 변수를 선택해 보자.</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="dplyr에-의한-데이터-다듬기.html#cb720-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb720-2"><a href="dplyr에-의한-데이터-다듬기.html#cb720-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="dv">1</span>, <span class="fu">last_col</span>())</span></code></pre></div>
<pre><code># A tibble: 32 x 2
   row.name           carb
   &lt;chr&gt;             &lt;dbl&gt;
 1 Mazda RX4             4
 2 Mazda RX4 Wag         4
 3 Datsun 710            1
 4 Hornet 4 Drive        1
 5 Hornet Sportabout     2
 6 Valiant               1
 7 Duster 360            4
 8 Merc 240D             2
 9 Merc 230              2
10 Merc 280              4
# ... with 22 more rows</code></pre>
<p>이번에는 <code>mtcars_t</code>에서 이름이 <code>m</code>으로 시작하는 변수를 선택해 보자.</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="dplyr에-의한-데이터-다듬기.html#cb722-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb722-2"><a href="dplyr에-의한-데이터-다듬기.html#cb722-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;m&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 32 x 1
     mpg
   &lt;dbl&gt;
 1  21  
 2  21  
 3  22.8
 4  21.4
 5  18.7
 6  18.1
 7  14.3
 8  24.4
 9  22.8
10  19.2
# ... with 22 more rows</code></pre>
<p>이름이 <code>p</code>로 끝나는 변수도 선택해 보자.</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="dplyr에-의한-데이터-다듬기.html#cb724-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb724-2"><a href="dplyr에-의한-데이터-다듬기.html#cb724-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;p&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 32 x 2
    disp    hp
   &lt;dbl&gt; &lt;dbl&gt;
 1  160    110
 2  160    110
 3  108     93
 4  258    110
 5  360    175
 6  225    105
 7  360    245
 8  147.    62
 9  141.    95
10  168.   123
# ... with 22 more rows</code></pre>
<p>이름에 <code>A</code>가 있는 변수를 선택해 보자.</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="dplyr에-의한-데이터-다듬기.html#cb726-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb726-2"><a href="dplyr에-의한-데이터-다듬기.html#cb726-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;A&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 32 x 5
   row.name           drat    am  gear  carb
   &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4          3.9      1     4     4
 2 Mazda RX4 Wag      3.9      1     4     4
 3 Datsun 710         3.85     1     4     1
 4 Hornet 4 Drive     3.08     0     3     1
 5 Hornet Sportabout  3.15     0     3     2
 6 Valiant            2.76     0     3     1
 7 Duster 360         3.21     0     3     4
 8 Merc 240D          3.69     0     4     2
 9 Merc 230           3.92     0     4     2
10 Merc 280           3.92     0     4     4
# ... with 22 more rows</code></pre>
<p>대문자 <code>A</code>가 이름에 있는 변수 선택을 요구했지만, 결과는 모두 소문자 <code>a</code>가 이름에
있는 변수가 선택되었다. 이런 결과가 나온 이유는 옵션 <code>ignore.case = TRUE</code>가 디폴트로
설정되어서 대문자와 소문자를 구분하지 않기 때문이다. 이 옵션은 함수 <code>starts_with()</code>와
<code>ends_with()</code>에도 동일하게 <code>TRUE</code>가 디폴트이다.
만일 대문자를 구분해서 문자열 매칭 작업을 하면 다음과 같이 해당되는 변수가 없다는 결과가 나온다.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="dplyr에-의한-데이터-다듬기.html#cb728-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb728-2"><a href="dplyr에-의한-데이터-다듬기.html#cb728-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;A&quot;</span>, <span class="at">ignore.case =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code># A tibble: 32 x 0</code></pre>
<p>문자형 벡터 <code>vars</code>에 다음과 같이 변수 이름을 입력해 보자. 앞에서 생성된 데이터 프레임 <code>mtcars_t</code>에는 변수 <code>mpg</code>와 <code>wt</code>는 있지만, 변수 <code>model</code>은 없는 상태이다.</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="dplyr에-의한-데이터-다듬기.html#cb730-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;model&quot;</span>, <span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;wt&quot;</span>)</span></code></pre></div>
<p>함수 <code>any_of()</code>를 사용하면 <code>mtcars_t</code>에 있는 두 변수가 선택된다.</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="dplyr에-의한-데이터-다듬기.html#cb731-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb731-2"><a href="dplyr에-의한-데이터-다듬기.html#cb731-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="fu">any_of</span>(vars))</span></code></pre></div>
<pre><code># A tibble: 32 x 2
     mpg    wt
   &lt;dbl&gt; &lt;dbl&gt;
 1  21    2.62
 2  21    2.88
 3  22.8  2.32
 4  21.4  3.22
 5  18.7  3.44
 6  18.1  3.46
 7  14.3  3.57
 8  24.4  3.19
 9  22.8  3.15
10  19.2  3.44
# ... with 22 more rows</code></pre>
<p>함수 <code>all_of()</code>를 사용하게 되면 <code>model</code>이 <code>mtcars_t</code>에 없는 변수이기 때문에 오류가 발생하게 된다.</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="dplyr에-의한-데이터-다듬기.html#cb733-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb733-2"><a href="dplyr에-의한-데이터-다듬기.html#cb733-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="fu">all_of</span>(vars))</span></code></pre></div>
<pre><code>Error: Can&#39;t subset columns that don&#39;t exist.
x Column `model` doesn&#39;t exist.</code></pre>
<p>당연한 것이지만, 지금까지 살펴본 세 가지 변수 선택 방법은 서로 혼합해서 사용할 수
있다. 예를 들어 숫자형 변수 중에 이름에 <code>a</code>가 변수는 다음과 같이 선택할 수 있다.</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="dplyr에-의한-데이터-다듬기.html#cb735-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb735-2"><a href="dplyr에-의한-데이터-다듬기.html#cb735-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">&amp;</span> <span class="fu">contains</span>(<span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 32 x 3
     cyl  qsec  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     6  16.5     4
 2     6  17.0     4
 3     4  18.6     1
 4     6  19.4     1
 5     8  17.0     2
 6     6  20.2     1
 7     8  15.8     4
 8     4  20       2
 9     4  22.9     2
10     6  18.3     4
# ... with 22 more rows</code></pre>
<ul>
<li>벡터 형태로 변수 선택: 함수 <code>pull()</code></li>
</ul>
<p>데이터 프레임의 한 변수를 선택하여 벡터로 추출하고자 한다면 함수 <code>pull()</code>을 사용하면
된다. 변수 선택 방법은 옵션 <code>var</code>에 변수 이름을 지정하거나, 위치를 나타내는 정수를 지정하는
것이다. 양의 정수는 첫 번째 변수를 시작점으로 하는 위치이고, 음의 정수는 마지막 변수
를 시작점으로 하는 위치이다. 디폴트는 <code>var = -1</code>로 설정되어 있어서, 마지막 변수가 선택된다. 데이터 프레임 <code>mtcars</code>를 대상으로 마지막 변수와 세 번째 변수, 그리고 변수 <code>am</code>을 벡터 형태로 선택해 보자.</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="dplyr에-의한-데이터-다듬기.html#cb737-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span></code></pre></div>
<pre><code> [1] 4 4 1 1 2 1 4 2 2 4 4 3 3 3 4 4 4 1 2 1 1 2 2 4 2 1 2 2 4 6 8 2</code></pre>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="dplyr에-의한-데이터-다듬기.html#cb739-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="at">var =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code> [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</code></pre>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="dplyr에-의한-데이터-다듬기.html#cb741-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="at">var =</span> am)</span></code></pre></div>
<pre><code> [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1</code></pre>
</div>
<div id="열-이름-변경-rename과-rename_with" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> 열 이름 변경: <code>rename()</code>과 <code>rename_with()</code></h3>
<p>변수 이름이 매우 복잡하거나 사용하기 불편해서 이름을 변경해야 하는 경우가 많다. 함수
<code>select()</code>로도 변수 이름을 변경할 수 있으나, 함수 내에서 이름이 명시되지 않은 변수는
선택되지 않은 변수가 되어 제거되고, 이름이 변경된 변수만 남게 된다.
변수에 새로운 이름을 주는 방식은 <code>new_name = old_name</code>이 되는데, <code>old_name</code> 자리에는 변수 이름 또는 변수의 열 번호가 올 수 있다.</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="dplyr에-의한-데이터-다듬기.html#cb743-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb743-2"><a href="dplyr에-의한-데이터-다듬기.html#cb743-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="at">model =</span> row.name)</span></code></pre></div>
<pre><code># A tibble: 32 x 1
   model            
   &lt;chr&gt;            
 1 Mazda RX4        
 2 Mazda RX4 Wag    
 3 Datsun 710       
 4 Hornet 4 Drive   
 5 Hornet Sportabout
 6 Valiant          
 7 Duster 360       
 8 Merc 240D        
 9 Merc 230         
10 Merc 280         
# ... with 22 more rows</code></pre>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="dplyr에-의한-데이터-다듬기.html#cb745-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb745-2"><a href="dplyr에-의한-데이터-다듬기.html#cb745-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="at">model =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code># A tibble: 32 x 1
   model            
   &lt;chr&gt;            
 1 Mazda RX4        
 2 Mazda RX4 Wag    
 3 Datsun 710       
 4 Hornet 4 Drive   
 5 Hornet Sportabout
 6 Valiant          
 7 Duster 360       
 8 Merc 240D        
 9 Merc 230         
10 Merc 280         
# ... with 22 more rows</code></pre>
<p>함수 <code>select()</code>에서 이름이 변경되지 않은 변수도 모두 그대로 유지하려면 함수 <code>everything()</code>을 함께 사용하면 된다.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="dplyr에-의한-데이터-다듬기.html#cb747-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb747-2"><a href="dplyr에-의한-데이터-다듬기.html#cb747-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(<span class="at">model =</span> row.name, <span class="fu">everything</span>())</span></code></pre></div>
<pre><code># A tibble: 32 x 12
   model         mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4    21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2 Mazda RX4 ~  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3 Datsun 710   22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4 Hornet 4 D~  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5 Hornet Spo~  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6 Valiant      18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7 Duster 360   14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8 Merc 240D    24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9 Merc 230     22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10 Merc 280     19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ... with 22 more rows</code></pre>
<p>함수 <code>rename()</code>을 사용하면 이름이 변경되지 않은 변수도 모두 그대로 유지가 된다.
변수에 새로운 이름을 주는 방식은 함수 <code>select()</code>와 동일하게 <code>new_name = old_name</code>이다.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="dplyr에-의한-데이터-다듬기.html#cb749-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb749-2"><a href="dplyr에-의한-데이터-다듬기.html#cb749-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">rename</span>(<span class="at">model =</span> row.name)</span></code></pre></div>
<pre><code># A tibble: 32 x 12
   model         mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4    21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2 Mazda RX4 ~  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3 Datsun 710   22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4 Hornet 4 D~  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5 Hornet Spo~  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6 Valiant      18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7 Duster 360   14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8 Merc 240D    24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9 Merc 230     22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10 Merc 280     19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ... with 22 more rows</code></pre>
<p>많은 변수의 이름을 어떤 공통된 양식에 따라 모두 바꿔야 하는 경우, 하나씩 <code>new_name = old_name</code>으로 변경하는 방식은 매우 비효율적이 될 수 있다. 예컨대 대문자로 입력된
변수 이름을 모두 소문자로 변경하거나, 이름 중간에 들어간 점(.)을 밑줄(_)로 변경해야
하는 경우에 하나씩 변경하는 방식이 아닌 해당되는 변수의 이름을 한꺼번에 모두 바꿀 수
있는 방식이 필요한 것이다. 이러한 작업은 함수 <code>rename_with()</code>로 할 수 있다.</p>
<p>데이터 프레임 <code>mtcars_t</code>의 모든 변수 이름을 대문자로 변경해 보자.
함수 <code>rename_with()</code>에는 기존의 변수 이름을 새로운 이름으로 바꿀 수 있는 함수를
지정해야 한다. 모든 변수를 대문자로 변경하는 작업이므로 함수 <code>toupper()</code>를 사용하면 된다.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="dplyr에-의한-데이터-다듬기.html#cb751-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb751-2"><a href="dplyr에-의한-데이터-다듬기.html#cb751-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">rename_with</span>(toupper)</span></code></pre></div>
<pre><code># A tibble: 32 x 12
   ROW.NAME      MPG   CYL  DISP    HP  DRAT    WT  QSEC    VS    AM  GEAR  CARB
   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4    21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2 Mazda RX4 ~  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3 Datsun 710   22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4 Hornet 4 D~  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5 Hornet Spo~  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6 Valiant      18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7 Duster 360   14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8 Merc 240D    24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9 Merc 230     22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10 Merc 280     19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ... with 22 more rows</code></pre>
<p>모든 변수가 이름 변경 대상이 되는 것이 디폴트이다.
변경 대상 변수를 선택을 해야 하는 경우에는 함수 <code>select()</code>에서 사용했던 <code>&lt;tidy-select&gt;</code>의 방식으로 선택하여 함수 <code>rename_with()</code>의 세 번째 입력요소로 지정하면 된다. 이름에 <code>a</code>가 포함되어 있는 변수의 이름을 대문자로 바꾸어 보자.</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="dplyr에-의한-데이터-다듬기.html#cb753-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars_t <span class="sc">%&gt;%</span> </span>
<span id="cb753-2"><a href="dplyr에-의한-데이터-다듬기.html#cb753-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">rename_with</span>(toupper, <span class="fu">contains</span>(<span class="st">&quot;a&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 32 x 12
   ROW.NAME      mpg   cyl  disp    hp  DRAT    wt  qsec    vs    AM  GEAR  CARB
   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4    21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2 Mazda RX4 ~  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3 Datsun 710   22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4 Hornet 4 D~  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5 Hornet Spo~  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6 Valiant      18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7 Duster 360   14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8 Merc 240D    24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9 Merc 230     22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10 Merc 280     19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ... with 22 more rows</code></pre>
</div>
<div id="열의-위치-변경-relocate" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> 열의 위치 변경: <code>relocate()</code></h3>
<p>열의 위치를 변경해야 하는 경우에 사용할 수 있는 함수이다. 위치를 바꿀 열은 <code>&lt;tidy-select&gt;</code>
방식을 사용하여 선택할 수 있어서, 여러 열의 위치를 한꺼번에 옮길 수 있다.
제일 앞으로 이동되는 것이 디폴트 위치이며 옵션 <code>.after</code> 혹은 <code>.before</code>에서 위치를 지정할 수
있다.</p>
<p>데이터 프레임 <code>iris</code>의 마지막 변수 <code>Species</code>를 첫 번째 위치로 이동해 보자.</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="dplyr에-의한-데이터-다듬기.html#cb755-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span></code></pre></div>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="dplyr에-의한-데이터-다듬기.html#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb756-2"><a href="dplyr에-의한-데이터-다듬기.html#cb756-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">relocate</span>(Species)</span></code></pre></div>
<pre><code># A tibble: 150 x 5
   Species Sepal.Length Sepal.Width Petal.Length Petal.Width
   &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1 setosa           5.1         3.5          1.4         0.2
 2 setosa           4.9         3            1.4         0.2
 3 setosa           4.7         3.2          1.3         0.2
 4 setosa           4.6         3.1          1.5         0.2
 5 setosa           5           3.6          1.4         0.2
 6 setosa           5.4         3.9          1.7         0.4
 7 setosa           4.6         3.4          1.4         0.3
 8 setosa           5           3.4          1.5         0.2
 9 setosa           4.4         2.9          1.4         0.2
10 setosa           4.9         3.1          1.5         0.1
# ... with 140 more rows</code></pre>
<p>이름이 <code>th</code>로 끝나는 변수를 모두 <code>Species</code> 다음으로 이동하면 변수 <code>Species</code>를 첫 번째 위치로 이동하는 것이 된다.</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="dplyr에-의한-데이터-다듬기.html#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb758-2"><a href="dplyr에-의한-데이터-다듬기.html#cb758-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">relocate</span>(<span class="fu">ends_with</span>(<span class="st">&quot;th&quot;</span>), <span class="at">.after =</span> Species)</span></code></pre></div>
<pre><code># A tibble: 150 x 5
   Species Sepal.Length Sepal.Width Petal.Length Petal.Width
   &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1 setosa           5.1         3.5          1.4         0.2
 2 setosa           4.9         3            1.4         0.2
 3 setosa           4.7         3.2          1.3         0.2
 4 setosa           4.6         3.1          1.5         0.2
 5 setosa           5           3.6          1.4         0.2
 6 setosa           5.4         3.9          1.7         0.4
 7 setosa           4.6         3.4          1.4         0.3
 8 setosa           5           3.4          1.5         0.2
 9 setosa           4.4         2.9          1.4         0.2
10 setosa           4.9         3.1          1.5         0.1
# ... with 140 more rows</code></pre>
<p>특정 변수를 제일 앞으로 이동하는 작업은 함수 <code>select()</code>에 <code>everything()</code>을 함께 사용해서 할 수도 있다.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="dplyr에-의한-데이터-다듬기.html#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris_t <span class="sc">%&gt;%</span> </span>
<span id="cb760-2"><a href="dplyr에-의한-데이터-다듬기.html#cb760-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">select</span>(Species, <span class="fu">everything</span>())</span></code></pre></div>
<pre><code># A tibble: 150 x 5
   Species Sepal.Length Sepal.Width Petal.Length Petal.Width
   &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1 setosa           5.1         3.5          1.4         0.2
 2 setosa           4.9         3            1.4         0.2
 3 setosa           4.7         3.2          1.3         0.2
 4 setosa           4.6         3.1          1.5         0.2
 5 setosa           5           3.6          1.4         0.2
 6 setosa           5.4         3.9          1.7         0.4
 7 setosa           4.6         3.4          1.4         0.3
 8 setosa           5           3.4          1.5         0.2
 9 setosa           4.4         2.9          1.4         0.2
10 setosa           4.9         3.1          1.5         0.1
# ... with 140 more rows</code></pre>
</div>
<div id="새로운-열의-추가-mutate와-transmute" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> 새로운 열의 추가: <code>mutate()</code>와 <code>transmute()</code></h3>
<p>데이터 프레임을 구성하고 있는 기존의 변수들을 이용하여 새로운 변수를 만들어 데이터
프레임에 추가해야 할 경우가 종종 있다. 이러한 작업을 수행하는 함수가 <code>mutate()</code>이다.
데이터 프레임이 함수 <code>mutate()</code>의 첫 번째 입력 요소가 되고, 이어서 새로운 변수를 만드는 표현식이 차례로 입력된다.
새롭게 만들어진 변수는 데이터 프레임의 제일 마지막 변수로 추가된다. 만일 새롭게 만들어진 변수로만 데이터 프레임을 구성하고자 한다면 함수
<code>transmute()</code>를 사용하면 된다. 함수 <code>mutate()</code>와 <code>transmute()</code>에서 새로운 변수를 만들
때 유용하게 사용되는 함수들의 목록이 RStudio의 메뉴 <code>Help &gt; Cheatsheets &gt; Data Transformation with dplyr</code>에 잘 정리되어 있다.</p>
<ul>
<li>예제: <code>mtcars</code></li>
</ul>
<p>다음의 조건에 의하여 새로운 변수 <code>kml</code>과 <code>gp_kml</code>을 만들고 데이터 프레임에 첫 번째와
두번째 변수로 추가해 보자.</p>
<p>∙ 변수 <code>kml</code>: 1 mpg(mile per gallon)는 0.43 kml(kilometer per liter)</p>
<p>∙ 변수 <code>gp_kml</code>: <code>kml</code>이 10 이상이면 <code>good</code>, 10 미만이면 <code>bad</code></p>
<p>연속형 변수 <code>kml</code>을 기반으로 범주의 개수가 두 개인 범주형 변수 <code>gp_kml</code>를 생성하는
작업은 함수 <code>if_else()</code>를 사용하는 것이 효과적이다. 기본적인 사용법은 <code>if_else(condition, true, false)</code>이며 <code>condition</code>이 만족되면 <code>true</code>의 값을 갖고, 아니면 <code>false</code>의 값을 갖게 된다. 조건의 만족 여부에 따라 할당되는 두 가지 값의 유형은 같아야 한다.</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="dplyr에-의한-데이터-다듬기.html#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">as_tibble</span>(mtcars) <span class="sc">%&gt;%</span> </span>
<span id="cb762-2"><a href="dplyr에-의한-데이터-다듬기.html#cb762-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">mutate</span>(<span class="at">kml =</span> <span class="fl">0.43</span><span class="sc">*</span>mpg,</span>
<span id="cb762-3"><a href="dplyr에-의한-데이터-다듬기.html#cb762-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>          <span class="at">gp_kml =</span> <span class="fu">if_else</span>(kml <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="st">&quot;good&quot;</span>, <span class="st">&quot;bad&quot;</span>)</span>
<span id="cb762-4"><a href="dplyr에-의한-데이터-다듬기.html#cb762-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>          ) <span class="sc">%&gt;%</span> </span>
<span id="cb762-5"><a href="dplyr에-의한-데이터-다듬기.html#cb762-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">relocate</span>(kml, gp_kml) <span class="sc">%&gt;%</span> </span>
<span id="cb762-6"><a href="dplyr에-의한-데이터-다듬기.html#cb762-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 32 x 13
    kml gp_kml   mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  9.03 bad     21       6   160   110  3.9   2.62  16.5     0     1     4     4
2  9.03 bad     21       6   160   110  3.9   2.88  17.0     0     1     4     4
3  9.80 bad     22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
# ... with 29 more rows</code></pre>
<p>연속형 변수를 기반으로 범주의 개수가 3개 이상이 되는 범주형 변수를 생성하려는 경우에 함수 <code>if_else()</code>를 사용하는 것은 적절하지 않을 수 있다. 이러한 경우에는 함수
<code>case_when()</code>이 효과적인 대안이 된다. 기본적인 형태는 <code>LHS ~ RHS</code>로서, <code>LHS</code>는 조건이고,
<code>RHS</code>에는 할당하려는 값이 된다. 다음 구조에서는 <code>condition_1</code>이 <code>TRUE</code>이면 <code>value_1</code>, <code>condition_1</code>은 <code>FALSE</code>이나 <code>condition_2</code>가 <code>TRUE</code>이면 <code>value_2</code>, 두 조건 모두 <code>FALSE</code>이면 <code>value_3</code>를 출력하게 된다.</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="dplyr에-의한-데이터-다듬기.html#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="fu">case_when</span>(</span>
<span id="cb764-2"><a href="dplyr에-의한-데이터-다듬기.html#cb764-2" aria-hidden="true" tabindex="-1"></a>  condition_1 <span class="sc">~</span> value_1,</span>
<span id="cb764-3"><a href="dplyr에-의한-데이터-다듬기.html#cb764-3" aria-hidden="true" tabindex="-1"></a>  condition_2 <span class="sc">~</span> value_2,</span>
<span id="cb764-4"><a href="dplyr에-의한-데이터-다듬기.html#cb764-4" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> value_3</span>
<span id="cb764-5"><a href="dplyr에-의한-데이터-다듬기.html#cb764-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><code>LHS</code>에 제시되는 조건들은 순서대로 평가가 된다. 따라서 가장 좁은 범위의 조건이 가장
먼저 제시되어야 하고, 범위를 넓혀가는 조건이 잇따라 제시되어야 한다. 제시되는 조건의
개수에는 제한이 없다. 또한 <code>RHS</code>에 제시된 값들은 모두 같은 유형이어야 한다.
이제 다음의 변경된 조건으로 변수 <code>gp_kml</code>을 생성해 보자.</p>
<p>∙ 변수 <code>gp_kml</code>: <code>kml</code>이 11 이상이면 <code>excellent</code>, 11 미만 8 이상이면 <code>good</code>, 8 미만이면 <code>bad</code></p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="dplyr에-의한-데이터-다듬기.html#cb765-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">as_tibble</span>(mtcars) <span class="sc">%&gt;%</span> </span>
<span id="cb765-2"><a href="dplyr에-의한-데이터-다듬기.html#cb765-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">mutate</span>(<span class="at">kml =</span> <span class="fl">0.43</span><span class="sc">*</span>mpg,</span>
<span id="cb765-3"><a href="dplyr에-의한-데이터-다듬기.html#cb765-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>          <span class="at">gp_kml =</span> <span class="fu">case_when</span>(</span>
<span id="cb765-4"><a href="dplyr에-의한-데이터-다듬기.html#cb765-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>            kml <span class="sc">&lt;</span> <span class="dv">8</span> <span class="sc">~</span> <span class="st">&quot;bad&quot;</span>,</span>
<span id="cb765-5"><a href="dplyr에-의한-데이터-다듬기.html#cb765-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>            kml <span class="sc">&lt;</span> <span class="dv">11</span> <span class="sc">~</span> <span class="st">&quot;good&quot;</span>,</span>
<span id="cb765-6"><a href="dplyr에-의한-데이터-다듬기.html#cb765-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;excellent&quot;</span></span>
<span id="cb765-7"><a href="dplyr에-의한-데이터-다듬기.html#cb765-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>            )</span>
<span id="cb765-8"><a href="dplyr에-의한-데이터-다듬기.html#cb765-8" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>          ) <span class="sc">%&gt;%</span> </span>
<span id="cb765-9"><a href="dplyr에-의한-데이터-다듬기.html#cb765-9" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">relocate</span>(kml, gp_kml) <span class="sc">%&gt;%</span> </span>
<span id="cb765-10"><a href="dplyr에-의한-데이터-다듬기.html#cb765-10" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 32 x 13
    kml gp_kml   mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  9.03 good    21       6   160   110  3.9   2.62  16.5     0     1     4     4
2  9.03 good    21       6   160   110  3.9   2.88  17.0     0     1     4     4
3  9.80 good    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
# ... with 29 more rows</code></pre>
<p>만일 새로운 변수만 유지하고 나머지 변수는 모두 삭제하려고 한다면, 함수 <code>transmute()</code>를 사용하면 된다.</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="dplyr에-의한-데이터-다듬기.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">as_tibble</span>(mtcars) <span class="sc">%&gt;%</span> </span>
<span id="cb767-2"><a href="dplyr에-의한-데이터-다듬기.html#cb767-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">transmute</span>(<span class="at">kml =</span> <span class="fl">0.43</span><span class="sc">*</span>mpg,</span>
<span id="cb767-3"><a href="dplyr에-의한-데이터-다듬기.html#cb767-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>          <span class="at">gp_kml =</span> <span class="fu">if_else</span>(kml <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="st">&quot;good&quot;</span>, <span class="st">&quot;bad&quot;</span>)</span>
<span id="cb767-4"><a href="dplyr에-의한-데이터-다듬기.html#cb767-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   ) <span class="sc">%&gt;%</span> </span>
<span id="cb767-5"><a href="dplyr에-의한-데이터-다듬기.html#cb767-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 32 x 2
    kml gp_kml
  &lt;dbl&gt; &lt;chr&gt; 
1  9.03 bad   
2  9.03 bad   
3  9.80 bad   
# ... with 29 more rows</code></pre>
</div>
</div>
<div id="여러-행-자료의-요약-summarise" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> 여러 행 자료의 요약: <code>summarise()</code></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="데이터-입력.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
