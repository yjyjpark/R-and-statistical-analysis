<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 장 dplyr에 의한 데이터 다듬기 | R과 통계분석</title>
  <meta name="description" content="4 장 dplyr에 의한 데이터 다듬기 | R과 통계분석" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="4 장 dplyr에 의한 데이터 다듬기 | R과 통계분석" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 장 dplyr에 의한 데이터 다듬기 | R과 통계분석" />
  
  
  

<meta name="author" content="박동련" />


<meta name="date" content="2024-02-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="데이터-입력.html"/>
<link rel="next" href="chapter-ggplot2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>소개하기</a></li>
<li class="chapter" data-level="1" data-path="R-start.html"><a href="R-start.html"><i class="fa fa-check"></i><b>1</b> R 시작하기</a>
<ul>
<li class="chapter" data-level="1.1" data-path="R-start.html"><a href="R-start.html#r의-소개"><i class="fa fa-check"></i><b>1.1</b> R의 소개</a></li>
<li class="chapter" data-level="1.2" data-path="R-start.html"><a href="R-start.html#r의-설치"><i class="fa fa-check"></i><b>1.2</b> R의 설치</a></li>
<li class="chapter" data-level="1.3" data-path="R-start.html"><a href="R-start.html#rstudio의-설치-및-r의-실행"><i class="fa fa-check"></i><b>1.3</b> RStudio의 설치 및 R의 실행</a></li>
<li class="chapter" data-level="1.4" data-path="R-start.html"><a href="R-start.html#작업공간"><i class="fa fa-check"></i><b>1.4</b> 작업공간</a></li>
<li class="chapter" data-level="1.5" data-path="R-start.html"><a href="R-start.html#스크립트-파일의-활용"><i class="fa fa-check"></i><b>1.5</b> 스크립트 파일의 활용</a></li>
<li class="chapter" data-level="1.6" data-path="R-start.html"><a href="R-start.html#section-batch"><i class="fa fa-check"></i><b>1.6</b> 일괄처리</a></li>
<li class="chapter" data-level="1.7" data-path="R-start.html"><a href="R-start.html#section-package"><i class="fa fa-check"></i><b>1.7</b> R의 확장: 패키지</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="R-start.html"><a href="R-start.html#패키지의-종류"><i class="fa fa-check"></i><b>1.7.1</b> 패키지의 종류</a></li>
<li class="chapter" data-level="1.7.2" data-path="R-start.html"><a href="R-start.html#패키지의-설치-및-사용"><i class="fa fa-check"></i><b>1.7.2</b> 패키지의 설치 및 사용</a></li>
<li class="chapter" data-level="1.7.3" data-path="R-start.html"><a href="R-start.html#패키지-tidyverse의-소개"><i class="fa fa-check"></i><b>1.7.3</b> 패키지 <code>tidyverse</code>의 소개</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structure.html"><a href="data-structure.html"><i class="fa fa-check"></i><b>2</b> R 데이터 구조</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structure.html"><a href="data-structure.html#벡터"><i class="fa fa-check"></i><b>2.1</b> 벡터</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-structure.html"><a href="data-structure.html#벡터의-기본-특성"><i class="fa fa-check"></i><b>2.1.1</b> 벡터의 기본 특성</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-structure.html"><a href="data-structure.html#다양한-형태를-갖는-벡터의-생성"><i class="fa fa-check"></i><b>2.1.2</b> 다양한 형태를 갖는 벡터의 생성</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-structure.html"><a href="data-structure.html#문자열을-위한-함수"><i class="fa fa-check"></i><b>2.1.3</b> 문자열을 위한 함수</a></li>
<li class="chapter" data-level="2.1.4" data-path="data-structure.html"><a href="data-structure.html#벡터의-연산"><i class="fa fa-check"></i><b>2.1.4</b> 벡터의 연산</a></li>
<li class="chapter" data-level="2.1.5" data-path="data-structure.html"><a href="data-structure.html#vector-compare"><i class="fa fa-check"></i><b>2.1.5</b> 벡터의 비교</a></li>
<li class="chapter" data-level="2.1.6" data-path="data-structure.html"><a href="data-structure.html#벡터의-인덱싱"><i class="fa fa-check"></i><b>2.1.6</b> 벡터의 인덱싱</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-structure.html"><a href="data-structure.html#요인"><i class="fa fa-check"></i><b>2.2</b> 요인</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-structure.html"><a href="data-structure.html#요인의-기본-특성"><i class="fa fa-check"></i><b>2.2.1</b> 요인의 기본 특성</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-structure.html"><a href="data-structure.html#숫자형-벡터를-요인으로-변환"><i class="fa fa-check"></i><b>2.2.2</b> 숫자형 벡터를 요인으로 변환</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-structure.html"><a href="data-structure.html#날짜"><i class="fa fa-check"></i><b>2.3</b> 날짜</a></li>
<li class="chapter" data-level="2.4" data-path="data-structure.html"><a href="data-structure.html#행렬-및-배열"><i class="fa fa-check"></i><b>2.4</b> 행렬 및 배열</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-structure.html"><a href="data-structure.html#행렬과-배열의-기본-특성"><i class="fa fa-check"></i><b>2.4.1</b> 행렬과 배열의 기본 특성</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-structure.html"><a href="data-structure.html#행렬의-연산"><i class="fa fa-check"></i><b>2.4.2</b> 행렬의 연산</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-structure.html"><a href="data-structure.html#section-dataframe"><i class="fa fa-check"></i><b>2.5</b> 데이터 프레임</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-structure.html"><a href="data-structure.html#데이터-프레임의-생성"><i class="fa fa-check"></i><b>2.5.1</b> 데이터 프레임의 생성</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-structure.html"><a href="data-structure.html#데이터-프레임의-인덱싱"><i class="fa fa-check"></i><b>2.5.2</b> 데이터 프레임의 인덱싱</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-structure.html"><a href="data-structure.html#함수-with"><i class="fa fa-check"></i><b>2.5.3</b> 함수 <code>with()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-structure.html"><a href="data-structure.html#tibble-개선된-형태의-데이터-프레임"><i class="fa fa-check"></i><b>2.6</b> tibble: 개선된 형태의 데이터 프레임</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data-structure.html"><a href="data-structure.html#tibble-생성"><i class="fa fa-check"></i><b>2.6.1</b> tibble 생성</a></li>
<li class="chapter" data-level="2.6.2" data-path="data-structure.html"><a href="data-structure.html#tibble과-전통적인-데이터-프레임의-차이"><i class="fa fa-check"></i><b>2.6.2</b> tibble과 전통적인 데이터 프레임의 차이</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-structure.html"><a href="data-structure.html#section-list"><i class="fa fa-check"></i><b>2.7</b> 리스트</a></li>
<li class="chapter" data-level="2.8" data-path="data-structure.html"><a href="data-structure.html#연습문제"><i class="fa fa-check"></i><b>2.8</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="데이터-입력.html"><a href="데이터-입력.html"><i class="fa fa-check"></i><b>3</b> 데이터 입력</a>
<ul>
<li class="chapter" data-level="3.1" data-path="데이터-입력.html"><a href="데이터-입력.html#텍스트-파일-불러오기-패키지-readr-함수의-활용"><i class="fa fa-check"></i><b>3.1</b> 텍스트 파일 불러오기: 패키지 <code>readr</code> 함수의 활용</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="데이터-입력.html"><a href="데이터-입력.html#함수-read_table로-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.1.1</b> 함수 <code>read_table()</code>로 데이터 파일 불러오기</a></li>
<li class="chapter" data-level="3.1.2" data-path="데이터-입력.html"><a href="데이터-입력.html#함수-read_csv로-csv-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.1.2</b> 함수 <code>read_csv()</code>로 CSV 데이터 파일 불러오기</a></li>
<li class="chapter" data-level="3.1.3" data-path="데이터-입력.html"><a href="데이터-입력.html#함수-read_fwf로-고정-포맷-구조를-갖는-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.1.3</b> 함수 <code>read_fwf()</code>로 고정 포맷 구조를 갖는 데이터 파일 불러오기</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="데이터-입력.html"><a href="데이터-입력.html#excel-파일-불러오기"><i class="fa fa-check"></i><b>3.2</b> Excel 파일 불러오기</a></li>
<li class="chapter" data-level="3.3" data-path="데이터-입력.html"><a href="데이터-입력.html#sas-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.3</b> SAS 데이터 파일 불러오기</a></li>
<li class="chapter" data-level="3.4" data-path="데이터-입력.html"><a href="데이터-입력.html#html-테이블-불러오기"><i class="fa fa-check"></i><b>3.4</b> HTML 테이블 불러오기</a></li>
<li class="chapter" data-level="3.5" data-path="데이터-입력.html"><a href="데이터-입력.html#연습문제-1"><i class="fa fa-check"></i><b>3.5</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html"><i class="fa fa-check"></i><b>4</b> <code>dplyr</code>에 의한 데이터 다듬기</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#행을-작업-대상으로-하는-함수"><i class="fa fa-check"></i><b>4.1</b> 행을 작업 대상으로 하는 함수</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#조건에-의한-행-선택-filter"><i class="fa fa-check"></i><b>4.1.1</b> 조건에 의한 행 선택: <code>filter()</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#위치에-의한-행-선택-slice-및-그와-관련된-함수"><i class="fa fa-check"></i><b>4.1.2</b> 위치에 의한 행 선택: <code>slice()</code> 및 그와 관련된 함수</a></li>
<li class="chapter" data-level="4.1.3" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#행의-정렬-arrange"><i class="fa fa-check"></i><b>4.1.3</b> 행의 정렬: <code>arrange()</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#중복된-행의-제거-distinct"><i class="fa fa-check"></i><b>4.1.4</b> 중복된 행의 제거: <code>distinct()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#열을-작업-대상으로-하는-함수"><i class="fa fa-check"></i><b>4.2</b> 열을 작업 대상으로 하는 함수</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#열의-선택-select"><i class="fa fa-check"></i><b>4.2.1</b> 열의 선택: <code>select()</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#열-이름-변경-rename과-rename_with"><i class="fa fa-check"></i><b>4.2.2</b> 열 이름 변경: <code>rename()</code>과 <code>rename_with()</code></a></li>
<li class="chapter" data-level="4.2.3" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#열의-위치-변경-relocate"><i class="fa fa-check"></i><b>4.2.3</b> 열의 위치 변경: <code>relocate()</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#새로운-열의-추가-mutate와-transmute"><i class="fa fa-check"></i><b>4.2.4</b> 새로운 열의 추가: <code>mutate()</code>와 <code>transmute()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#여러-행-자료의-요약-summarise"><i class="fa fa-check"></i><b>4.3</b> 여러 행 자료의 요약: <code>summarise()</code></a></li>
<li class="chapter" data-level="4.4" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#그룹-데이터-프레임"><i class="fa fa-check"></i><b>4.4</b> 그룹 데이터 프레임</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#그룹-데이터-프레임의-생성-group_by"><i class="fa fa-check"></i><b>4.4.1</b> 그룹 데이터 프레임의 생성: <code>group_by()</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#그룹-데이터-프레임에서-기본-함수들의-작동-방식"><i class="fa fa-check"></i><b>4.4.2</b> 그룹 데이터 프레임에서 기본 함수들의 작동 방식</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#다수의-열을-대상으로-하는-작업-across"><i class="fa fa-check"></i><b>4.5</b> 다수의 열을 대상으로 하는 작업: <code>across()</code></a></li>
<li class="chapter" data-level="4.6" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#행-단위-작업-rowwise"><i class="fa fa-check"></i><b>4.6</b> 행 단위 작업: <code>rowwise()</code></a></li>
<li class="chapter" data-level="4.7" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#연습문제-2"><i class="fa fa-check"></i><b>4.7</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html"><i class="fa fa-check"></i><b>5</b> <code>ggplot2</code>에 의한 자료 시각화</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#ggplot2-시작하기"><i class="fa fa-check"></i><b>5.1</b> <code>ggplot2</code> 시작하기</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#시각적-요소와의-연결-mapping"><i class="fa fa-check"></i><b>5.2</b> 시각적 요소와의 연결: Mapping</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#그룹별-그래프-작성-facet"><i class="fa fa-check"></i><b>5.3</b> 그룹별 그래프 작성: Facet</a></li>
<li class="chapter" data-level="5.4" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#section-geom"><i class="fa fa-check"></i><b>5.4</b> 기하 객체: Geometric object</a></li>
<li class="chapter" data-level="5.5" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#통계적-변환-statistical-transformation"><i class="fa fa-check"></i><b>5.5</b> 통계적 변환: Statistical transformation</a></li>
<li class="chapter" data-level="5.6" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#위치-조정-position-adjustments"><i class="fa fa-check"></i><b>5.6</b> 위치 조정: Position adjustments</a></li>
<li class="chapter" data-level="5.7" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#좌표계-coordinate-system"><i class="fa fa-check"></i><b>5.7</b> 좌표계: Coordinate system</a></li>
<li class="chapter" data-level="5.8" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#연습문제-3"><i class="fa fa-check"></i><b>5.8</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i><b>6</b> Tidyverse를 활용한 데이터 다루기</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch6.html"><a href="ch6.html#tidyr로-tidy-데이터-만들기"><i class="fa fa-check"></i><b>6.1</b> <code>tidyr</code>로 tidy 데이터 만들기</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ch6.html"><a href="ch6.html#데이터-피벗-pivot_longer와-pivot_wider"><i class="fa fa-check"></i><b>6.1.1</b> 데이터 피벗: <code>pivot_longer()</code>와 <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="ch6.html"><a href="ch6.html#문자형-열의-결합과-분리-separate와-unite"><i class="fa fa-check"></i><b>6.1.2</b> 문자형 열의 결합과 분리: <code>separate()</code>와 <code>unite()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ch6.html"><a href="ch6.html#dplyr에-의한-데이터-결합"><i class="fa fa-check"></i><b>6.2</b> <code>dplyr</code>에 의한 데이터 결합</a></li>
<li class="chapter" data-level="6.3" data-path="ch6.html"><a href="ch6.html#stringr에-의한-문자-다루기"><i class="fa fa-check"></i><b>6.3</b> <code>stringr</code>에 의한 문자 다루기</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ch6.html"><a href="ch6.html#stringr의-함수"><i class="fa fa-check"></i><b>6.3.1</b> <code>stringr</code>의 함수</a></li>
<li class="chapter" data-level="6.3.2" data-path="ch6.html"><a href="ch6.html#정규-표현식과-stringr의-함수"><i class="fa fa-check"></i><b>6.3.2</b> 정규 표현식과 <code>stringr</code>의 함수</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ch6.html"><a href="ch6.html#연습문제-4"><i class="fa fa-check"></i><b>6.4</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-programming.html"><a href="chapter-programming.html"><i class="fa fa-check"></i><b>7</b> R에서의 프로그래밍</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-programming.html"><a href="chapter-programming.html#사용자-정의-함수"><i class="fa fa-check"></i><b>7.1</b> 사용자 정의 함수</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="chapter-programming.html"><a href="chapter-programming.html#함수의-정의"><i class="fa fa-check"></i><b>7.1.1</b> 함수의 정의</a></li>
<li class="chapter" data-level="7.1.2" data-path="chapter-programming.html"><a href="chapter-programming.html#변수"><i class="fa fa-check"></i><b>7.1.2</b> 변수</a></li>
<li class="chapter" data-level="7.1.3" data-path="chapter-programming.html"><a href="chapter-programming.html#변수-지정"><i class="fa fa-check"></i><b>7.1.3</b> 변수 지정</a></li>
<li class="chapter" data-level="7.1.4" data-path="chapter-programming.html"><a href="chapter-programming.html#결과의-출력"><i class="fa fa-check"></i><b>7.1.4</b> 결과의 출력</a></li>
<li class="chapter" data-level="7.1.5" data-path="chapter-programming.html"><a href="chapter-programming.html#유효-범위"><i class="fa fa-check"></i><b>7.1.5</b> 유효 범위</a></li>
<li class="chapter" data-level="7.1.6" data-path="chapter-programming.html"><a href="chapter-programming.html#데이터-프레임-함수"><i class="fa fa-check"></i><b>7.1.6</b> 데이터 프레임 함수</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chapter-programming.html"><a href="chapter-programming.html#조건-연산"><i class="fa fa-check"></i><b>7.2</b> 조건 연산</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="chapter-programming.html"><a href="chapter-programming.html#함수-if에-의한-조건-연산"><i class="fa fa-check"></i><b>7.2.1</b> 함수 <code>if()</code>에 의한 조건 연산</a></li>
<li class="chapter" data-level="7.2.2" data-path="chapter-programming.html"><a href="chapter-programming.html#함수-ifelse에-의한-조건-연산"><i class="fa fa-check"></i><b>7.2.2</b> 함수 <code>ifelse()</code>에 의한 조건 연산</a></li>
<li class="chapter" data-level="7.2.3" data-path="chapter-programming.html"><a href="chapter-programming.html#함수-switch에-의한-조건-연산"><i class="fa fa-check"></i><b>7.2.3</b> 함수 <code>switch()</code>에 의한 조건 연산</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="chapter-programming.html"><a href="chapter-programming.html#루프-연산"><i class="fa fa-check"></i><b>7.3</b> 루프 연산</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="chapter-programming.html"><a href="chapter-programming.html#for-루프"><i class="fa fa-check"></i><b>7.3.1</b> for 루프</a></li>
<li class="chapter" data-level="7.3.2" data-path="chapter-programming.html"><a href="chapter-programming.html#while-루프"><i class="fa fa-check"></i><b>7.3.2</b> while 루프</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="chapter-programming.html"><a href="chapter-programming.html#함수형-프로그래밍"><i class="fa fa-check"></i><b>7.4</b> 함수형 프로그래밍</a></li>
<li class="chapter" data-level="7.5" data-path="chapter-programming.html"><a href="chapter-programming.html#함수형-프로그래밍으로-행렬과-데이터-프레임-다루기"><i class="fa fa-check"></i><b>7.5</b> 함수형 프로그래밍으로 행렬과 데이터 프레임 다루기</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="chapter-programming.html"><a href="chapter-programming.html#행렬에-함수형-프로그래밍-적용하기"><i class="fa fa-check"></i><b>7.5.1</b> 행렬에 함수형 프로그래밍 적용하기</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapter-programming.html"><a href="chapter-programming.html#데이터-프레임에-함수형-프로그래밍-적용하기"><i class="fa fa-check"></i><b>7.5.2</b> 데이터 프레임에 함수형 프로그래밍 적용하기</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapter-programming.html"><a href="chapter-programming.html#purrr에-의한-프로그래밍"><i class="fa fa-check"></i><b>7.6</b> <code>purrr</code>에 의한 프로그래밍</a></li>
<li class="chapter" data-level="7.7" data-path="chapter-programming.html"><a href="chapter-programming.html#연습문제-5"><i class="fa fa-check"></i><b>7.7</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-distribution.html"><a href="chapter-distribution.html"><i class="fa fa-check"></i><b>8</b> 확률분포</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-distribution.html"><a href="chapter-distribution.html#r에서의-확률분포-이름"><i class="fa fa-check"></i><b>8.1</b> R에서의 확률분포 이름</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-distribution.html"><a href="chapter-distribution.html#연속형-확률분포"><i class="fa fa-check"></i><b>8.2</b> 연속형 확률분포</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="chapter-distribution.html"><a href="chapter-distribution.html#정규분포"><i class="fa fa-check"></i><b>8.2.1</b> 정규분포</a></li>
<li class="chapter" data-level="8.2.2" data-path="chapter-distribution.html"><a href="chapter-distribution.html#지수분포"><i class="fa fa-check"></i><b>8.2.2</b> 지수분포</a></li>
<li class="chapter" data-level="8.2.3" data-path="chapter-distribution.html"><a href="chapter-distribution.html#균등분포"><i class="fa fa-check"></i><b>8.2.3</b> 균등분포</a></li>
<li class="chapter" data-level="8.2.4" data-path="chapter-distribution.html"><a href="chapter-distribution.html#t-분포"><i class="fa fa-check"></i><b>8.2.4</b> t-분포</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="chapter-distribution.html"><a href="chapter-distribution.html#이산형-분포"><i class="fa fa-check"></i><b>8.3</b> 이산형 분포</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="chapter-distribution.html"><a href="chapter-distribution.html#베르누이-분포와-이항분포"><i class="fa fa-check"></i><b>8.3.1</b> 베르누이 분포와 이항분포</a></li>
<li class="chapter" data-level="8.3.2" data-path="chapter-distribution.html"><a href="chapter-distribution.html#포아송-분포"><i class="fa fa-check"></i><b>8.3.2</b> 포아송 분포</a></li>
<li class="chapter" data-level="8.3.3" data-path="chapter-distribution.html"><a href="chapter-distribution.html#초기하분포"><i class="fa fa-check"></i><b>8.3.3</b> 초기하분포</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chapter-distribution.html"><a href="chapter-distribution.html#모의실험"><i class="fa fa-check"></i><b>8.4</b> 모의실험</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-EDA.html"><a href="chapter-EDA.html"><i class="fa fa-check"></i><b>9</b> 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#일변량-범주형-자료-탐색"><i class="fa fa-check"></i><b>9.1</b> 일변량 범주형 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#막대그래프"><i class="fa fa-check"></i><b>9.1.1</b> 막대그래프</a></li>
<li class="chapter" data-level="9.1.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#파이그래프"><i class="fa fa-check"></i><b>9.1.2</b> 파이그래프</a></li>
<li class="chapter" data-level="9.1.3" data-path="chapter-EDA.html"><a href="chapter-EDA.html#cleveland의-점그래프"><i class="fa fa-check"></i><b>9.1.3</b> Cleveland의 점그래프</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#이변량-및-다변량-범주형-자료-탐색"><i class="fa fa-check"></i><b>9.2</b> 이변량 및 다변량 범주형 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#분할표-작성"><i class="fa fa-check"></i><b>9.2.1</b> 분할표 작성</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#이변량-및-다변량-범주형-자료를-위한-그래프"><i class="fa fa-check"></i><b>9.2.2</b> 이변량 및 다변량 범주형 자료를 위한 그래프</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapter-EDA.html"><a href="chapter-EDA.html#일변량-연속형-자료-탐색"><i class="fa fa-check"></i><b>9.3</b> 일변량 연속형 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#줄기-잎-그림"><i class="fa fa-check"></i><b>9.3.1</b> 줄기-잎 그림</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#section-boxplot"><i class="fa fa-check"></i><b>9.3.2</b> 상자그림</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapter-EDA.html"><a href="chapter-EDA.html#히스토그램"><i class="fa fa-check"></i><b>9.3.3</b> 히스토그램</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapter-EDA.html"><a href="chapter-EDA.html#section-prob-density"><i class="fa fa-check"></i><b>9.3.4</b> 확률밀도함수 그래프</a></li>
<li class="chapter" data-level="9.3.5" data-path="chapter-EDA.html"><a href="chapter-EDA.html#기타-유용한-그래프"><i class="fa fa-check"></i><b>9.3.5</b> 기타 유용한 그래프</a></li>
<li class="chapter" data-level="9.3.6" data-path="chapter-EDA.html"><a href="chapter-EDA.html#일변량-연속형-자료의-요약통계"><i class="fa fa-check"></i><b>9.3.6</b> 일변량 연속형 자료의 요약통계</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-EDA.html"><a href="chapter-EDA.html#이변량-연속형-자료-탐색"><i class="fa fa-check"></i><b>9.4</b> 이변량 연속형 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#연속형-변수의-분포를-비교하기-위한-그래프"><i class="fa fa-check"></i><b>9.4.1</b> 연속형 변수의 분포를 비교하기 위한 그래프</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#연속형-변수의-관계-탐색을-위한-그래프"><i class="fa fa-check"></i><b>9.4.2</b> 연속형 변수의 관계 탐색을 위한 그래프</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="chapter-EDA.html"><a href="chapter-EDA.html#연습문제-6"><i class="fa fa-check"></i><b>9.5</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html"><i class="fa fa-check"></i>부록</a>
<ul>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#r과-통계분석-연습문제-해답"><i class="fa fa-check"></i>‘R과 통계분석’ 연습문제 해답</a>
<ul>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장"><i class="fa fa-check"></i>2장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-1"><i class="fa fa-check"></i>3장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-2"><i class="fa fa-check"></i>4장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-3"><i class="fa fa-check"></i>5장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-4"><i class="fa fa-check"></i>6장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-5"><i class="fa fa-check"></i>7장</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#참고문헌"><i class="fa fa-check"></i>참고문헌</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R과 통계분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-dplyr" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4 장</span> <code>dplyr</code>에 의한 데이터 다듬기<a href="chapter-dplyr.html#chapter-dplyr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>R에 입력된 데이터 세트는 대부분의 경우 바로 통계분석이 가능한 상태가 아니다. 분석에 필요한 적절한 변수가 없거나, 특정 조건을 만족하는 자료만을 선택해야 하거나, 자료의 순서를 바꿔야 하거나, 그룹별로 자료를 합치거나 또는 나눠야 하는 등등의 작업이 필요한 경우가 대부분이다. 이러한 데이터 다듬기는 최적의 통계 예측모형 적합 등을 위해 반드시 필요한 절차이지만, 시간이 매우 많이 소요되는 힘든 작업이다. 따라서 일관된 법칙에 따라 편리하고 효율적으로 적용할 수 있는 데이터 다듬기 기법이 절실하게 필요한 상황이라고 하겠다.</p>
<p>통계 데이터 세트는 변수가 열, 관찰값이 행을 이루고 있는 2차원 구조를 가지고 있으며 데이터 프레임으로 입력된다. 이 장에서 살펴볼 내용은 패키지 <code>dplyr</code>에서 수행할 수 있는 다양한 데이터 프레임 다듬기 기법이다. 먼저 데이터 프레임 다듬기 작업에 사용되는 매우 중요하면서도 기본적인 <code>dplyr</code> 함수들을 살펴볼 것이다. 이어서 이러한 기본 <code>dplyr</code> 함수들 이 그룹으로 구분된 데이터에 대해서는 어떻게 작용을 하는지 살펴볼 것이며, 여러 개의 변수들을 대상으로 반복적으로 실행해야 하는 동일한 작업을 함수 <code>across()</code>를 이용하면 얼마나 간편하게 할 수 있는지를 살펴볼 것이다. 또한 행 단위로 작업이 이루어져야 하는 경우에 함수 <code>rowwise()</code>가 어떤 역할을 하는지도 살펴볼 것이다.</p>
<p>기본 <code>dplyr</code> 함수들은 세 가지 그룹으로 나누어 볼 수 있다. 함수 <code>filter()</code>, <code>slice()</code>, <code>arrange()</code>, <code>distinct()</code>와 같이 데이터 프레임의 행을 작업 대상으로 하는 함수가 있고, 함수 <code>select()</code>, <code>rename()</code>, <code>mutate()</code>, <code>relocate()</code>와 같이 열을 대상으로 작업을 하는 함수가 있으며, 요약 통계량을 계산하는 함수 <code>summarise()</code>가 있다.</p>
<p>기본 <code>dplyr</code> 함수들이 공통으로 갖고 있는 특징은 데이터 프레임(또는 tibble)이 함수들의 첫 번째 입력요소라는 것이다. 두 번째 특징은 각 함수 안에서 입력된 데이터 프레임의 변수를 인덱싱 기호(<code>$</code>) 없이 사용할 수 있다는 것이다. 마지막 특징은 이 함수들이 생성하는 결과는 또 다른 데이터 프레임(또는 tibble)이라는 것이다. 기본 함수들이 갖고 있는 이러한 특징을 이용해서 조금 더 효율적인 프로그램이 가능하도록 <code>dplyr</code>에서는 pipe 기능을 사용하도록 하자.</p>
<ul>
<li>Pipe 기능</li>
</ul>
<p>Pipe 기능이란 한 명령문의 결과물을 바로 다음 명령문의 입력 요소로 직접 사용할 수 있도록 명령문들을 서로 연결하는 기능을 의미한다. 이것이 가능하다면, 분석 중간 단계로 생성되는 무수한 객체들을 따로 저장할 필요가 없기 때문에 프로그램 자체가 매우 깔끔하게 정리되며, 분석 흐름을 쉽게 이해할 수 있게 된다. Pipe 연산자 <code>%&gt;%</code>는 <code>tidyverse</code>에 속한 패키지인 <code>magrittr</code>에서 정의된 것으로 <code>tidyverse</code>에 속한 다른 패키지에서도 사용이 가능하다. RStudio에서 pipe 연산자 <code>%&gt;%</code>의 입력은 <code>Shift+Ctrl+M</code> 키를 함께 누르면 된다.</p>
<p>기본적인 형태는 <code>lhs %&gt;% rhs</code>인데, <code>lhs</code>는 데이터 객체이거나 데이터 객체를 생성하는 함수가 되고, <code>rhs</code>는 <code>lhs</code>를 입력 요소로 하는 함수가 된다. 예를 들어 <code>x %&gt;% f()</code>는 객체 <code>x</code>를 함수 <code>f()</code>의 입력 요소로 하는 <code>f(x)</code>를 의미한다. 만일 <code>rhs</code>에 다른 요소가 있다면 <code>lhs</code>는 <code>rhs</code>의 첫 번째 입력 요소가 된다. 따라서 <code>x %&gt;% f(y)</code>는 <code>f(x,y)</code>를 의미한다. 만일 <code>lhs</code>가 <code>rhs</code>의 첫 번째 요소가 아닌 경우에는 원하는 위치에 점(.)을 찍어야 한다. 예를 들어, <code>x %&gt;% f(y,.)</code>은 <code>f(y,x)</code>를 의미한다.</p>
<p>Base R에도 R 버전 4.1.0부터 pipe 연산자 <code>|&gt;</code>가 도입되었다.
패키지 <code>tidyverse</code>를 불러오지 않아도 사용할 수 있다는 것이 장점으로 볼 수 있는 연산자이다.
사용법은 <code>lhs |&gt; rhs</code>이며, <code>lhs</code>와 <code>rhs</code>의 의미는 <code>%&gt;%</code>의 경우와 같다.
예를 들어 데이터 프레임 <code>mtcars</code>의 처음 6 행을 <code>|&gt;</code>을 사용해서 다음과 같이 출력할 수 있다.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="chapter-dplyr.html#cb341-1" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> </span>
<span id="cb341-2"><a href="chapter-dplyr.html#cb341-2" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb341-3"><a href="chapter-dplyr.html#cb341-3" tabindex="-1"></a><span class="do">##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span>
<span id="cb341-4"><a href="chapter-dplyr.html#cb341-4" tabindex="-1"></a><span class="do">## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span id="cb341-5"><a href="chapter-dplyr.html#cb341-5" tabindex="-1"></a><span class="do">## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span id="cb341-6"><a href="chapter-dplyr.html#cb341-6" tabindex="-1"></a><span class="do">## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span></span>
<span id="cb341-7"><a href="chapter-dplyr.html#cb341-7" tabindex="-1"></a><span class="do">## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span></span>
<span id="cb341-8"><a href="chapter-dplyr.html#cb341-8" tabindex="-1"></a><span class="do">## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span></span>
<span id="cb341-9"><a href="chapter-dplyr.html#cb341-9" tabindex="-1"></a><span class="do">## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</span></span></code></pre></div>
<p>RStudio의 메뉴 <code>Tools &gt; Global Options... &gt; Code</code>에서 <code>Use native pipe operator, |&gt;</code>를 선택하면, <code>Shift+Ctrl+M</code>이 <code>|&gt;</code>의 단축키가 된다.</p>
<p>앞으로 이 책에서는 base R의 pipe 연산자인 <code>|&gt;</code>을 주로 사용하도록 하겠다.</p>
<div id="행을-작업-대상으로-하는-함수" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> 행을 작업 대상으로 하는 함수<a href="chapter-dplyr.html#행을-작업-대상으로-하는-함수" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="조건에-의한-행-선택-filter" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> 조건에 의한 행 선택: <code>filter()</code><a href="chapter-dplyr.html#조건에-의한-행-선택-filter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>함수 <code>filter()</code>를 이용하면, 주어진 데이터 프레임에서 특정한 조건을 만족하는 행을 선택 할 수 있다. 조건을 설정할 때는 비교 연산자(<code>&gt;, &gt;=, &lt;, &lt;=, !=, ==</code>)와 논리 연산자(<code>&amp;, |, !</code>)가 사용되며, 연산자 <code>%in%</code>이 매우 유용하게 사용된다. 예제를 통해 자세한 사용법을 확인해 보자.</p>
<ul>
<li>예제: <code>mtcars</code></li>
</ul>
<p>변수 <code>mpg</code>의 값이 30 이상인 자동차를 선택해 보자. 함수 <code>filter()</code>에 전통적인 데이터 프레임을 입력하면 결과로 전통적인 데이터 프레임이 출력되고, tibble을 입력하면 결과가 tibble로 출력된다. 데이터 프레임 <code>mtcars</code>를 tibble로 전환하고 선택 조건과 더불어 함수 <code>filter()</code>에 입력해 보자.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="chapter-dplyr.html#cb342-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="chapter-dplyr.html#cb343-1" tabindex="-1"></a>mtcars_t <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mtcars)</span>
<span id="cb343-2"><a href="chapter-dplyr.html#cb343-2" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb343-3"><a href="chapter-dplyr.html#cb343-3" tabindex="-1"></a>  <span class="fu">filter</span>(mpg <span class="sc">&gt;=</span> <span class="dv">30</span>)</span>
<span id="cb343-4"><a href="chapter-dplyr.html#cb343-4" tabindex="-1"></a><span class="do">## # A tibble: 4 × 11</span></span>
<span id="cb343-5"><a href="chapter-dplyr.html#cb343-5" tabindex="-1"></a><span class="do">##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb343-6"><a href="chapter-dplyr.html#cb343-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb343-7"><a href="chapter-dplyr.html#cb343-7" tabindex="-1"></a><span class="do">## 1  32.4     4  78.7    66  4.08  2.2   19.5     1     1     4     1</span></span>
<span id="cb343-8"><a href="chapter-dplyr.html#cb343-8" tabindex="-1"></a><span class="do">## 2  30.4     4  75.7    52  4.93  1.62  18.5     1     1     4     2</span></span>
<span id="cb343-9"><a href="chapter-dplyr.html#cb343-9" tabindex="-1"></a><span class="do">## 3  33.9     4  71.1    65  4.22  1.84  19.9     1     1     4     1</span></span>
<span id="cb343-10"><a href="chapter-dplyr.html#cb343-10" tabindex="-1"></a><span class="do">## 4  30.4     4  95.1   113  3.77  1.51  16.9     1     1     5     2</span></span></code></pre></div>
<p>변수 <code>mpg</code>의 값이 30 이상이고 변수 wt의 값이 1.8 미만인 자동차를 선택해 보자. 함수 <code>filter()</code>에서는 콤마(<code>,</code>)가 논리 연산자 <code>&amp;</code> 와 같은 기능을 갖고 있다.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="chapter-dplyr.html#cb344-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb344-2"><a href="chapter-dplyr.html#cb344-2" tabindex="-1"></a>  <span class="fu">filter</span>(mpg <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">1.8</span>)</span>
<span id="cb344-3"><a href="chapter-dplyr.html#cb344-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 11</span></span>
<span id="cb344-4"><a href="chapter-dplyr.html#cb344-4" tabindex="-1"></a><span class="do">##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb344-5"><a href="chapter-dplyr.html#cb344-5" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb344-6"><a href="chapter-dplyr.html#cb344-6" tabindex="-1"></a><span class="do">## 1  30.4     4  75.7    52  4.93  1.62  18.5     1     1     4     2</span></span>
<span id="cb344-7"><a href="chapter-dplyr.html#cb344-7" tabindex="-1"></a><span class="do">## 2  30.4     4  95.1   113  3.77  1.51  16.9     1     1     5     2</span></span></code></pre></div>
<p>변수 <code>mpg</code>의 값이 30 이하이고, 변수 <code>cyl</code>의 값이 6 또는 8이며, 변수 <code>am</code>의 값이 1인 자동차를 선택해 보자. 이 경우에, 변수 <code>cyl</code>의 값이 6 또는 8인 사건에 대하여 논리 연산자를 사용해서 <code>cyl == 6|cyl == 8</code>으로 조건을 설정하는 것보다는, <code>cyl %in% c(6,8)</code>로 쓰는 것이 훨씬 간단한 방법이 된다.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="chapter-dplyr.html#cb345-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb345-2"><a href="chapter-dplyr.html#cb345-2" tabindex="-1"></a>  <span class="fu">filter</span>(mpg <span class="sc">&lt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>) <span class="sc">&amp;</span> am <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb345-3"><a href="chapter-dplyr.html#cb345-3" tabindex="-1"></a><span class="do">## # A tibble: 5 × 11</span></span>
<span id="cb345-4"><a href="chapter-dplyr.html#cb345-4" tabindex="-1"></a><span class="do">##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb345-5"><a href="chapter-dplyr.html#cb345-5" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb345-6"><a href="chapter-dplyr.html#cb345-6" tabindex="-1"></a><span class="do">## 1  21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb345-7"><a href="chapter-dplyr.html#cb345-7" tabindex="-1"></a><span class="do">## 2  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb345-8"><a href="chapter-dplyr.html#cb345-8" tabindex="-1"></a><span class="do">## 3  15.8     8   351   264  4.22  3.17  14.5     0     1     5     4</span></span>
<span id="cb345-9"><a href="chapter-dplyr.html#cb345-9" tabindex="-1"></a><span class="do">## 4  19.7     6   145   175  3.62  2.77  15.5     0     1     5     6</span></span>
<span id="cb345-10"><a href="chapter-dplyr.html#cb345-10" tabindex="-1"></a><span class="do">## 5  15       8   301   335  3.54  3.57  14.6     0     1     5     8</span></span></code></pre></div>
<p>변수 <code>mpg</code>의 값이 <code>mpg</code>의 중앙값과 <span class="math inline">\(Q_{3}\)</span> 사이에 있는 자동차를 선택해 보자.
여기서 <span class="math inline">\(Q_{3}\)</span>는 0.75분위수를 의미하는 것으로서, <span class="math inline">\(p\)</span> 분위수란 전체 데이터 중 <span class="math inline">\((100 \times p)\)</span>% 데이터보다는 크고, 나머지 <span class="math inline">\((100 \times (1-p))\)</span>% 데이터보다는 작은 수를 의미한다.
분위수의 계산은 함수 <code>quantile()</code>로 하는데, <code>mtcars</code>의 변수 <code>mpg</code>의 분위수를 계산해 보자.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="chapter-dplyr.html#cb346-1" tabindex="-1"></a><span class="fu">quantile</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb346-2"><a href="chapter-dplyr.html#cb346-2" tabindex="-1"></a><span class="do">##     0%    25%    50%    75%   100% </span></span>
<span id="cb346-3"><a href="chapter-dplyr.html#cb346-3" tabindex="-1"></a><span class="do">## 10.400 15.425 19.200 22.800 33.900</span></span></code></pre></div>
<p>특정 분위수를 계산하고자 한다면, <code>probs=</code>에 지정하면 된다.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="chapter-dplyr.html#cb347-1" tabindex="-1"></a><span class="fu">quantile</span>(mtcars<span class="sc">$</span>mpg, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>))</span>
<span id="cb347-2"><a href="chapter-dplyr.html#cb347-2" tabindex="-1"></a><span class="do">##  50%  75% </span></span>
<span id="cb347-3"><a href="chapter-dplyr.html#cb347-3" tabindex="-1"></a><span class="do">## 19.2 22.8</span></span></code></pre></div>
<p>이제 변수 <code>mpg</code>의 값이 <code>mpg</code>의 중앙값과 <span class="math inline">\(Q_{3}\)</span> 사이에 있는 자동차를 선택해 보자.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="chapter-dplyr.html#cb348-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb348-2"><a href="chapter-dplyr.html#cb348-2" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb348-3"><a href="chapter-dplyr.html#cb348-3" tabindex="-1"></a>    mpg <span class="sc">&gt;=</span> <span class="fu">median</span>(mpg) <span class="sc">&amp;</span> mpg <span class="sc">&lt;=</span> <span class="fu">quantile</span>(mpg, <span class="at">probs =</span> <span class="fl">0.75</span>)</span>
<span id="cb348-4"><a href="chapter-dplyr.html#cb348-4" tabindex="-1"></a>  )</span>
<span id="cb348-5"><a href="chapter-dplyr.html#cb348-5" tabindex="-1"></a><span class="do">## # A tibble: 10 × 11</span></span>
<span id="cb348-6"><a href="chapter-dplyr.html#cb348-6" tabindex="-1"></a><span class="do">##      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb348-7"><a href="chapter-dplyr.html#cb348-7" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb348-8"><a href="chapter-dplyr.html#cb348-8" tabindex="-1"></a><span class="do">##  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb348-9"><a href="chapter-dplyr.html#cb348-9" tabindex="-1"></a><span class="do">##  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb348-10"><a href="chapter-dplyr.html#cb348-10" tabindex="-1"></a><span class="do">##  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb348-11"><a href="chapter-dplyr.html#cb348-11" tabindex="-1"></a><span class="do">##  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1</span></span>
<span id="cb348-12"><a href="chapter-dplyr.html#cb348-12" tabindex="-1"></a><span class="do">##  5  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2</span></span>
<span id="cb348-13"><a href="chapter-dplyr.html#cb348-13" tabindex="-1"></a><span class="do">##  6  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4</span></span>
<span id="cb348-14"><a href="chapter-dplyr.html#cb348-14" tabindex="-1"></a><span class="do">##  7  21.5     4  120.    97  3.7   2.46  20.0     1     0     3     1</span></span>
<span id="cb348-15"><a href="chapter-dplyr.html#cb348-15" tabindex="-1"></a><span class="do">##  8  19.2     8  400    175  3.08  3.84  17.0     0     0     3     2</span></span>
<span id="cb348-16"><a href="chapter-dplyr.html#cb348-16" tabindex="-1"></a><span class="do">##  9  19.7     6  145    175  3.62  2.77  15.5     0     1     5     6</span></span>
<span id="cb348-17"><a href="chapter-dplyr.html#cb348-17" tabindex="-1"></a><span class="do">## 10  21.4     4  121    109  4.11  2.78  18.6     1     1     4     2</span></span></code></pre></div>
<p>벡터 <code>x</code>가 특정 두 숫자 사이에 있는지를 확인하는 방법은 <code>x &gt;= left &amp; x &lt;= right</code>가 되는데, 이것을 함수 <code>between()</code>을 이용해서 <code>between(x, left, right)</code>로 할 수 있다.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="chapter-dplyr.html#cb349-1" tabindex="-1"></a><span class="fu">between</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb349-2"><a href="chapter-dplyr.html#cb349-2" tabindex="-1"></a><span class="do">## [1] FALSE  TRUE  TRUE  TRUE FALSE</span></span></code></pre></div>
<p>따라서 위 예제는 다음과 같이 실행해도 동일한 결과를 얻는다.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="chapter-dplyr.html#cb350-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb350-2"><a href="chapter-dplyr.html#cb350-2" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb350-3"><a href="chapter-dplyr.html#cb350-3" tabindex="-1"></a>    <span class="fu">between</span>(mpg, <span class="fu">median</span>(mpg), <span class="fu">quantile</span>(mpg, <span class="at">probs =</span> <span class="fl">0.75</span>))</span>
<span id="cb350-4"><a href="chapter-dplyr.html#cb350-4" tabindex="-1"></a>    )</span>
<span id="cb350-5"><a href="chapter-dplyr.html#cb350-5" tabindex="-1"></a><span class="do">## # A tibble: 10 × 11</span></span>
<span id="cb350-6"><a href="chapter-dplyr.html#cb350-6" tabindex="-1"></a><span class="do">##      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb350-7"><a href="chapter-dplyr.html#cb350-7" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb350-8"><a href="chapter-dplyr.html#cb350-8" tabindex="-1"></a><span class="do">##  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb350-9"><a href="chapter-dplyr.html#cb350-9" tabindex="-1"></a><span class="do">##  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb350-10"><a href="chapter-dplyr.html#cb350-10" tabindex="-1"></a><span class="do">##  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb350-11"><a href="chapter-dplyr.html#cb350-11" tabindex="-1"></a><span class="do">##  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1</span></span>
<span id="cb350-12"><a href="chapter-dplyr.html#cb350-12" tabindex="-1"></a><span class="do">##  5  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2</span></span>
<span id="cb350-13"><a href="chapter-dplyr.html#cb350-13" tabindex="-1"></a><span class="do">##  6  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4</span></span>
<span id="cb350-14"><a href="chapter-dplyr.html#cb350-14" tabindex="-1"></a><span class="do">##  7  21.5     4  120.    97  3.7   2.46  20.0     1     0     3     1</span></span>
<span id="cb350-15"><a href="chapter-dplyr.html#cb350-15" tabindex="-1"></a><span class="do">##  8  19.2     8  400    175  3.08  3.84  17.0     0     0     3     2</span></span>
<span id="cb350-16"><a href="chapter-dplyr.html#cb350-16" tabindex="-1"></a><span class="do">##  9  19.7     6  145    175  3.62  2.77  15.5     0     1     5     6</span></span>
<span id="cb350-17"><a href="chapter-dplyr.html#cb350-17" tabindex="-1"></a><span class="do">## 10  21.4     4  121    109  4.11  2.78  18.6     1     1     4     2</span></span></code></pre></div>
<ul>
<li>예제: <code>airquality</code></li>
</ul>
<p>데이터 프레임 <code>airquality</code>는 1973년 5월부터 9월까지 미국 뉴욕시의 공기의 질과 관련된 조사 결과를 담은 데이터 세트이다. <code>airs</code>라는 이름의 tibble로 전환하고, 처음 5개 케이스를 출력해 보자.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="chapter-dplyr.html#cb351-1" tabindex="-1"></a>airs <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(airquality) <span class="sc">|&gt;</span> </span>
<span id="cb351-2"><a href="chapter-dplyr.html#cb351-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb351-3"><a href="chapter-dplyr.html#cb351-3" tabindex="-1"></a><span class="do">## # A tibble: 153 × 6</span></span>
<span id="cb351-4"><a href="chapter-dplyr.html#cb351-4" tabindex="-1"></a><span class="do">##   Ozone Solar.R  Wind  Temp Month   Day</span></span>
<span id="cb351-5"><a href="chapter-dplyr.html#cb351-5" tabindex="-1"></a><span class="do">##   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb351-6"><a href="chapter-dplyr.html#cb351-6" tabindex="-1"></a><span class="do">## 1    41     190   7.4    67     5     1</span></span>
<span id="cb351-7"><a href="chapter-dplyr.html#cb351-7" tabindex="-1"></a><span class="do">## 2    36     118   8      72     5     2</span></span>
<span id="cb351-8"><a href="chapter-dplyr.html#cb351-8" tabindex="-1"></a><span class="do">## 3    12     149  12.6    74     5     3</span></span>
<span id="cb351-9"><a href="chapter-dplyr.html#cb351-9" tabindex="-1"></a><span class="do">## 4    18     313  11.5    62     5     4</span></span>
<span id="cb351-10"><a href="chapter-dplyr.html#cb351-10" tabindex="-1"></a><span class="do">## 5    NA      NA  14.3    56     5     5</span></span>
<span id="cb351-11"><a href="chapter-dplyr.html#cb351-11" tabindex="-1"></a><span class="do">## # ℹ 148 more rows</span></span></code></pre></div>
<p>변수 <code>Ozone</code> 또는 <code>Solar.R</code>이 결측값인 행을 선택해 보자. 결측값의 확인은 함수 <code>is.na()</code>로 할 수 있다.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="chapter-dplyr.html#cb352-1" tabindex="-1"></a>airs <span class="sc">|&gt;</span> </span>
<span id="cb352-2"><a href="chapter-dplyr.html#cb352-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Ozone) <span class="sc">|</span> <span class="fu">is.na</span>(Solar.R)) <span class="sc">|&gt;</span> </span>
<span id="cb352-3"><a href="chapter-dplyr.html#cb352-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb352-4"><a href="chapter-dplyr.html#cb352-4" tabindex="-1"></a><span class="do">## # A tibble: 42 × 6</span></span>
<span id="cb352-5"><a href="chapter-dplyr.html#cb352-5" tabindex="-1"></a><span class="do">##   Ozone Solar.R  Wind  Temp Month   Day</span></span>
<span id="cb352-6"><a href="chapter-dplyr.html#cb352-6" tabindex="-1"></a><span class="do">##   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb352-7"><a href="chapter-dplyr.html#cb352-7" tabindex="-1"></a><span class="do">## 1    NA      NA  14.3    56     5     5</span></span>
<span id="cb352-8"><a href="chapter-dplyr.html#cb352-8" tabindex="-1"></a><span class="do">## 2    28      NA  14.9    66     5     6</span></span>
<span id="cb352-9"><a href="chapter-dplyr.html#cb352-9" tabindex="-1"></a><span class="do">## 3    NA     194   8.6    69     5    10</span></span>
<span id="cb352-10"><a href="chapter-dplyr.html#cb352-10" tabindex="-1"></a><span class="do">## 4     7      NA   6.9    74     5    11</span></span>
<span id="cb352-11"><a href="chapter-dplyr.html#cb352-11" tabindex="-1"></a><span class="do">## 5    NA      66  16.6    57     5    25</span></span>
<span id="cb352-12"><a href="chapter-dplyr.html#cb352-12" tabindex="-1"></a><span class="do">## # ℹ 37 more rows</span></span></code></pre></div>
</div>
<div id="위치에-의한-행-선택-slice-및-그와-관련된-함수" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> 위치에 의한 행 선택: <code>slice()</code> 및 그와 관련된 함수<a href="chapter-dplyr.html#위치에-의한-행-선택-slice-및-그와-관련된-함수" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>위치에 의한 행 선택이란 데이터 프레임에서 선택하고자 하는 행 번호를 지정해서 선택하는 것을 의미한다.</p>
<ul>
<li>함수 <code>slice()</code>에 의한 행 선택</li>
</ul>
<p>함수 <code>slice()</code>에는 행의 번호를 직접 지정해서 특정 행을 선택하거나 제거할 수 있다. 양의 정수를 입력하면 해당 위치의 행이 선택되고, 음의 정수를 입력하면 해당 위치의 행이 제거된다. 입력되는 정수는 모두 양수이거나 모두 음수이어야 한다. 데이터 프레임 <code>iris</code>를 tibble로 전환하고 5번째 행부터 10번째 행까지 선택해 보자.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="chapter-dplyr.html#cb353-1" tabindex="-1"></a>iris_t <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span>
<span id="cb353-2"><a href="chapter-dplyr.html#cb353-2" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb353-3"><a href="chapter-dplyr.html#cb353-3" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb353-4"><a href="chapter-dplyr.html#cb353-4" tabindex="-1"></a><span class="do">## # A tibble: 6 × 5</span></span>
<span id="cb353-5"><a href="chapter-dplyr.html#cb353-5" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb353-6"><a href="chapter-dplyr.html#cb353-6" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb353-7"><a href="chapter-dplyr.html#cb353-7" tabindex="-1"></a><span class="do">## 1          5           3.6          1.4         0.2 setosa </span></span>
<span id="cb353-8"><a href="chapter-dplyr.html#cb353-8" tabindex="-1"></a><span class="do">## 2          5.4         3.9          1.7         0.4 setosa </span></span>
<span id="cb353-9"><a href="chapter-dplyr.html#cb353-9" tabindex="-1"></a><span class="do">## 3          4.6         3.4          1.4         0.3 setosa </span></span>
<span id="cb353-10"><a href="chapter-dplyr.html#cb353-10" tabindex="-1"></a><span class="do">## 4          5           3.4          1.5         0.2 setosa </span></span>
<span id="cb353-11"><a href="chapter-dplyr.html#cb353-11" tabindex="-1"></a><span class="do">## 5          4.4         2.9          1.4         0.2 setosa </span></span>
<span id="cb353-12"><a href="chapter-dplyr.html#cb353-12" tabindex="-1"></a><span class="do">## 6          4.9         3.1          1.5         0.1 setosa</span></span></code></pre></div>
<p>이번에는 5번째 행부터 10번째 행을 제거해 보자.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="chapter-dplyr.html#cb354-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb354-2"><a href="chapter-dplyr.html#cb354-2" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb354-3"><a href="chapter-dplyr.html#cb354-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb354-4"><a href="chapter-dplyr.html#cb354-4" tabindex="-1"></a><span class="do">## # A tibble: 144 × 5</span></span>
<span id="cb354-5"><a href="chapter-dplyr.html#cb354-5" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb354-6"><a href="chapter-dplyr.html#cb354-6" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb354-7"><a href="chapter-dplyr.html#cb354-7" tabindex="-1"></a><span class="do">## 1          5.1         3.5          1.4         0.2 setosa </span></span>
<span id="cb354-8"><a href="chapter-dplyr.html#cb354-8" tabindex="-1"></a><span class="do">## 2          4.9         3            1.4         0.2 setosa </span></span>
<span id="cb354-9"><a href="chapter-dplyr.html#cb354-9" tabindex="-1"></a><span class="do">## 3          4.7         3.2          1.3         0.2 setosa </span></span>
<span id="cb354-10"><a href="chapter-dplyr.html#cb354-10" tabindex="-1"></a><span class="do">## # ℹ 141 more rows</span></span></code></pre></div>
<p>이번에는 <code>iris</code>의 마지막 행을 선택해 보자. 이 경우 유용하게 사용될 함수가 <code>n()</code>이다. 이 함수는 데이터 프레임의 행의 개수를 세는 함수로서 단독으로는 사용될 수 없고 <code>dplyr</code> 기본 함수들과 함께 사용되어야 한다.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="chapter-dplyr.html#cb355-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb355-2"><a href="chapter-dplyr.html#cb355-2" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">n</span>())</span>
<span id="cb355-3"><a href="chapter-dplyr.html#cb355-3" tabindex="-1"></a><span class="do">## # A tibble: 1 × 5</span></span>
<span id="cb355-4"><a href="chapter-dplyr.html#cb355-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species  </span></span>
<span id="cb355-5"><a href="chapter-dplyr.html#cb355-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;    </span></span>
<span id="cb355-6"><a href="chapter-dplyr.html#cb355-6" tabindex="-1"></a><span class="do">## 1          5.9           3          5.1         1.8 virginica</span></span></code></pre></div>
<ul>
<li>함수 <code>slice_head()</code>와 <code>slice_tail()</code>에 의한 행 선택</li>
</ul>
<p>데이터 프레임의 처음 몇 개 행을 선택하거나 마지막 몇 개 행을 선택하고자 할 때 사용되는 함수이다. 행의 개수를 지정하는 경우에는 <code>n</code>을 사용하고 행의 비율을 지정하는 경우에 는 <code>prop</code>를 사용하면 된다. 데이터 프레임 <code>iris</code>의 처음 3개 행과 마지막 3개 행을 각각 선택해 보자.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="chapter-dplyr.html#cb356-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb356-2"><a href="chapter-dplyr.html#cb356-2" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb356-3"><a href="chapter-dplyr.html#cb356-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 5</span></span>
<span id="cb356-4"><a href="chapter-dplyr.html#cb356-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb356-5"><a href="chapter-dplyr.html#cb356-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb356-6"><a href="chapter-dplyr.html#cb356-6" tabindex="-1"></a><span class="do">## 1          5.1         3.5          1.4         0.2 setosa </span></span>
<span id="cb356-7"><a href="chapter-dplyr.html#cb356-7" tabindex="-1"></a><span class="do">## 2          4.9         3            1.4         0.2 setosa </span></span>
<span id="cb356-8"><a href="chapter-dplyr.html#cb356-8" tabindex="-1"></a><span class="do">## 3          4.7         3.2          1.3         0.2 setosa</span></span></code></pre></div>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="chapter-dplyr.html#cb357-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb357-2"><a href="chapter-dplyr.html#cb357-2" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb357-3"><a href="chapter-dplyr.html#cb357-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 5</span></span>
<span id="cb357-4"><a href="chapter-dplyr.html#cb357-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species  </span></span>
<span id="cb357-5"><a href="chapter-dplyr.html#cb357-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;    </span></span>
<span id="cb357-6"><a href="chapter-dplyr.html#cb357-6" tabindex="-1"></a><span class="do">## 1          6.5         3            5.2         2   virginica</span></span>
<span id="cb357-7"><a href="chapter-dplyr.html#cb357-7" tabindex="-1"></a><span class="do">## 2          6.2         3.4          5.4         2.3 virginica</span></span>
<span id="cb357-8"><a href="chapter-dplyr.html#cb357-8" tabindex="-1"></a><span class="do">## 3          5.9         3            5.1         1.8 virginica</span></span></code></pre></div>
<ul>
<li>함수 <code>slice_sample()</code>에 의한 행 선택</li>
</ul>
<p>데이터 프레임의 일부 행을 단순임의추출방법으로 선택할 때 사용되는 함수이다. 행의 개수를 지정해서 추출하는 경우에는 <code>n</code>을 사용하고, 행의 비율을 지정해서 추출하는 경우에는 <code>prop</code>를 사용하면 된다. 두 함수 모두 비복원추출이 디폴트로 적용되며, 만일 복원추출을 원한다면, <code>replace = TRUE</code>를 입력하면 된다. 데이터 프레임 <code>iris</code>에서 3개 행을 임의추출해 보자.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="chapter-dplyr.html#cb358-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb358-2"><a href="chapter-dplyr.html#cb358-2" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb358-3"><a href="chapter-dplyr.html#cb358-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 5</span></span>
<span id="cb358-4"><a href="chapter-dplyr.html#cb358-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   </span></span>
<span id="cb358-5"><a href="chapter-dplyr.html#cb358-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;     </span></span>
<span id="cb358-6"><a href="chapter-dplyr.html#cb358-6" tabindex="-1"></a><span class="do">## 1          4.6         3.4          1.4         0.3 setosa    </span></span>
<span id="cb358-7"><a href="chapter-dplyr.html#cb358-7" tabindex="-1"></a><span class="do">## 2          4.4         3            1.3         0.2 setosa    </span></span>
<span id="cb358-8"><a href="chapter-dplyr.html#cb358-8" tabindex="-1"></a><span class="do">## 3          6.3         2.5          4.9         1.5 versicolor</span></span></code></pre></div>
<p>전체 행 중 2%의 행을 비복원추출로 선택해 보자.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="chapter-dplyr.html#cb359-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb359-2"><a href="chapter-dplyr.html#cb359-2" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.02</span>)</span>
<span id="cb359-3"><a href="chapter-dplyr.html#cb359-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 5</span></span>
<span id="cb359-4"><a href="chapter-dplyr.html#cb359-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   </span></span>
<span id="cb359-5"><a href="chapter-dplyr.html#cb359-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;     </span></span>
<span id="cb359-6"><a href="chapter-dplyr.html#cb359-6" tabindex="-1"></a><span class="do">## 1          5.8         4            1.2         0.2 setosa    </span></span>
<span id="cb359-7"><a href="chapter-dplyr.html#cb359-7" tabindex="-1"></a><span class="do">## 2          5.1         3.8          1.9         0.4 setosa    </span></span>
<span id="cb359-8"><a href="chapter-dplyr.html#cb359-8" tabindex="-1"></a><span class="do">## 3          5.1         2.5          3           1.1 versicolor</span></span></code></pre></div>
<p>이번에는 전체 행 중 2%의 행을 복원추출로 선택해 보자.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="chapter-dplyr.html#cb360-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb360-2"><a href="chapter-dplyr.html#cb360-2" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.02</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb360-3"><a href="chapter-dplyr.html#cb360-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 5</span></span>
<span id="cb360-4"><a href="chapter-dplyr.html#cb360-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   </span></span>
<span id="cb360-5"><a href="chapter-dplyr.html#cb360-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;     </span></span>
<span id="cb360-6"><a href="chapter-dplyr.html#cb360-6" tabindex="-1"></a><span class="do">## 1          4.8         3.1          1.6         0.2 setosa    </span></span>
<span id="cb360-7"><a href="chapter-dplyr.html#cb360-7" tabindex="-1"></a><span class="do">## 2          6.3         3.3          6           2.5 virginica </span></span>
<span id="cb360-8"><a href="chapter-dplyr.html#cb360-8" tabindex="-1"></a><span class="do">## 3          5.8         2.7          3.9         1.2 versicolor</span></span></code></pre></div>
<ul>
<li>함수 <code>slice_max()</code>와 <code>slice_min()</code>에 의한 행 선택</li>
</ul>
<p>특정 변수가 가장 큰 값을 갖거나 혹은 가장 작은 값을 갖는 행을 선택할 때 사용되는 함수이다. 기준으로 사용할 변수를 입력하고 이어서 행의 개수를 지정하는 경우에는 <code>n</code>을, 행의 비율을 지정하는 경우에는 <code>prop</code>를 입력하면 된다. 데이터 프레임 <code>iris</code>에서 변수 <code>Sepal.Width</code>의 값이 가장 큰 두 개 행을 선택해 보자.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="chapter-dplyr.html#cb361-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb361-2"><a href="chapter-dplyr.html#cb361-2" tabindex="-1"></a>  <span class="fu">slice_max</span>(Sepal.Width, <span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb361-3"><a href="chapter-dplyr.html#cb361-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 5</span></span>
<span id="cb361-4"><a href="chapter-dplyr.html#cb361-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb361-5"><a href="chapter-dplyr.html#cb361-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb361-6"><a href="chapter-dplyr.html#cb361-6" tabindex="-1"></a><span class="do">## 1          5.7         4.4          1.5         0.4 setosa </span></span>
<span id="cb361-7"><a href="chapter-dplyr.html#cb361-7" tabindex="-1"></a><span class="do">## 2          5.5         4.2          1.4         0.2 setosa</span></span></code></pre></div>
<p>이번에는 <code>Petal.Length</code>의 값이 가장 작은 두 개 행을 선택해 보자.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="chapter-dplyr.html#cb362-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb362-2"><a href="chapter-dplyr.html#cb362-2" tabindex="-1"></a>  <span class="fu">slice_min</span>(Petal.Length, <span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb362-3"><a href="chapter-dplyr.html#cb362-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 5</span></span>
<span id="cb362-4"><a href="chapter-dplyr.html#cb362-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb362-5"><a href="chapter-dplyr.html#cb362-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb362-6"><a href="chapter-dplyr.html#cb362-6" tabindex="-1"></a><span class="do">## 1          4.6         3.6          1           0.2 setosa </span></span>
<span id="cb362-7"><a href="chapter-dplyr.html#cb362-7" tabindex="-1"></a><span class="do">## 2          4.3         3            1.1         0.1 setosa</span></span></code></pre></div>
</div>
<div id="행의-정렬-arrange" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> 행의 정렬: <code>arrange()</code><a href="chapter-dplyr.html#행의-정렬-arrange" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>함수 <code>arrange()</code>는 특정 변수를 기준으로 데이터 프레임의 행을 재배열할 때 사용된다. 함수에는 정렬의 기준이 되는 변수를 입력하면 되는데, 2개 이상의 정렬 기준 변수를 입력하게 되면 추가된 변수는 앞선 변수가 같은 값을 갖는 행들의 정렬 기준으로 사용된다. 정렬은 오름차순이 디폴트이며, 내림차순으로 배열하고자 할 때에는 기준 변수를 함수 <code>desc()</code>와 함께 사용해야 한다.</p>
<ul>
<li>예제: <code>mtcars</code></li>
</ul>
<p>데이터 프레임 <code>mtcars</code>를 tibble로 전환하고 변수 <code>mpg</code>의 값이 가장 좋지 않은 자동차부터 시작해서 더 좋아지는 순서로 다시 배열해 보자. 연비가 좋지 않다는 것은 연비가 낮다는 것을 의미하는 것이므로 변수 <code>mpg</code>를 오름차순 정렬 변수로 사용하면 된다.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="chapter-dplyr.html#cb363-1" tabindex="-1"></a>mtcars_t <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mtcars)</span>
<span id="cb363-2"><a href="chapter-dplyr.html#cb363-2" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb363-3"><a href="chapter-dplyr.html#cb363-3" tabindex="-1"></a>  <span class="fu">arrange</span>(mpg) <span class="sc">|&gt;</span>  </span>
<span id="cb363-4"><a href="chapter-dplyr.html#cb363-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb363-5"><a href="chapter-dplyr.html#cb363-5" tabindex="-1"></a><span class="do">## # A tibble: 32 × 11</span></span>
<span id="cb363-6"><a href="chapter-dplyr.html#cb363-6" tabindex="-1"></a><span class="do">##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb363-7"><a href="chapter-dplyr.html#cb363-7" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb363-8"><a href="chapter-dplyr.html#cb363-8" tabindex="-1"></a><span class="do">## 1  10.4     8   472   205  2.93  5.25  18.0     0     0     3     4</span></span>
<span id="cb363-9"><a href="chapter-dplyr.html#cb363-9" tabindex="-1"></a><span class="do">## 2  10.4     8   460   215  3     5.42  17.8     0     0     3     4</span></span>
<span id="cb363-10"><a href="chapter-dplyr.html#cb363-10" tabindex="-1"></a><span class="do">## 3  13.3     8   350   245  3.73  3.84  15.4     0     0     3     4</span></span>
<span id="cb363-11"><a href="chapter-dplyr.html#cb363-11" tabindex="-1"></a><span class="do">## 4  14.3     8   360   245  3.21  3.57  15.8     0     0     3     4</span></span>
<span id="cb363-12"><a href="chapter-dplyr.html#cb363-12" tabindex="-1"></a><span class="do">## 5  14.7     8   440   230  3.23  5.34  17.4     0     0     3     4</span></span>
<span id="cb363-13"><a href="chapter-dplyr.html#cb363-13" tabindex="-1"></a><span class="do">## # ℹ 27 more rows</span></span></code></pre></div>
<p>데이터 프레임 <code>mtcars_t</code>를 변수 <code>mpg</code>의 값이 가장 좋지 않은 자동차부터 시작해서 더 좋아지는 순서로 다시 배열을 하되, <code>mpg</code> 값이 같은 자동차의 경우에는 변수 <code>wt</code>의 값이 높은 자동차부터 배열해 보자. 변수 <code>wt</code>를 두 번째 정렬 기준 변수로 입력하되, 내림차순 정렬이 필요하므로 함수 <code>desc()</code>를 이용한다.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="chapter-dplyr.html#cb364-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb364-2"><a href="chapter-dplyr.html#cb364-2" tabindex="-1"></a>  <span class="fu">arrange</span>(mpg, <span class="fu">desc</span>(wt)) <span class="sc">|&gt;</span>  </span>
<span id="cb364-3"><a href="chapter-dplyr.html#cb364-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb364-4"><a href="chapter-dplyr.html#cb364-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 11</span></span>
<span id="cb364-5"><a href="chapter-dplyr.html#cb364-5" tabindex="-1"></a><span class="do">##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb364-6"><a href="chapter-dplyr.html#cb364-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb364-7"><a href="chapter-dplyr.html#cb364-7" tabindex="-1"></a><span class="do">## 1  10.4     8   460   215  3     5.42  17.8     0     0     3     4</span></span>
<span id="cb364-8"><a href="chapter-dplyr.html#cb364-8" tabindex="-1"></a><span class="do">## 2  10.4     8   472   205  2.93  5.25  18.0     0     0     3     4</span></span>
<span id="cb364-9"><a href="chapter-dplyr.html#cb364-9" tabindex="-1"></a><span class="do">## 3  13.3     8   350   245  3.73  3.84  15.4     0     0     3     4</span></span>
<span id="cb364-10"><a href="chapter-dplyr.html#cb364-10" tabindex="-1"></a><span class="do">## 4  14.3     8   360   245  3.21  3.57  15.8     0     0     3     4</span></span>
<span id="cb364-11"><a href="chapter-dplyr.html#cb364-11" tabindex="-1"></a><span class="do">## 5  14.7     8   440   230  3.23  5.34  17.4     0     0     3     4</span></span>
<span id="cb364-12"><a href="chapter-dplyr.html#cb364-12" tabindex="-1"></a><span class="do">## # ℹ 27 more rows</span></span></code></pre></div>
<ul>
<li>예제: <code>airquality</code></li>
</ul>
<p>데이터 프레임 <code>airquality</code>를 tibble로 전환하고, 5월 1일부터 5월 10일까지의 자료만을 대상으로 변수 <code>Ozone</code>의 값이 가장 낮았던 날부터 다시 배열해 보자.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="chapter-dplyr.html#cb365-1" tabindex="-1"></a>airs_1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(airquality) <span class="sc">|&gt;</span>   </span>
<span id="cb365-2"><a href="chapter-dplyr.html#cb365-2" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">==</span> <span class="dv">5</span>, Day <span class="sc">&lt;=</span> <span class="dv">10</span>) </span></code></pre></div>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="chapter-dplyr.html#cb366-1" tabindex="-1"></a>airs_1 <span class="sc">|&gt;</span> </span>
<span id="cb366-2"><a href="chapter-dplyr.html#cb366-2" tabindex="-1"></a>  <span class="fu">arrange</span>(Ozone)</span>
<span id="cb366-3"><a href="chapter-dplyr.html#cb366-3" tabindex="-1"></a><span class="do">## # A tibble: 10 × 6</span></span>
<span id="cb366-4"><a href="chapter-dplyr.html#cb366-4" tabindex="-1"></a><span class="do">##    Ozone Solar.R  Wind  Temp Month   Day</span></span>
<span id="cb366-5"><a href="chapter-dplyr.html#cb366-5" tabindex="-1"></a><span class="do">##    &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb366-6"><a href="chapter-dplyr.html#cb366-6" tabindex="-1"></a><span class="do">##  1     8      19  20.1    61     5     9</span></span>
<span id="cb366-7"><a href="chapter-dplyr.html#cb366-7" tabindex="-1"></a><span class="do">##  2    12     149  12.6    74     5     3</span></span>
<span id="cb366-8"><a href="chapter-dplyr.html#cb366-8" tabindex="-1"></a><span class="do">##  3    18     313  11.5    62     5     4</span></span>
<span id="cb366-9"><a href="chapter-dplyr.html#cb366-9" tabindex="-1"></a><span class="do">##  4    19      99  13.8    59     5     8</span></span>
<span id="cb366-10"><a href="chapter-dplyr.html#cb366-10" tabindex="-1"></a><span class="do">##  5    23     299   8.6    65     5     7</span></span>
<span id="cb366-11"><a href="chapter-dplyr.html#cb366-11" tabindex="-1"></a><span class="do">##  6    28      NA  14.9    66     5     6</span></span>
<span id="cb366-12"><a href="chapter-dplyr.html#cb366-12" tabindex="-1"></a><span class="do">##  7    36     118   8      72     5     2</span></span>
<span id="cb366-13"><a href="chapter-dplyr.html#cb366-13" tabindex="-1"></a><span class="do">##  8    41     190   7.4    67     5     1</span></span>
<span id="cb366-14"><a href="chapter-dplyr.html#cb366-14" tabindex="-1"></a><span class="do">##  9    NA      NA  14.3    56     5     5</span></span>
<span id="cb366-15"><a href="chapter-dplyr.html#cb366-15" tabindex="-1"></a><span class="do">## 10    NA     194   8.6    69     5    10</span></span></code></pre></div>
<p>위의 정렬 결과를 보면 변수 <code>Ozone</code>이 결측값인 행이 가장 뒤로 배열되어 있다. 이것이 문제는 아니지만, 어떤 경우에는 결측값인 행을 가장 앞으로 배열하는 것이 필요할 때도 있다. 데이터 프레임 <code>airs_1</code>을 변수 <code>Ozone</code>이 결측값인 행부터 다시 배열해 보자. 이것은 배열 기준으로 논리형 벡터를 사용해야 되는 문제인데, <code>TRUE</code>와 <code>FALSE</code>의 배열에서 <code>FALSE</code>가 우선 순위에 있기 때문에 <code>!is.na(Ozone)</code>을 배열 기준으로 사용하면 된다.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="chapter-dplyr.html#cb367-1" tabindex="-1"></a>airs_1 <span class="sc">|&gt;</span>  </span>
<span id="cb367-2"><a href="chapter-dplyr.html#cb367-2" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">!</span><span class="fu">is.na</span>(Ozone))</span>
<span id="cb367-3"><a href="chapter-dplyr.html#cb367-3" tabindex="-1"></a><span class="do">## # A tibble: 10 × 6</span></span>
<span id="cb367-4"><a href="chapter-dplyr.html#cb367-4" tabindex="-1"></a><span class="do">##    Ozone Solar.R  Wind  Temp Month   Day</span></span>
<span id="cb367-5"><a href="chapter-dplyr.html#cb367-5" tabindex="-1"></a><span class="do">##    &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb367-6"><a href="chapter-dplyr.html#cb367-6" tabindex="-1"></a><span class="do">##  1    NA      NA  14.3    56     5     5</span></span>
<span id="cb367-7"><a href="chapter-dplyr.html#cb367-7" tabindex="-1"></a><span class="do">##  2    NA     194   8.6    69     5    10</span></span>
<span id="cb367-8"><a href="chapter-dplyr.html#cb367-8" tabindex="-1"></a><span class="do">##  3    41     190   7.4    67     5     1</span></span>
<span id="cb367-9"><a href="chapter-dplyr.html#cb367-9" tabindex="-1"></a><span class="do">##  4    36     118   8      72     5     2</span></span>
<span id="cb367-10"><a href="chapter-dplyr.html#cb367-10" tabindex="-1"></a><span class="do">##  5    12     149  12.6    74     5     3</span></span>
<span id="cb367-11"><a href="chapter-dplyr.html#cb367-11" tabindex="-1"></a><span class="do">##  6    18     313  11.5    62     5     4</span></span>
<span id="cb367-12"><a href="chapter-dplyr.html#cb367-12" tabindex="-1"></a><span class="do">##  7    28      NA  14.9    66     5     6</span></span>
<span id="cb367-13"><a href="chapter-dplyr.html#cb367-13" tabindex="-1"></a><span class="do">##  8    23     299   8.6    65     5     7</span></span>
<span id="cb367-14"><a href="chapter-dplyr.html#cb367-14" tabindex="-1"></a><span class="do">##  9    19      99  13.8    59     5     8</span></span>
<span id="cb367-15"><a href="chapter-dplyr.html#cb367-15" tabindex="-1"></a><span class="do">## 10     8      19  20.1    61     5     9</span></span></code></pre></div>
<p>이번에는 데이터 프레임 <code>airs_1</code>을 변수 <code>Ozone</code>의 값이 가장 높은 날부터 다시 배열하되 결측값이 있는 행을 가장 앞으로 배열해 보자. 이때는 <code>!is.na(Ozone)</code>을 첫 번째 배열 기준으로 하여 결측값이 있는 행을 가장 앞으로 배치하고, <code>desc(Ozone)</code>을 두 번째 배열 기준으로 입력해서 결측값이 아닌 행들을 변수 <code>Ozone</code>의 내림차순으로 다시 배열해야 된다.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="chapter-dplyr.html#cb368-1" tabindex="-1"></a>airs_1 <span class="sc">|&gt;</span>  </span>
<span id="cb368-2"><a href="chapter-dplyr.html#cb368-2" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">!</span><span class="fu">is.na</span>(Ozone), <span class="fu">desc</span>(Ozone))</span>
<span id="cb368-3"><a href="chapter-dplyr.html#cb368-3" tabindex="-1"></a><span class="do">## # A tibble: 10 × 6</span></span>
<span id="cb368-4"><a href="chapter-dplyr.html#cb368-4" tabindex="-1"></a><span class="do">##    Ozone Solar.R  Wind  Temp Month   Day</span></span>
<span id="cb368-5"><a href="chapter-dplyr.html#cb368-5" tabindex="-1"></a><span class="do">##    &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb368-6"><a href="chapter-dplyr.html#cb368-6" tabindex="-1"></a><span class="do">##  1    NA      NA  14.3    56     5     5</span></span>
<span id="cb368-7"><a href="chapter-dplyr.html#cb368-7" tabindex="-1"></a><span class="do">##  2    NA     194   8.6    69     5    10</span></span>
<span id="cb368-8"><a href="chapter-dplyr.html#cb368-8" tabindex="-1"></a><span class="do">##  3    41     190   7.4    67     5     1</span></span>
<span id="cb368-9"><a href="chapter-dplyr.html#cb368-9" tabindex="-1"></a><span class="do">##  4    36     118   8      72     5     2</span></span>
<span id="cb368-10"><a href="chapter-dplyr.html#cb368-10" tabindex="-1"></a><span class="do">##  5    28      NA  14.9    66     5     6</span></span>
<span id="cb368-11"><a href="chapter-dplyr.html#cb368-11" tabindex="-1"></a><span class="do">##  6    23     299   8.6    65     5     7</span></span>
<span id="cb368-12"><a href="chapter-dplyr.html#cb368-12" tabindex="-1"></a><span class="do">##  7    19      99  13.8    59     5     8</span></span>
<span id="cb368-13"><a href="chapter-dplyr.html#cb368-13" tabindex="-1"></a><span class="do">##  8    18     313  11.5    62     5     4</span></span>
<span id="cb368-14"><a href="chapter-dplyr.html#cb368-14" tabindex="-1"></a><span class="do">##  9    12     149  12.6    74     5     3</span></span>
<span id="cb368-15"><a href="chapter-dplyr.html#cb368-15" tabindex="-1"></a><span class="do">## 10     8      19  20.1    61     5     9</span></span></code></pre></div>
</div>
<div id="중복된-행의-제거-distinct" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> 중복된 행의 제거: <code>distinct()</code><a href="chapter-dplyr.html#중복된-행의-제거-distinct" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>함수 <code>distinct()</code>는 중복 입력된 행을 제거해서, 서로 다른 값을 갖고 있는 행만 선택할 때 사용되는 함수이다.
따라서 함수에는 중복 여부를 결정할 변수를 입력해야 되는데, 입력한 변수가 없다면 모든 변수들을 대상으로 중복 여부를 결정한다.
함수 <code>distinct()</code>로 생성되는 데이터 프레임은 중복 여부를 확인하기 위해서 입력한 변수만 유지되는데, 옵션 <code>.keep_all=TRUE</code>가 지정되면 다른 모든 변수도 유지된다.
다만, 이 경우에는 중복된 행 중 첫 번째 행이 선택된다.</p>
<p>단순한 형태의 데이터 프레임으로 함수 <code>distinct()</code>의 작동 방식을 살펴보자.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="chapter-dplyr.html#cb369-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">times =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>), </span>
<span id="cb369-2"><a href="chapter-dplyr.html#cb369-2" tabindex="-1"></a>              <span class="at">x1 =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb369-3"><a href="chapter-dplyr.html#cb369-3" tabindex="-1"></a>df1</span>
<span id="cb369-4"><a href="chapter-dplyr.html#cb369-4" tabindex="-1"></a><span class="do">## # A tibble: 9 × 2</span></span>
<span id="cb369-5"><a href="chapter-dplyr.html#cb369-5" tabindex="-1"></a><span class="do">##      id    x1</span></span>
<span id="cb369-6"><a href="chapter-dplyr.html#cb369-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb369-7"><a href="chapter-dplyr.html#cb369-7" tabindex="-1"></a><span class="do">## 1     1     1</span></span>
<span id="cb369-8"><a href="chapter-dplyr.html#cb369-8" tabindex="-1"></a><span class="do">## 2     1     2</span></span>
<span id="cb369-9"><a href="chapter-dplyr.html#cb369-9" tabindex="-1"></a><span class="do">## 3     2     1</span></span>
<span id="cb369-10"><a href="chapter-dplyr.html#cb369-10" tabindex="-1"></a><span class="do">## 4     2     2</span></span>
<span id="cb369-11"><a href="chapter-dplyr.html#cb369-11" tabindex="-1"></a><span class="do">## 5     2     3</span></span>
<span id="cb369-12"><a href="chapter-dplyr.html#cb369-12" tabindex="-1"></a><span class="do">## 6     3     1</span></span>
<span id="cb369-13"><a href="chapter-dplyr.html#cb369-13" tabindex="-1"></a><span class="do">## 7     3     2</span></span>
<span id="cb369-14"><a href="chapter-dplyr.html#cb369-14" tabindex="-1"></a><span class="do">## 8     3     3</span></span>
<span id="cb369-15"><a href="chapter-dplyr.html#cb369-15" tabindex="-1"></a><span class="do">## 9     3     4</span></span></code></pre></div>
<p>변수 <code>id</code>가 중복되지 않은 행들을 선택해 보자.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="chapter-dplyr.html#cb370-1" tabindex="-1"></a>df1 <span class="sc">|&gt;</span> </span>
<span id="cb370-2"><a href="chapter-dplyr.html#cb370-2" tabindex="-1"></a>  <span class="fu">distinct</span>(id)</span>
<span id="cb370-3"><a href="chapter-dplyr.html#cb370-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 1</span></span>
<span id="cb370-4"><a href="chapter-dplyr.html#cb370-4" tabindex="-1"></a><span class="do">##      id</span></span>
<span id="cb370-5"><a href="chapter-dplyr.html#cb370-5" tabindex="-1"></a><span class="do">##   &lt;int&gt;</span></span>
<span id="cb370-6"><a href="chapter-dplyr.html#cb370-6" tabindex="-1"></a><span class="do">## 1     1</span></span>
<span id="cb370-7"><a href="chapter-dplyr.html#cb370-7" tabindex="-1"></a><span class="do">## 2     2</span></span>
<span id="cb370-8"><a href="chapter-dplyr.html#cb370-8" tabindex="-1"></a><span class="do">## 3     3</span></span></code></pre></div>
<p>변수 <code>id</code>만 있는 데이터 프레임이 생성되는 것을 알 수 있다.
옵션 <code>.keep_all = TRUE</code>를 추가하면, 변수 <code>x1</code>도 유지되는데,
중복된 행 중에 처음 나타난 행이 선택됨을 알 수 있다.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="chapter-dplyr.html#cb371-1" tabindex="-1"></a>df1 <span class="sc">|&gt;</span>  </span>
<span id="cb371-2"><a href="chapter-dplyr.html#cb371-2" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb371-3"><a href="chapter-dplyr.html#cb371-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb371-4"><a href="chapter-dplyr.html#cb371-4" tabindex="-1"></a><span class="do">##      id    x1</span></span>
<span id="cb371-5"><a href="chapter-dplyr.html#cb371-5" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb371-6"><a href="chapter-dplyr.html#cb371-6" tabindex="-1"></a><span class="do">## 1     1     1</span></span>
<span id="cb371-7"><a href="chapter-dplyr.html#cb371-7" tabindex="-1"></a><span class="do">## 2     2     1</span></span>
<span id="cb371-8"><a href="chapter-dplyr.html#cb371-8" tabindex="-1"></a><span class="do">## 3     3     1</span></span></code></pre></div>
<p>변수 <code>id</code>가 중복된 행 중에 첫 번째 위치한 행이 아닌, 변수 <code>x1</code>이 가장 큰 값을 갖는 행을 선택해 보자. 이 문제는 변수 <code>id</code>가 중복된 행들을 변수 <code>x1</code>의 내림차순으로 정렬한 데이터 프레임을 대상으로 중복된 행을 제거하면 된다.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="chapter-dplyr.html#cb372-1" tabindex="-1"></a>df1 <span class="sc">|&gt;</span>  </span>
<span id="cb372-2"><a href="chapter-dplyr.html#cb372-2" tabindex="-1"></a>  <span class="fu">arrange</span>(id, <span class="fu">desc</span>(x1)) <span class="sc">|&gt;</span>  </span>
<span id="cb372-3"><a href="chapter-dplyr.html#cb372-3" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb372-4"><a href="chapter-dplyr.html#cb372-4" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb372-5"><a href="chapter-dplyr.html#cb372-5" tabindex="-1"></a><span class="do">##      id    x1</span></span>
<span id="cb372-6"><a href="chapter-dplyr.html#cb372-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb372-7"><a href="chapter-dplyr.html#cb372-7" tabindex="-1"></a><span class="do">## 1     1     2</span></span>
<span id="cb372-8"><a href="chapter-dplyr.html#cb372-8" tabindex="-1"></a><span class="do">## 2     2     3</span></span>
<span id="cb372-9"><a href="chapter-dplyr.html#cb372-9" tabindex="-1"></a><span class="do">## 3     3     4</span></span></code></pre></div>
<p>함수 <code>distinct()</code>로 모든 변수의 값이 중복된 행을 제거하는 예제를 살펴보자.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="chapter-dplyr.html#cb373-1" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">2</span>), </span>
<span id="cb373-2"><a href="chapter-dplyr.html#cb373-2" tabindex="-1"></a>              <span class="at">x1 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb373-3"><a href="chapter-dplyr.html#cb373-3" tabindex="-1"></a>df2</span>
<span id="cb373-4"><a href="chapter-dplyr.html#cb373-4" tabindex="-1"></a><span class="do">## # A tibble: 6 × 2</span></span>
<span id="cb373-5"><a href="chapter-dplyr.html#cb373-5" tabindex="-1"></a><span class="do">##      id    x1</span></span>
<span id="cb373-6"><a href="chapter-dplyr.html#cb373-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;dbl&gt;</span></span>
<span id="cb373-7"><a href="chapter-dplyr.html#cb373-7" tabindex="-1"></a><span class="do">## 1     1     2</span></span>
<span id="cb373-8"><a href="chapter-dplyr.html#cb373-8" tabindex="-1"></a><span class="do">## 2     1     2</span></span>
<span id="cb373-9"><a href="chapter-dplyr.html#cb373-9" tabindex="-1"></a><span class="do">## 3     2     3</span></span>
<span id="cb373-10"><a href="chapter-dplyr.html#cb373-10" tabindex="-1"></a><span class="do">## 4     2     1</span></span>
<span id="cb373-11"><a href="chapter-dplyr.html#cb373-11" tabindex="-1"></a><span class="do">## 5     3     4</span></span>
<span id="cb373-12"><a href="chapter-dplyr.html#cb373-12" tabindex="-1"></a><span class="do">## 6     3     4</span></span></code></pre></div>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="chapter-dplyr.html#cb374-1" tabindex="-1"></a>df2 <span class="sc">|&gt;</span>  </span>
<span id="cb374-2"><a href="chapter-dplyr.html#cb374-2" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb374-3"><a href="chapter-dplyr.html#cb374-3" tabindex="-1"></a><span class="do">## # A tibble: 4 × 2</span></span>
<span id="cb374-4"><a href="chapter-dplyr.html#cb374-4" tabindex="-1"></a><span class="do">##      id    x1</span></span>
<span id="cb374-5"><a href="chapter-dplyr.html#cb374-5" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;dbl&gt;</span></span>
<span id="cb374-6"><a href="chapter-dplyr.html#cb374-6" tabindex="-1"></a><span class="do">## 1     1     2</span></span>
<span id="cb374-7"><a href="chapter-dplyr.html#cb374-7" tabindex="-1"></a><span class="do">## 2     2     3</span></span>
<span id="cb374-8"><a href="chapter-dplyr.html#cb374-8" tabindex="-1"></a><span class="do">## 3     2     1</span></span>
<span id="cb374-9"><a href="chapter-dplyr.html#cb374-9" tabindex="-1"></a><span class="do">## 4     3     4</span></span></code></pre></div>
</div>
</div>
<div id="열을-작업-대상으로-하는-함수" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> 열을 작업 대상으로 하는 함수<a href="chapter-dplyr.html#열을-작업-대상으로-하는-함수" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="열의-선택-select" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> 열의 선택: <code>select()</code><a href="chapter-dplyr.html#열의-선택-select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>데이터 세트의 크기가 커짐에 따라 변수의 개수가 수백 또는 수천이 되는 경우를 접하는 것이 더 이상 드문 상황은 아니다. 이러한 경우, 분석에 필요한 변수를 선택하여 데이터 세트의 크기를 줄이는 것은 매우 중요한 작업이 된다. 함수 <code>select()</code>에서는 패키지 <code>tidyselect</code>에 의해 구현되는 효과적인 변수 선택 방법을 이용할 수 있다. 여기에서 작동되는 <code>&lt;tidy-select&gt;</code> 방식은 기본적으로 변수들의 집합을 구성하는 것으로 생각하면 된다. 구체적인 선택 방법은 열 번호 또는 열 이름에 의한 방법과 변수의 유형에 의한 방법, 그리고 변 수 선택과 관련된 몇몇 함수들을 이용하는 방법으로 구분할 수 있다.</p>
<ol style="list-style-type: decimal">
<li>열 번호(또는 열 이름)에 의한 선택</li>
</ol>
<p>가장 기본적인 방법은 열 번호를 콤마로 구분하여 나열하는 것이다.
연속된 열 변호는 콜론(:) 연산자를 이용해서 나타낼 수 있다.</p>
<p>데이터 프레임 <code>mtcars</code>의 행 이름을 변수 <code>row.name</code>으로 추가하고 tibble로 전환해 보자.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="chapter-dplyr.html#cb375-1" tabindex="-1"></a>mtcars_t <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span>  </span>
<span id="cb375-2"><a href="chapter-dplyr.html#cb375-2" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;row.name&quot;</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb375-3"><a href="chapter-dplyr.html#cb375-3" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span>  </span>
<span id="cb375-4"><a href="chapter-dplyr.html#cb375-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb375-5"><a href="chapter-dplyr.html#cb375-5" tabindex="-1"></a><span class="do">## # A tibble: 32 × 12</span></span>
<span id="cb375-6"><a href="chapter-dplyr.html#cb375-6" tabindex="-1"></a><span class="do">##   row.name       mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb375-7"><a href="chapter-dplyr.html#cb375-7" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb375-8"><a href="chapter-dplyr.html#cb375-8" tabindex="-1"></a><span class="do">## 1 Mazda RX4     21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb375-9"><a href="chapter-dplyr.html#cb375-9" tabindex="-1"></a><span class="do">## 2 Mazda RX4 W…  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb375-10"><a href="chapter-dplyr.html#cb375-10" tabindex="-1"></a><span class="do">## 3 Datsun 710    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb375-11"><a href="chapter-dplyr.html#cb375-11" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>첫 번째에서 세 번째 변수, 그리고 일곱 번째 변수를 선택해 보자.
이 경우에는 열 번호를 함수 <code>c()</code> 없이 그냥 나열해도 결과는 동일하다.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="chapter-dplyr.html#cb376-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb376-2"><a href="chapter-dplyr.html#cb376-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb376-3"><a href="chapter-dplyr.html#cb376-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb376-4"><a href="chapter-dplyr.html#cb376-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 4</span></span>
<span id="cb376-5"><a href="chapter-dplyr.html#cb376-5" tabindex="-1"></a><span class="do">##   row.name        mpg   cyl    wt</span></span>
<span id="cb376-6"><a href="chapter-dplyr.html#cb376-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb376-7"><a href="chapter-dplyr.html#cb376-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4      21       6  2.62</span></span>
<span id="cb376-8"><a href="chapter-dplyr.html#cb376-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 Wag  21       6  2.88</span></span>
<span id="cb376-9"><a href="chapter-dplyr.html#cb376-9" tabindex="-1"></a><span class="do">## 3 Datsun 710     22.8     4  2.32</span></span>
<span id="cb376-10"><a href="chapter-dplyr.html#cb376-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>열(변수) 이름은 열 번호와 같은 취급을 받는다. 따라서 다음 방법도 같은 결과를 생성한다.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="chapter-dplyr.html#cb377-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb377-2"><a href="chapter-dplyr.html#cb377-2" tabindex="-1"></a>  <span class="fu">select</span>(row.name<span class="sc">:</span>cyl, wt) <span class="sc">|&gt;</span> </span>
<span id="cb377-3"><a href="chapter-dplyr.html#cb377-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb377-4"><a href="chapter-dplyr.html#cb377-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 4</span></span>
<span id="cb377-5"><a href="chapter-dplyr.html#cb377-5" tabindex="-1"></a><span class="do">##   row.name        mpg   cyl    wt</span></span>
<span id="cb377-6"><a href="chapter-dplyr.html#cb377-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb377-7"><a href="chapter-dplyr.html#cb377-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4      21       6  2.62</span></span>
<span id="cb377-8"><a href="chapter-dplyr.html#cb377-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 Wag  21       6  2.88</span></span>
<span id="cb377-9"><a href="chapter-dplyr.html#cb377-9" tabindex="-1"></a><span class="do">## 3 Datsun 710     22.8     4  2.32</span></span>
<span id="cb377-10"><a href="chapter-dplyr.html#cb377-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>열을 제거하고자 하는 경우에는 논리 부정 연산자(<code>!</code>) 또는 마이너스(<code>-</code>) 연산자를 사용해야 한다.
함수 <code>c()</code> 안에 제거하고자 하는 열 번호를 나열하고 논리 부정 연산자를 그 앞에 붙이면 나열된 열로 이루어진 집합의 여집합이 구성되어, 해당되는 열들이 제거되는 것이다. 첫 번째에서 세 번째 변수, 그리고 일곱 번째 변수를 제거해 보자.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="chapter-dplyr.html#cb378-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb378-2"><a href="chapter-dplyr.html#cb378-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb378-3"><a href="chapter-dplyr.html#cb378-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb378-4"><a href="chapter-dplyr.html#cb378-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 8</span></span>
<span id="cb378-5"><a href="chapter-dplyr.html#cb378-5" tabindex="-1"></a><span class="do">##    disp    hp  drat  qsec    vs    am  gear  carb</span></span>
<span id="cb378-6"><a href="chapter-dplyr.html#cb378-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb378-7"><a href="chapter-dplyr.html#cb378-7" tabindex="-1"></a><span class="do">## 1   160   110  3.9   16.5     0     1     4     4</span></span>
<span id="cb378-8"><a href="chapter-dplyr.html#cb378-8" tabindex="-1"></a><span class="do">## 2   160   110  3.9   17.0     0     1     4     4</span></span>
<span id="cb378-9"><a href="chapter-dplyr.html#cb378-9" tabindex="-1"></a><span class="do">## 3   108    93  3.85  18.6     1     1     4     1</span></span>
<span id="cb378-10"><a href="chapter-dplyr.html#cb378-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>마이너스 연산자는 차집합을 구성하게 된다. 예컨대 <code>select(1:4, -1)</code>은 처음 네 변수 중 첫 번째 변수를 제거하라는 의미가 된다. 그러나 만일 <code>select(1:4, !1)</code>과 같이 논리 부정 연산자를 사용하면 처음 네 변수와 첫 번째 변수를 제외한 나머지 변수와의 합집합을 구성하는 것이 되어서 결국 모든 변수를 다 선택하게 된다.</p>
<p>비록 두 연산자의 의미는 다르지만, 마이너스 연산자가 첫 번째로 입력되면 같은 효과를 볼 수 있다. 따라서 첫 번째에서 세 번째 변수, 그리고 일곱 번째 변수의 제거는 다음과 같이 할 수도 있다.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="chapter-dplyr.html#cb379-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb379-2"><a href="chapter-dplyr.html#cb379-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb379-3"><a href="chapter-dplyr.html#cb379-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb379-4"><a href="chapter-dplyr.html#cb379-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 8</span></span>
<span id="cb379-5"><a href="chapter-dplyr.html#cb379-5" tabindex="-1"></a><span class="do">##    disp    hp  drat  qsec    vs    am  gear  carb</span></span>
<span id="cb379-6"><a href="chapter-dplyr.html#cb379-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb379-7"><a href="chapter-dplyr.html#cb379-7" tabindex="-1"></a><span class="do">## 1   160   110  3.9   16.5     0     1     4     4</span></span>
<span id="cb379-8"><a href="chapter-dplyr.html#cb379-8" tabindex="-1"></a><span class="do">## 2   160   110  3.9   17.0     0     1     4     4</span></span>
<span id="cb379-9"><a href="chapter-dplyr.html#cb379-9" tabindex="-1"></a><span class="do">## 3   108    93  3.85  18.6     1     1     4     1</span></span>
<span id="cb379-10"><a href="chapter-dplyr.html#cb379-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>변수 유형에 의한 선택</li>
</ol>
<p>변수의 유형과 같은 특정 조건을 만족하는 변수 선택에 유용하게 사용되는 방법이다.
사용 방법은 함수 <code>where()</code>에 실행 결과가 <code>TRUE</code> 또는 <code>FALSE</code> 중 하나가 되는 일명 predicate 함수를 입력해서 그 결과가 <code>TRUE</code>가 되는 변수를 선택하는 것이다.</p>
<p>함수 <code>where()</code>에 입력되는 함수 형태는 두 가지로 구분된다.
첫 번째는 함수의 이름만 입력하는 형태인데, 이것은 하나의 함수를 디폴트 상태로 사용하는 경우이다.
예를 들어, 변수의 유형 파악은 함수 <code>is.numeric()</code> 또는 <code>is.character()</code> 등 <code>is.*()</code> 형태의 함수로 할 수 있는데, 숫자형 변수를 선택한다면 <code>where(is.numeric)</code>, 문자형 변수를 선택한다면 <code>where(is.character)</code>와 같이 입력하는 것이다.</p>
<p>두 번째는 패키지 <code>purrr</code> 방식의 형태로써, 여러 함수를 결합하거나, 함수의 디폴트 값을 변경해서 사용하는 경우에 적용되는 방식이다.
기본적인 형태는 물결표(<code>~</code>)로 시작을 하며 <code>.x</code>를 개별 변수 대신 사용하면 된다.
예를 들어 평균값이 5 이하인 변수를 선택한다면, <code>where(~ mean(.x) &lt;= 5)</code>와 같이 입력하면 된다.
패키지 <code>purrr</code>은 core tidyverse에 속한 패키지로서 효율적인 프로그래밍 기법을 제공하고 있다.
자세한 소개는 <a href="chapter-programming.html#chapter-programming">7</a>장에서 찾아볼 수 있다.</p>
<p>패키지 <code>ggplot2</code>의 데이터 프레임 <code>mpg</code>를 살펴보자.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="chapter-dplyr.html#cb380-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb380-2"><a href="chapter-dplyr.html#cb380-2" tabindex="-1"></a><span class="do">## # A tibble: 234 × 11</span></span>
<span id="cb380-3"><a href="chapter-dplyr.html#cb380-3" tabindex="-1"></a><span class="do">##   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class </span></span>
<span id="cb380-4"><a href="chapter-dplyr.html#cb380-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; </span></span>
<span id="cb380-5"><a href="chapter-dplyr.html#cb380-5" tabindex="-1"></a><span class="do">## 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…</span></span>
<span id="cb380-6"><a href="chapter-dplyr.html#cb380-6" tabindex="-1"></a><span class="do">## 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…</span></span>
<span id="cb380-7"><a href="chapter-dplyr.html#cb380-7" tabindex="-1"></a><span class="do">## 3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…</span></span>
<span id="cb380-8"><a href="chapter-dplyr.html#cb380-8" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<p>데이터 프레임 <code>mpg</code>에서 숫자형 변수만 선택해 보자.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="chapter-dplyr.html#cb381-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb381-2"><a href="chapter-dplyr.html#cb381-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span>  </span>
<span id="cb381-3"><a href="chapter-dplyr.html#cb381-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb381-4"><a href="chapter-dplyr.html#cb381-4" tabindex="-1"></a><span class="do">## # A tibble: 234 × 5</span></span>
<span id="cb381-5"><a href="chapter-dplyr.html#cb381-5" tabindex="-1"></a><span class="do">##   displ  year   cyl   cty   hwy</span></span>
<span id="cb381-6"><a href="chapter-dplyr.html#cb381-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb381-7"><a href="chapter-dplyr.html#cb381-7" tabindex="-1"></a><span class="do">## 1   1.8  1999     4    18    29</span></span>
<span id="cb381-8"><a href="chapter-dplyr.html#cb381-8" tabindex="-1"></a><span class="do">## 2   1.8  1999     4    21    29</span></span>
<span id="cb381-9"><a href="chapter-dplyr.html#cb381-9" tabindex="-1"></a><span class="do">## 3   2    2008     4    20    31</span></span>
<span id="cb381-10"><a href="chapter-dplyr.html#cb381-10" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<p>몇 가지 변수 유형을 함께 고려해야 하는 경우에는 논리 연산자 <code>&amp;</code>와 <code>|</code>을 사용하게 된다.
예를 들어 숫자형 변수이거나 문자형 변수의 선택은 다음과 같다.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="chapter-dplyr.html#cb382-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> </span>
<span id="cb382-2"><a href="chapter-dplyr.html#cb382-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">|</span> <span class="fu">where</span>(is.character)) <span class="sc">|&gt;</span> </span>
<span id="cb382-3"><a href="chapter-dplyr.html#cb382-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb382-4"><a href="chapter-dplyr.html#cb382-4" tabindex="-1"></a><span class="do">## # A tibble: 234 × 11</span></span>
<span id="cb382-5"><a href="chapter-dplyr.html#cb382-5" tabindex="-1"></a><span class="do">##   displ  year   cyl   cty   hwy manufacturer model trans      drv   fl    class </span></span>
<span id="cb382-6"><a href="chapter-dplyr.html#cb382-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; </span></span>
<span id="cb382-7"><a href="chapter-dplyr.html#cb382-7" tabindex="-1"></a><span class="do">## 1   1.8  1999     4    18    29 audi         a4    auto(l5)   f     p     compa…</span></span>
<span id="cb382-8"><a href="chapter-dplyr.html#cb382-8" tabindex="-1"></a><span class="do">## 2   1.8  1999     4    21    29 audi         a4    manual(m5) f     p     compa…</span></span>
<span id="cb382-9"><a href="chapter-dplyr.html#cb382-9" tabindex="-1"></a><span class="do">## 3   2    2008     4    20    31 audi         a4    manual(m6) f     p     compa…</span></span>
<span id="cb382-10"><a href="chapter-dplyr.html#cb382-10" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<p>이번에는 숫자형 변수 중에 평균 값이 5 이하인 변수를 선택해 보자.
먼저 함수 <code>select()</code>를 연속해서 사용하는 방법이다.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="chapter-dplyr.html#cb383-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span></span>
<span id="cb383-2"><a href="chapter-dplyr.html#cb383-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span>  </span>
<span id="cb383-3"><a href="chapter-dplyr.html#cb383-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="fu">mean</span>(.x) <span class="sc">&lt;=</span> <span class="dv">5</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb383-4"><a href="chapter-dplyr.html#cb383-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb383-5"><a href="chapter-dplyr.html#cb383-5" tabindex="-1"></a><span class="do">## # A tibble: 234 × 1</span></span>
<span id="cb383-6"><a href="chapter-dplyr.html#cb383-6" tabindex="-1"></a><span class="do">##   displ</span></span>
<span id="cb383-7"><a href="chapter-dplyr.html#cb383-7" tabindex="-1"></a><span class="do">##   &lt;dbl&gt;</span></span>
<span id="cb383-8"><a href="chapter-dplyr.html#cb383-8" tabindex="-1"></a><span class="do">## 1   1.8</span></span>
<span id="cb383-9"><a href="chapter-dplyr.html#cb383-9" tabindex="-1"></a><span class="do">## 2   1.8</span></span>
<span id="cb383-10"><a href="chapter-dplyr.html#cb383-10" tabindex="-1"></a><span class="do">## 3   2  </span></span>
<span id="cb383-11"><a href="chapter-dplyr.html#cb383-11" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<p>조금 다른 방법은 <code>&amp;&amp;</code> 연산자를 사용하는 방법이다.
<code>&amp;&amp;</code> 연산자는 <code>&amp;</code>와 같이 AND 논리 연산자이지만, 수행 방식에는 차이가 있다.
<code>&amp;</code> 논리 연산자는 벡터의 구성 요소별 비교 연산을 수행하지만,
<code>&amp;&amp;</code> 논리 연산자는 비교 대상 요소의 길이가 1이 되어야 하며, 왼쪽부터 차례로 비교 연산을 수행한다.
비교 수행 중 <code>FALSE</code>가 나오면, 비교 연산을 중단하고 <code>FALSE</code>를 결과로 출력한다.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="chapter-dplyr.html#cb384-1" tabindex="-1"></a>(<span class="dv">1</span> <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;&amp;</span> (<span class="sc">-</span><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb384-2"><a href="chapter-dplyr.html#cb384-2" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb384-3"><a href="chapter-dplyr.html#cb384-3" tabindex="-1"></a>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;&amp;</span> (<span class="sc">-</span><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb384-4"><a href="chapter-dplyr.html#cb384-4" tabindex="-1"></a><span class="do">## [1] FALSE</span></span></code></pre></div>
<p>문자형 벡터 <code>x</code>를 대상으로 함수 <code>is.numeric()</code>과 <code>mean()</code>을 적용하는 경우에 <code>&amp;&amp;</code>을 사용하면 <code>is.numeric(x)</code>에서 <code>FALSE</code>가 나오기 때문에, <code>mean(x)</code>는 실행이 되지 않은 상태에서 <code>FALSE</code>가 출력된다.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="chapter-dplyr.html#cb385-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">&quot;a&quot;</span></span>
<span id="cb385-2"><a href="chapter-dplyr.html#cb385-2" tabindex="-1"></a><span class="fu">is.numeric</span>(x) <span class="sc">&amp;&amp;</span> (<span class="fu">mean</span>(x) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb385-3"><a href="chapter-dplyr.html#cb385-3" tabindex="-1"></a><span class="do">## [1] FALSE</span></span></code></pre></div>
<p>하지만 <code>&amp;</code>을 사용하게 되면, <code>is.numeric(x)</code>와 <code>mean(x)</code>가 모두 수행되는데, 문자형 벡터에 <code>mean()</code>을 적용했기 때문에 <code>NA</code>가 발생했다는 경고 문구가 출력된다.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="chapter-dplyr.html#cb386-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">&quot;a&quot;</span></span>
<span id="cb386-2"><a href="chapter-dplyr.html#cb386-2" tabindex="-1"></a><span class="fu">is.numeric</span>(x) <span class="sc">&amp;</span> (<span class="fu">mean</span>(x) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb386-3"><a href="chapter-dplyr.html#cb386-3" tabindex="-1"></a><span class="do">## [1] FALSE</span></span></code></pre></div>
<p>경고 문구가 나왔음에도 불구하고, 위 연산 결과가 <code>&amp;&amp;</code>를 사용한 것과 동일하게 <code>FALSE</code>가 나온 이유는 비교 연산에서 <code>NA</code>가 갖고 있는 의미 때문이다.
즉, 비교 연산에서 <code>NA</code>는 정해진 것이 없는 상태를 의미하고 있고, 따라서 다음과 같은 결과를 볼 수 있다.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="chapter-dplyr.html#cb387-1" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">&amp;</span> <span class="cn">NA</span>   <span class="co"># NA에 관계 없이 FALSE</span></span>
<span id="cb387-2"><a href="chapter-dplyr.html#cb387-2" tabindex="-1"></a><span class="do">## [1] FALSE</span></span>
<span id="cb387-3"><a href="chapter-dplyr.html#cb387-3" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">|</span> <span class="cn">NA</span>   <span class="co"># NA에 따라 다른 결과 가능하므로, 결과는 미정</span></span>
<span id="cb387-4"><a href="chapter-dplyr.html#cb387-4" tabindex="-1"></a><span class="do">## [1] NA</span></span>
<span id="cb387-5"><a href="chapter-dplyr.html#cb387-5" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">|</span> <span class="cn">NA</span>    <span class="co"># NA에 관계 없이 TRUE</span></span>
<span id="cb387-6"><a href="chapter-dplyr.html#cb387-6" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb387-7"><a href="chapter-dplyr.html#cb387-7" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="cn">NA</span>    <span class="co"># NA에 따라 다른 결과 가능하므로, 결과는 미정</span></span>
<span id="cb387-8"><a href="chapter-dplyr.html#cb387-8" tabindex="-1"></a><span class="do">## [1] NA</span></span></code></pre></div>
<p>이제 <code>&amp;&amp;</code>를 사용해서 숫자형 변수 중에 평균 값이 5 이하인 변수를 선택해 보자.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="chapter-dplyr.html#cb388-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb388-2"><a href="chapter-dplyr.html#cb388-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>( <span class="sc">~</span> <span class="fu">is.numeric</span>(.x) <span class="sc">&amp;&amp;</span> <span class="fu">mean</span>(.x) <span class="sc">&lt;=</span> <span class="dv">5</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb388-3"><a href="chapter-dplyr.html#cb388-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb388-4"><a href="chapter-dplyr.html#cb388-4" tabindex="-1"></a><span class="do">## # A tibble: 234 × 1</span></span>
<span id="cb388-5"><a href="chapter-dplyr.html#cb388-5" tabindex="-1"></a><span class="do">##   displ</span></span>
<span id="cb388-6"><a href="chapter-dplyr.html#cb388-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt;</span></span>
<span id="cb388-7"><a href="chapter-dplyr.html#cb388-7" tabindex="-1"></a><span class="do">## 1   1.8</span></span>
<span id="cb388-8"><a href="chapter-dplyr.html#cb388-8" tabindex="-1"></a><span class="do">## 2   1.8</span></span>
<span id="cb388-9"><a href="chapter-dplyr.html#cb388-9" tabindex="-1"></a><span class="do">## 3   2  </span></span>
<span id="cb388-10"><a href="chapter-dplyr.html#cb388-10" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<p>위 연산은 숫자형 변수 여부의 확인(<code>is.numeric(.x)</code>) 결과가 <code>TRUE</code>이고,
이어서 평균이 5 이하 여부의 확인(<code>mean(.x) &lt;= 5</code>) 결과가 <code>TRUE</code>가 되는 변수만 선택하게 된다.</p>
<ol start="3" style="list-style-type: decimal">
<li>변수 선택과 관련된 함수의 이용</li>
</ol>
<p>변수 선택에 매우 유용하게 사용되는 함수들이 있다. 먼저 특정 위치의 열을 선택할 때 사용할 수 있는 함수들이다.</p>
<ul>
<li><p><code>everything()</code> : 모든 변수 선택</p></li>
<li><p><code>last_col()</code> : 마지막 변수 선택</p></li>
</ul>
<p>변수 이름을 구성하고 있는 문자열에 대한 매칭 작업으로 변수를 선택할 때 사용할 수 있는 함수들이다.</p>
<ul>
<li><p><code>starts_with("x")</code>: 이름이 <code>x</code>로 시작하는 변수 선택</p></li>
<li><p><code>ends_with("x")</code>: 이름이 <code>x</code>로 끝나는 변수 선택</p></li>
<li><p><code>contains("x")</code>: 이름에 <code>x</code>가 있는 변수 선택</p></li>
<li><p><code>num_range("x", 1:10)</code>: <code>x1</code>, <code>x2</code>, … , <code>x10</code>과 동일</p></li>
</ul>
<p>변수 이름이 입력된 문자형 벡터를 이용하여 변수를 선택할 때 사용할 수 있는 함수들 이다.</p>
<ul>
<li><p><code>all_of(vec)</code>: 문자형 벡터 <code>vec</code>에 이름이 입력된 변수 선택. 해당 데이터 프레임에 없는 변수 이름이 <code>vec</code>에 입력되어 있으면 오류 발생.</p></li>
<li><p><code>any_of(vec)</code>: 함수 <code>all_of()</code>와 동일함. 단, 데이터 프레임에 없는 변수 이름이 입력 되어도 오류가 발생하지 않음.</p></li>
</ul>
<p>예제로 데이터 프레임 <code>mtcars_t</code>에서 첫 번째 변수와 마지막 변수를 선택해 보자.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="chapter-dplyr.html#cb389-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb389-2"><a href="chapter-dplyr.html#cb389-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>, <span class="fu">last_col</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb389-3"><a href="chapter-dplyr.html#cb389-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb389-4"><a href="chapter-dplyr.html#cb389-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 2</span></span>
<span id="cb389-5"><a href="chapter-dplyr.html#cb389-5" tabindex="-1"></a><span class="do">##   row.name       carb</span></span>
<span id="cb389-6"><a href="chapter-dplyr.html#cb389-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span id="cb389-7"><a href="chapter-dplyr.html#cb389-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4         4</span></span>
<span id="cb389-8"><a href="chapter-dplyr.html#cb389-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 Wag     4</span></span>
<span id="cb389-9"><a href="chapter-dplyr.html#cb389-9" tabindex="-1"></a><span class="do">## 3 Datsun 710        1</span></span>
<span id="cb389-10"><a href="chapter-dplyr.html#cb389-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>이번에는 <code>mtcars_t</code>에서 이름이 <code>m</code>으로 시작하는 변수를 선택해 보자.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="chapter-dplyr.html#cb390-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb390-2"><a href="chapter-dplyr.html#cb390-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;m&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb390-3"><a href="chapter-dplyr.html#cb390-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb390-4"><a href="chapter-dplyr.html#cb390-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 1</span></span>
<span id="cb390-5"><a href="chapter-dplyr.html#cb390-5" tabindex="-1"></a><span class="do">##     mpg</span></span>
<span id="cb390-6"><a href="chapter-dplyr.html#cb390-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt;</span></span>
<span id="cb390-7"><a href="chapter-dplyr.html#cb390-7" tabindex="-1"></a><span class="do">## 1  21  </span></span>
<span id="cb390-8"><a href="chapter-dplyr.html#cb390-8" tabindex="-1"></a><span class="do">## 2  21  </span></span>
<span id="cb390-9"><a href="chapter-dplyr.html#cb390-9" tabindex="-1"></a><span class="do">## 3  22.8</span></span>
<span id="cb390-10"><a href="chapter-dplyr.html#cb390-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>이름이 <code>p</code>로 끝나는 변수도 선택해 보자.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="chapter-dplyr.html#cb391-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb391-2"><a href="chapter-dplyr.html#cb391-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;p&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb391-3"><a href="chapter-dplyr.html#cb391-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb391-4"><a href="chapter-dplyr.html#cb391-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 2</span></span>
<span id="cb391-5"><a href="chapter-dplyr.html#cb391-5" tabindex="-1"></a><span class="do">##    disp    hp</span></span>
<span id="cb391-6"><a href="chapter-dplyr.html#cb391-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb391-7"><a href="chapter-dplyr.html#cb391-7" tabindex="-1"></a><span class="do">## 1   160   110</span></span>
<span id="cb391-8"><a href="chapter-dplyr.html#cb391-8" tabindex="-1"></a><span class="do">## 2   160   110</span></span>
<span id="cb391-9"><a href="chapter-dplyr.html#cb391-9" tabindex="-1"></a><span class="do">## 3   108    93</span></span>
<span id="cb391-10"><a href="chapter-dplyr.html#cb391-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>이름에 <code>A</code>가 있는 변수를 선택해 보자.</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="chapter-dplyr.html#cb392-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb392-2"><a href="chapter-dplyr.html#cb392-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;A&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb392-3"><a href="chapter-dplyr.html#cb392-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb392-4"><a href="chapter-dplyr.html#cb392-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 5</span></span>
<span id="cb392-5"><a href="chapter-dplyr.html#cb392-5" tabindex="-1"></a><span class="do">##   row.name       drat    am  gear  carb</span></span>
<span id="cb392-6"><a href="chapter-dplyr.html#cb392-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb392-7"><a href="chapter-dplyr.html#cb392-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4      3.9      1     4     4</span></span>
<span id="cb392-8"><a href="chapter-dplyr.html#cb392-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 Wag  3.9      1     4     4</span></span>
<span id="cb392-9"><a href="chapter-dplyr.html#cb392-9" tabindex="-1"></a><span class="do">## 3 Datsun 710     3.85     1     4     1</span></span>
<span id="cb392-10"><a href="chapter-dplyr.html#cb392-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>대문자 <code>A</code>가 이름에 있는 변수 선택을 요구했지만, 결과는 모두 소문자 <code>a</code>가 이름에 있는 변수가 선택되었다. 이런 결과가 나온 이유는 옵션 <code>ignore.case = TRUE</code>가 디폴트로 설정되어서 대문자와 소문자를 구분하지 않기 때문이다. 이 옵션은 함수 <code>starts_with()</code>와 <code>ends_with()</code>에도 동일하게 <code>TRUE</code>가 디폴트이다. 만일 대문자를 구분해서 문자열 매칭 작업을 하면 다음과 같이 해당되는 변수가 없다는 결과가 나온다.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="chapter-dplyr.html#cb393-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb393-2"><a href="chapter-dplyr.html#cb393-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;A&quot;</span>, <span class="at">ignore.case =</span> <span class="cn">FALSE</span>))</span>
<span id="cb393-3"><a href="chapter-dplyr.html#cb393-3" tabindex="-1"></a><span class="do">## # A tibble: 32 × 0</span></span></code></pre></div>
<p>문자형 벡터 <code>vars</code>에 다음과 같이 변수 이름을 입력해 보자. 앞에서 생성된 데이터 프레임 <code>mtcars_t</code>에는 변수 <code>mpg</code>와 <code>wt</code>는 있지만, 변수 <code>model</code>은 없는 상태이다.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="chapter-dplyr.html#cb394-1" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;model&quot;</span>, <span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;wt&quot;</span>)</span></code></pre></div>
<p>함수 <code>any_of()</code>를 사용하면 <code>mtcars_t</code>에 있는 두 변수가 선택된다.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="chapter-dplyr.html#cb395-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb395-2"><a href="chapter-dplyr.html#cb395-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">any_of</span>(vars)) <span class="sc">|&gt;</span>  </span>
<span id="cb395-3"><a href="chapter-dplyr.html#cb395-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb395-4"><a href="chapter-dplyr.html#cb395-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 2</span></span>
<span id="cb395-5"><a href="chapter-dplyr.html#cb395-5" tabindex="-1"></a><span class="do">##     mpg    wt</span></span>
<span id="cb395-6"><a href="chapter-dplyr.html#cb395-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb395-7"><a href="chapter-dplyr.html#cb395-7" tabindex="-1"></a><span class="do">## 1  21    2.62</span></span>
<span id="cb395-8"><a href="chapter-dplyr.html#cb395-8" tabindex="-1"></a><span class="do">## 2  21    2.88</span></span>
<span id="cb395-9"><a href="chapter-dplyr.html#cb395-9" tabindex="-1"></a><span class="do">## 3  22.8  2.32</span></span>
<span id="cb395-10"><a href="chapter-dplyr.html#cb395-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>함수 <code>all_of()</code>를 사용하게 되면 <code>model</code>이 <code>mtcars_t</code>에 없는 변수이기 때문에 오류가 발생하게 된다.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="chapter-dplyr.html#cb396-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb396-2"><a href="chapter-dplyr.html#cb396-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(vars)) </span>
<span id="cb396-3"><a href="chapter-dplyr.html#cb396-3" tabindex="-1"></a><span class="do">## Error in `all_of()`:</span></span>
<span id="cb396-4"><a href="chapter-dplyr.html#cb396-4" tabindex="-1"></a><span class="do">## ! Can&#39;t subset columns that don&#39;t exist.</span></span>
<span id="cb396-5"><a href="chapter-dplyr.html#cb396-5" tabindex="-1"></a><span class="do">## ✖ Column `model` doesn&#39;t exist.</span></span></code></pre></div>
<p>당연한 것이지만, 지금까지 살펴본 세 가지 변수 선택 방법은 서로 혼합해서 사용할 수 있다. 예를 들어 숫자형 변수 중에 이름에 <code>a</code>가 있는 변수는 다음과 같이 선택할 수 있다.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="chapter-dplyr.html#cb397-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb397-2"><a href="chapter-dplyr.html#cb397-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">&amp;</span> <span class="fu">contains</span>(<span class="st">&quot;c&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb397-3"><a href="chapter-dplyr.html#cb397-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb397-4"><a href="chapter-dplyr.html#cb397-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 3</span></span>
<span id="cb397-5"><a href="chapter-dplyr.html#cb397-5" tabindex="-1"></a><span class="do">##     cyl  qsec  carb</span></span>
<span id="cb397-6"><a href="chapter-dplyr.html#cb397-6" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb397-7"><a href="chapter-dplyr.html#cb397-7" tabindex="-1"></a><span class="do">## 1     6  16.5     4</span></span>
<span id="cb397-8"><a href="chapter-dplyr.html#cb397-8" tabindex="-1"></a><span class="do">## 2     6  17.0     4</span></span>
<span id="cb397-9"><a href="chapter-dplyr.html#cb397-9" tabindex="-1"></a><span class="do">## 3     4  18.6     1</span></span>
<span id="cb397-10"><a href="chapter-dplyr.html#cb397-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<ul>
<li>벡터 형태로 변수 선택: 함수 <code>pull()</code></li>
</ul>
<p>데이터 프레임의 한 변수를 선택하여 벡터로 추출하고자 한다면 함수 <code>pull()</code>을 사용하면 된다. 변수 선택 방법은 옵션 <code>var</code>에 변수 이름을 지정하거나, 위치를 나타내는 정수를 지정하는 것이다. 양의 정수는 첫 번째 변수를 시작점으로 하는 위치이고, 음의 정수는 마지막 변수 를 시작점으로 하는 위치이다. 디폴트는 <code>var = -1</code>로 설정되어 있어서, 마지막 변수가 선택된다. 데이터 프레임 <code>mtcars</code>를 대상으로 마지막 변수와 세 번째 변수, 그리고 변수 <code>am</code>을 벡터 형태로 선택해 보자.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="chapter-dplyr.html#cb398-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  <span class="fu">pull</span>()</span>
<span id="cb398-2"><a href="chapter-dplyr.html#cb398-2" tabindex="-1"></a><span class="do">##  [1] 4 4 1 1 2 1 4 2 2 4 4 3 3 3 4 4 4 1 2 1 1 2 2 4 2 1 2 2 4 6 8 2</span></span></code></pre></div>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="chapter-dplyr.html#cb399-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  <span class="fu">pull</span>(<span class="at">var =</span> <span class="dv">3</span>)</span>
<span id="cb399-2"><a href="chapter-dplyr.html#cb399-2" tabindex="-1"></a><span class="do">##  [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</span></span></code></pre></div>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="chapter-dplyr.html#cb400-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  <span class="fu">pull</span>(<span class="at">var =</span> am)</span>
<span id="cb400-2"><a href="chapter-dplyr.html#cb400-2" tabindex="-1"></a><span class="do">##  [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1</span></span></code></pre></div>
</div>
<div id="열-이름-변경-rename과-rename_with" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> 열 이름 변경: <code>rename()</code>과 <code>rename_with()</code><a href="chapter-dplyr.html#열-이름-변경-rename과-rename_with" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>변수 이름이 매우 복잡하거나 사용하기 불편해서 이름을 변경해야 하는 경우가 많다. 함수 <code>select()</code>로도 변수 이름을 변경할 수 있으나, 함수 내에서 이름이 명시되지 않은 변수는 선택되지 않은 변수가 되어 제거되고, 이름이 변경된 변수만 남게 된다. 변수에 새로운 이름을 주는 방식은 <code>new_name = old_name</code>이 되는데, <code>old_name</code> 자리에는 변수 이름 또는 변수의 열 번호가 올 수 있다.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="chapter-dplyr.html#cb401-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb401-2"><a href="chapter-dplyr.html#cb401-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">model =</span> row.name) <span class="sc">|&gt;</span>  </span>
<span id="cb401-3"><a href="chapter-dplyr.html#cb401-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb401-4"><a href="chapter-dplyr.html#cb401-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 1</span></span>
<span id="cb401-5"><a href="chapter-dplyr.html#cb401-5" tabindex="-1"></a><span class="do">##   model        </span></span>
<span id="cb401-6"><a href="chapter-dplyr.html#cb401-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        </span></span>
<span id="cb401-7"><a href="chapter-dplyr.html#cb401-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4    </span></span>
<span id="cb401-8"><a href="chapter-dplyr.html#cb401-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 Wag</span></span>
<span id="cb401-9"><a href="chapter-dplyr.html#cb401-9" tabindex="-1"></a><span class="do">## 3 Datsun 710   </span></span>
<span id="cb401-10"><a href="chapter-dplyr.html#cb401-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="chapter-dplyr.html#cb402-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb402-2"><a href="chapter-dplyr.html#cb402-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">model =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb402-3"><a href="chapter-dplyr.html#cb402-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb402-4"><a href="chapter-dplyr.html#cb402-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 1</span></span>
<span id="cb402-5"><a href="chapter-dplyr.html#cb402-5" tabindex="-1"></a><span class="do">##   model        </span></span>
<span id="cb402-6"><a href="chapter-dplyr.html#cb402-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        </span></span>
<span id="cb402-7"><a href="chapter-dplyr.html#cb402-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4    </span></span>
<span id="cb402-8"><a href="chapter-dplyr.html#cb402-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 Wag</span></span>
<span id="cb402-9"><a href="chapter-dplyr.html#cb402-9" tabindex="-1"></a><span class="do">## 3 Datsun 710   </span></span>
<span id="cb402-10"><a href="chapter-dplyr.html#cb402-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>함수 <code>select()</code>에서 이름이 변경되지 않은 변수도 모두 그대로 유지하려면 함수 <code>everything()</code>을 함께 사용하면 된다.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="chapter-dplyr.html#cb403-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb403-2"><a href="chapter-dplyr.html#cb403-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">model =</span> <span class="dv">1</span>, <span class="fu">everything</span>()) <span class="sc">|&gt;</span>  </span>
<span id="cb403-3"><a href="chapter-dplyr.html#cb403-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb403-4"><a href="chapter-dplyr.html#cb403-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 12</span></span>
<span id="cb403-5"><a href="chapter-dplyr.html#cb403-5" tabindex="-1"></a><span class="do">##   model          mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb403-6"><a href="chapter-dplyr.html#cb403-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb403-7"><a href="chapter-dplyr.html#cb403-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4     21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb403-8"><a href="chapter-dplyr.html#cb403-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 W…  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb403-9"><a href="chapter-dplyr.html#cb403-9" tabindex="-1"></a><span class="do">## 3 Datsun 710    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb403-10"><a href="chapter-dplyr.html#cb403-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>함수 <code>rename()</code>을 사용하면 이름이 변경되지 않은 변수도 모두 그대로 유지가 된다. 변수에 새로운 이름을 주는 방식은 함수 <code>select()</code>와 동일하게 <code>new_name = old_name</code>이다.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="chapter-dplyr.html#cb404-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span> </span>
<span id="cb404-2"><a href="chapter-dplyr.html#cb404-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">model =</span> row.name) <span class="sc">|&gt;</span> </span>
<span id="cb404-3"><a href="chapter-dplyr.html#cb404-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb404-4"><a href="chapter-dplyr.html#cb404-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 12</span></span>
<span id="cb404-5"><a href="chapter-dplyr.html#cb404-5" tabindex="-1"></a><span class="do">##   model          mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb404-6"><a href="chapter-dplyr.html#cb404-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb404-7"><a href="chapter-dplyr.html#cb404-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4     21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb404-8"><a href="chapter-dplyr.html#cb404-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 W…  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb404-9"><a href="chapter-dplyr.html#cb404-9" tabindex="-1"></a><span class="do">## 3 Datsun 710    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb404-10"><a href="chapter-dplyr.html#cb404-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>많은 변수의 이름을 어떤 공통된 양식에 따라 모두 바꿔야 하는 경우, 하나씩 <code>new_name = old_name</code>으로 변경하는 방식은 매우 비효율적이 될 수 있다. 예컨대 대문자로 입력된 변수 이름을 모두 소문자로 변경하거나, 이름 중간에 들어간 점(.)을 밑줄(_)로 변경해야 하는 경우에 하나씩 변경하는 방식이 아닌 해당되는 변수의 이름을 한꺼번에 모두 바꿀 수 있는 방식이 필요한 것이다. 이러한 작업은 함수 <code>rename_with()</code>로 할 수 있다.</p>
<p>데이터 프레임 <code>mtcars_t</code>의 모든 변수 이름을 대문자로 변경해 보자.
함수 <code>rename_with()</code>에는 기존의 변수 이름을 새로운 이름으로 바꿀 수 있는 함수를 지정해야 한다.
모든 변수를 대문자로 변경하는 작업이므로 함수 <code>toupper()</code>를 사용하면 되는데,
하나의 함수만을 사용하는 경우에는 함수 이름을 입력하면 된다.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="chapter-dplyr.html#cb405-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb405-2"><a href="chapter-dplyr.html#cb405-2" tabindex="-1"></a>  <span class="fu">rename_with</span>(toupper) <span class="sc">|&gt;</span>  </span>
<span id="cb405-3"><a href="chapter-dplyr.html#cb405-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb405-4"><a href="chapter-dplyr.html#cb405-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 12</span></span>
<span id="cb405-5"><a href="chapter-dplyr.html#cb405-5" tabindex="-1"></a><span class="do">##   ROW.NAME       MPG   CYL  DISP    HP  DRAT    WT  QSEC    VS    AM  GEAR  CARB</span></span>
<span id="cb405-6"><a href="chapter-dplyr.html#cb405-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb405-7"><a href="chapter-dplyr.html#cb405-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4     21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb405-8"><a href="chapter-dplyr.html#cb405-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 W…  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb405-9"><a href="chapter-dplyr.html#cb405-9" tabindex="-1"></a><span class="do">## 3 Datsun 710    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb405-10"><a href="chapter-dplyr.html#cb405-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>모든 변수가 이름 변경 대상이 되는 것이 디폴트이다. 변경 대상 변수를 선택을 해야 하는 경우에는 함수 <code>select()</code>에서 사용했던 <code>&lt;tidy-select&gt;</code>의 방식으로 선택하여 함수 <code>rename_with()</code>의 세 번째 입력요소로 지정하면 된다. 이름에 <code>a</code>가 포함되어 있는 변수의 이름을 대문자로 바꾸어 보자.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="chapter-dplyr.html#cb406-1" tabindex="-1"></a>mtcars_t <span class="sc">|&gt;</span>  </span>
<span id="cb406-2"><a href="chapter-dplyr.html#cb406-2" tabindex="-1"></a>  <span class="fu">rename_with</span>(toupper, <span class="fu">contains</span>(<span class="st">&quot;a&quot;</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb406-3"><a href="chapter-dplyr.html#cb406-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb406-4"><a href="chapter-dplyr.html#cb406-4" tabindex="-1"></a><span class="do">## # A tibble: 32 × 12</span></span>
<span id="cb406-5"><a href="chapter-dplyr.html#cb406-5" tabindex="-1"></a><span class="do">##   ROW.NAME       mpg   cyl  disp    hp  DRAT    wt  qsec    vs    AM  GEAR  CARB</span></span>
<span id="cb406-6"><a href="chapter-dplyr.html#cb406-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb406-7"><a href="chapter-dplyr.html#cb406-7" tabindex="-1"></a><span class="do">## 1 Mazda RX4     21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb406-8"><a href="chapter-dplyr.html#cb406-8" tabindex="-1"></a><span class="do">## 2 Mazda RX4 W…  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb406-9"><a href="chapter-dplyr.html#cb406-9" tabindex="-1"></a><span class="do">## 3 Datsun 710    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb406-10"><a href="chapter-dplyr.html#cb406-10" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>데이터 프레임 <code>iris</code>의 변수 이름에는 점(.)이 포함되어 있고, 대문자도 있다.
먼저 변수 이름에 있는 점을 밑줄로 바꿔보자.
특정 문자의 치환은 함수 <code>gsub()</code>로 할 수 있는데,
메타 문자인 점(.)을 치환해야 하기 때문에 옵션 <code>fixed = TRUE</code>를 포함해야 한다.
따라서 함수 <code>rename_with()</code>에 입력되는 이름 변경을 위한 함수는 <code>purrr</code> 형태를 취하게 된다.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="chapter-dplyr.html#cb407-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span>  </span>
<span id="cb407-2"><a href="chapter-dplyr.html#cb407-2" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span>  </span>
<span id="cb407-3"><a href="chapter-dplyr.html#cb407-3" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">&quot;.&quot;</span>, <span class="st">&quot;_&quot;</span>, .x, <span class="at">fixed =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb407-4"><a href="chapter-dplyr.html#cb407-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb407-5"><a href="chapter-dplyr.html#cb407-5" tabindex="-1"></a><span class="do">## # A tibble: 150 × 5</span></span>
<span id="cb407-6"><a href="chapter-dplyr.html#cb407-6" tabindex="-1"></a><span class="do">##   Sepal_Length Sepal_Width Petal_Length Petal_Width Species</span></span>
<span id="cb407-7"><a href="chapter-dplyr.html#cb407-7" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb407-8"><a href="chapter-dplyr.html#cb407-8" tabindex="-1"></a><span class="do">## 1          5.1         3.5          1.4         0.2 setosa </span></span>
<span id="cb407-9"><a href="chapter-dplyr.html#cb407-9" tabindex="-1"></a><span class="do">## 2          4.9         3            1.4         0.2 setosa </span></span>
<span id="cb407-10"><a href="chapter-dplyr.html#cb407-10" tabindex="-1"></a><span class="do">## 3          4.7         3.2          1.3         0.2 setosa </span></span>
<span id="cb407-11"><a href="chapter-dplyr.html#cb407-11" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span></code></pre></div>
<p>이번에는 점을 밑줄로 바꾸고, 이름에는 있는 대문자를 모두 소문자로 바꾸어 보자.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="chapter-dplyr.html#cb408-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span>  </span>
<span id="cb408-2"><a href="chapter-dplyr.html#cb408-2" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span>  </span>
<span id="cb408-3"><a href="chapter-dplyr.html#cb408-3" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">tolower</span>(<span class="fu">gsub</span>(<span class="st">&quot;.&quot;</span>, <span class="st">&quot;_&quot;</span>, .x, <span class="at">fixed =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span>               </span>
<span id="cb408-4"><a href="chapter-dplyr.html#cb408-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb408-5"><a href="chapter-dplyr.html#cb408-5" tabindex="-1"></a><span class="do">## # A tibble: 150 × 5</span></span>
<span id="cb408-6"><a href="chapter-dplyr.html#cb408-6" tabindex="-1"></a><span class="do">##   sepal_length sepal_width petal_length petal_width species</span></span>
<span id="cb408-7"><a href="chapter-dplyr.html#cb408-7" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb408-8"><a href="chapter-dplyr.html#cb408-8" tabindex="-1"></a><span class="do">## 1          5.1         3.5          1.4         0.2 setosa </span></span>
<span id="cb408-9"><a href="chapter-dplyr.html#cb408-9" tabindex="-1"></a><span class="do">## 2          4.9         3            1.4         0.2 setosa </span></span>
<span id="cb408-10"><a href="chapter-dplyr.html#cb408-10" tabindex="-1"></a><span class="do">## 3          4.7         3.2          1.3         0.2 setosa </span></span>
<span id="cb408-11"><a href="chapter-dplyr.html#cb408-11" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span></code></pre></div>
<p>함수 안에서도 pipe 연산자의 사용이 가능한데, 위 예제는 다음과 같이 작성할 수 있다.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="chapter-dplyr.html#cb409-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb409-2"><a href="chapter-dplyr.html#cb409-2" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb409-3"><a href="chapter-dplyr.html#cb409-3" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">&quot;.&quot;</span>, <span class="st">&quot;_&quot;</span>, .x, <span class="at">fixed =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb409-4"><a href="chapter-dplyr.html#cb409-4" tabindex="-1"></a>                <span class="fu">tolower</span>()</span>
<span id="cb409-5"><a href="chapter-dplyr.html#cb409-5" tabindex="-1"></a>              ) <span class="sc">|&gt;</span> </span>
<span id="cb409-6"><a href="chapter-dplyr.html#cb409-6" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb409-7"><a href="chapter-dplyr.html#cb409-7" tabindex="-1"></a><span class="do">## # A tibble: 150 × 5</span></span>
<span id="cb409-8"><a href="chapter-dplyr.html#cb409-8" tabindex="-1"></a><span class="do">##   sepal_length sepal_width petal_length petal_width species</span></span>
<span id="cb409-9"><a href="chapter-dplyr.html#cb409-9" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb409-10"><a href="chapter-dplyr.html#cb409-10" tabindex="-1"></a><span class="do">## 1          5.1         3.5          1.4         0.2 setosa </span></span>
<span id="cb409-11"><a href="chapter-dplyr.html#cb409-11" tabindex="-1"></a><span class="do">## 2          4.9         3            1.4         0.2 setosa </span></span>
<span id="cb409-12"><a href="chapter-dplyr.html#cb409-12" tabindex="-1"></a><span class="do">## 3          4.7         3.2          1.3         0.2 setosa </span></span>
<span id="cb409-13"><a href="chapter-dplyr.html#cb409-13" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span></code></pre></div>
</div>
<div id="열의-위치-변경-relocate" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> 열의 위치 변경: <code>relocate()</code><a href="chapter-dplyr.html#열의-위치-변경-relocate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>열의 위치를 변경해야 하는 경우에 사용할 수 있는 함수이다. 위치를 바꿀 열은 <code>&lt;tidy-select&gt;</code> 방식을 사용하여 선택할 수 있어서, 여러 열의 위치를 한꺼번에 옮길 수 있다. 제일 앞으로 이동되는 것이 디폴트 위치이며 옵션 <code>.after</code> 혹은 <code>.before</code>에서 위치를 지정할 수 있다.</p>
<p>데이터 프레임 <code>iris</code>의 마지막 변수 <code>Species</code>를 첫 번째 위치로 이동해 보자.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="chapter-dplyr.html#cb410-1" tabindex="-1"></a>iris_t <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span></code></pre></div>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="chapter-dplyr.html#cb411-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb411-2"><a href="chapter-dplyr.html#cb411-2" tabindex="-1"></a>  <span class="fu">relocate</span>(Species) <span class="sc">|&gt;</span>  </span>
<span id="cb411-3"><a href="chapter-dplyr.html#cb411-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb411-4"><a href="chapter-dplyr.html#cb411-4" tabindex="-1"></a><span class="do">## # A tibble: 150 × 5</span></span>
<span id="cb411-5"><a href="chapter-dplyr.html#cb411-5" tabindex="-1"></a><span class="do">##   Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb411-6"><a href="chapter-dplyr.html#cb411-6" tabindex="-1"></a><span class="do">##   &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb411-7"><a href="chapter-dplyr.html#cb411-7" tabindex="-1"></a><span class="do">## 1 setosa           5.1         3.5          1.4         0.2</span></span>
<span id="cb411-8"><a href="chapter-dplyr.html#cb411-8" tabindex="-1"></a><span class="do">## 2 setosa           4.9         3            1.4         0.2</span></span>
<span id="cb411-9"><a href="chapter-dplyr.html#cb411-9" tabindex="-1"></a><span class="do">## 3 setosa           4.7         3.2          1.3         0.2</span></span>
<span id="cb411-10"><a href="chapter-dplyr.html#cb411-10" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span></code></pre></div>
<p>다른 방법으로 이름이 <code>th</code>로 끝나는 변수를 모두 <code>Species</code> 다음으로 이동하면 변수 <code>Species</code>를 첫 번째 위치로 이동하는 것이 된다.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="chapter-dplyr.html#cb412-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb412-2"><a href="chapter-dplyr.html#cb412-2" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">ends_with</span>(<span class="st">&quot;th&quot;</span>), <span class="at">.after =</span> Species) <span class="sc">|&gt;</span>  </span>
<span id="cb412-3"><a href="chapter-dplyr.html#cb412-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb412-4"><a href="chapter-dplyr.html#cb412-4" tabindex="-1"></a><span class="do">## # A tibble: 150 × 5</span></span>
<span id="cb412-5"><a href="chapter-dplyr.html#cb412-5" tabindex="-1"></a><span class="do">##   Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb412-6"><a href="chapter-dplyr.html#cb412-6" tabindex="-1"></a><span class="do">##   &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb412-7"><a href="chapter-dplyr.html#cb412-7" tabindex="-1"></a><span class="do">## 1 setosa           5.1         3.5          1.4         0.2</span></span>
<span id="cb412-8"><a href="chapter-dplyr.html#cb412-8" tabindex="-1"></a><span class="do">## 2 setosa           4.9         3            1.4         0.2</span></span>
<span id="cb412-9"><a href="chapter-dplyr.html#cb412-9" tabindex="-1"></a><span class="do">## 3 setosa           4.7         3.2          1.3         0.2</span></span>
<span id="cb412-10"><a href="chapter-dplyr.html#cb412-10" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span></code></pre></div>
<p>또 다른 방법으로 이름이 <code>th</code>로 끝나는 변수를 마지막 변수 다음으로 이동하면 변수 <code>Species</code>를 첫 번째 위치로 이동하는 것이 된다.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="chapter-dplyr.html#cb413-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb413-2"><a href="chapter-dplyr.html#cb413-2" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">ends_with</span>(<span class="st">&quot;th&quot;</span>), <span class="at">.after =</span> <span class="fu">last_col</span>()) <span class="sc">|&gt;</span>  </span>
<span id="cb413-3"><a href="chapter-dplyr.html#cb413-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb413-4"><a href="chapter-dplyr.html#cb413-4" tabindex="-1"></a><span class="do">## # A tibble: 150 × 5</span></span>
<span id="cb413-5"><a href="chapter-dplyr.html#cb413-5" tabindex="-1"></a><span class="do">##   Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb413-6"><a href="chapter-dplyr.html#cb413-6" tabindex="-1"></a><span class="do">##   &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb413-7"><a href="chapter-dplyr.html#cb413-7" tabindex="-1"></a><span class="do">## 1 setosa           5.1         3.5          1.4         0.2</span></span>
<span id="cb413-8"><a href="chapter-dplyr.html#cb413-8" tabindex="-1"></a><span class="do">## 2 setosa           4.9         3            1.4         0.2</span></span>
<span id="cb413-9"><a href="chapter-dplyr.html#cb413-9" tabindex="-1"></a><span class="do">## 3 setosa           4.7         3.2          1.3         0.2</span></span>
<span id="cb413-10"><a href="chapter-dplyr.html#cb413-10" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span></code></pre></div>
<p>특정 변수를 제일 앞으로 이동하는 작업은 함수 <code>select()</code>에 <code>everything()</code>을 함께 사용해서 할 수도 있다.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="chapter-dplyr.html#cb414-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb414-2"><a href="chapter-dplyr.html#cb414-2" tabindex="-1"></a>  <span class="fu">select</span>(Species, <span class="fu">everything</span>()) <span class="sc">|&gt;</span>  </span>
<span id="cb414-3"><a href="chapter-dplyr.html#cb414-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb414-4"><a href="chapter-dplyr.html#cb414-4" tabindex="-1"></a><span class="do">## # A tibble: 150 × 5</span></span>
<span id="cb414-5"><a href="chapter-dplyr.html#cb414-5" tabindex="-1"></a><span class="do">##   Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb414-6"><a href="chapter-dplyr.html#cb414-6" tabindex="-1"></a><span class="do">##   &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb414-7"><a href="chapter-dplyr.html#cb414-7" tabindex="-1"></a><span class="do">## 1 setosa           5.1         3.5          1.4         0.2</span></span>
<span id="cb414-8"><a href="chapter-dplyr.html#cb414-8" tabindex="-1"></a><span class="do">## 2 setosa           4.9         3            1.4         0.2</span></span>
<span id="cb414-9"><a href="chapter-dplyr.html#cb414-9" tabindex="-1"></a><span class="do">## 3 setosa           4.7         3.2          1.3         0.2</span></span>
<span id="cb414-10"><a href="chapter-dplyr.html#cb414-10" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span></code></pre></div>
</div>
<div id="새로운-열의-추가-mutate와-transmute" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> 새로운 열의 추가: <code>mutate()</code>와 <code>transmute()</code><a href="chapter-dplyr.html#새로운-열의-추가-mutate와-transmute" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>데이터 프레임을 구성하고 있는 기존의 변수들을 이용하여 새로운 변수를 만들어 데이터 프레임에 추가해야 할 경우가 종종 있다. 이러한 작업을 수행하는 함수가 <code>mutate()</code>이다.
데이터 프레임이 함수 <code>mutate()</code>의 첫 번째 입력 요소가 되고, 이어서 새로운 변수를 만드는 표현식이 차례로 입력된다.
새롭게 만들어진 변수는 데이터 프레임의 제일 마지막 변수로 추가되는 것이 디폴트이다.
만일 추가된 변수의 위치를 변경하고자 한다면, 옵션 <code>.after</code> 또는 <code>.before</code>에서 지정하면 된다.</p>
<p>만일 새롭게 만들어진 변수로만 데이터 프레임을 구성하고자 한다면 함수 <code>transmute()</code>를 사용하면 된다.</p>
<p>함수 <code>mutate()</code>와 <code>transmute()</code>에서 새로운 변수를 만들 때 유용하게 사용되는 함수들의 목록이 RStudio의 메뉴 <code>Help &gt; Cheatsheets &gt; Data Transformation with dplyr</code>에 잘 정리되어 있다.</p>
<ul>
<li>예제: <code>mtcars</code></li>
</ul>
<p>다음의 조건에 의하여 새로운 변수 <code>kml</code>과 <code>gp_kml</code>을 만들고 데이터 프레임에 첫 번째와 두번째 변수로 추가해 보자.</p>
<p>∙ 변수 <code>kml</code>: 1 mpg(mile per gallon)는 0.43 kml(kilometer per liter)</p>
<p>∙ 변수 <code>gp_kml</code>: <code>kml</code>이 10 이상이면 <code>"good"</code>, 10 미만이면 <code>"bad"</code></p>
<p>연속형 변수 <code>kml</code>을 기반으로 범주의 개수가 두 개인 범주형 변수 <code>gp_kml</code>를 생성하는 작업은 함수 <code>if_else()</code>를 사용하는 것이 효과적이다. 기본적인 사용법은 <code>if_else(condition, true, false)</code>이며 <code>condition</code>이 만족되면 <code>true</code>의 값을 갖고, 아니면 <code>false</code>의 값을 갖게 된다.
예를 들어 벡터 <code>x</code>의 숫자가 0 미만인지 0 이상인지에 따라 다음의 문자형 벡터를 생성할 수 있다.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="chapter-dplyr.html#cb415-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb415-2"><a href="chapter-dplyr.html#cb415-2" tabindex="-1"></a><span class="fu">if_else</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;Negative&quot;</span>, <span class="st">&quot;Greater than 0&quot;</span>)</span>
<span id="cb415-3"><a href="chapter-dplyr.html#cb415-3" tabindex="-1"></a><span class="do">## [1] &quot;Negative&quot;       &quot;Greater than 0&quot; &quot;Greater than 0&quot;</span></span></code></pre></div>
<p>이제 변수 <code>kml</code>을 만들고, 조건에 따라 변수 <code>gp_kml</code>도 생성해 보자.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="chapter-dplyr.html#cb416-1" tabindex="-1"></a><span class="fu">as_tibble</span>(mtcars) <span class="sc">|&gt;</span>  </span>
<span id="cb416-2"><a href="chapter-dplyr.html#cb416-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kml =</span> <span class="fl">0.43</span><span class="sc">*</span>mpg,</span>
<span id="cb416-3"><a href="chapter-dplyr.html#cb416-3" tabindex="-1"></a>         <span class="at">gp_kml =</span> <span class="fu">if_else</span>(kml <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="st">&quot;good&quot;</span>, <span class="st">&quot;bad&quot;</span>),</span>
<span id="cb416-4"><a href="chapter-dplyr.html#cb416-4" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb416-5"><a href="chapter-dplyr.html#cb416-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb416-6"><a href="chapter-dplyr.html#cb416-6" tabindex="-1"></a><span class="do">## # A tibble: 32 × 13</span></span>
<span id="cb416-7"><a href="chapter-dplyr.html#cb416-7" tabindex="-1"></a><span class="do">##     kml gp_kml   mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb416-8"><a href="chapter-dplyr.html#cb416-8" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb416-9"><a href="chapter-dplyr.html#cb416-9" tabindex="-1"></a><span class="do">## 1  9.03 bad     21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb416-10"><a href="chapter-dplyr.html#cb416-10" tabindex="-1"></a><span class="do">## 2  9.03 bad     21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb416-11"><a href="chapter-dplyr.html#cb416-11" tabindex="-1"></a><span class="do">## 3  9.80 bad     22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb416-12"><a href="chapter-dplyr.html#cb416-12" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>만일 새롭게 생성된 변수만 유지하고 나머지 변수는 모두 삭제하려고 한다면, 함수 <code>transmute()</code>를 사용하면 된다.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="chapter-dplyr.html#cb417-1" tabindex="-1"></a><span class="fu">as_tibble</span>(mtcars) <span class="sc">|&gt;</span>  </span>
<span id="cb417-2"><a href="chapter-dplyr.html#cb417-2" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">kml =</span> <span class="fl">0.43</span><span class="sc">*</span>mpg,</span>
<span id="cb417-3"><a href="chapter-dplyr.html#cb417-3" tabindex="-1"></a>         <span class="at">gp_kml =</span> <span class="fu">if_else</span>(kml <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="st">&quot;good&quot;</span>, <span class="st">&quot;bad&quot;</span>)</span>
<span id="cb417-4"><a href="chapter-dplyr.html#cb417-4" tabindex="-1"></a>  ) <span class="sc">|&gt;</span>  </span>
<span id="cb417-5"><a href="chapter-dplyr.html#cb417-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb417-6"><a href="chapter-dplyr.html#cb417-6" tabindex="-1"></a><span class="do">## # A tibble: 32 × 2</span></span>
<span id="cb417-7"><a href="chapter-dplyr.html#cb417-7" tabindex="-1"></a><span class="do">##     kml gp_kml</span></span>
<span id="cb417-8"><a href="chapter-dplyr.html#cb417-8" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;chr&gt; </span></span>
<span id="cb417-9"><a href="chapter-dplyr.html#cb417-9" tabindex="-1"></a><span class="do">## 1  9.03 bad   </span></span>
<span id="cb417-10"><a href="chapter-dplyr.html#cb417-10" tabindex="-1"></a><span class="do">## 2  9.03 bad   </span></span>
<span id="cb417-11"><a href="chapter-dplyr.html#cb417-11" tabindex="-1"></a><span class="do">## 3  9.80 bad   </span></span>
<span id="cb417-12"><a href="chapter-dplyr.html#cb417-12" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p>연속형 변수를 기반으로 범주의 개수가 3개 이상이 되는 범주형 변수를 생성하려는 경우에 함수 <code>if_else()</code>를 사용하는 것은 적절하지 않을 수 있다. 이러한 경우에는 함수 <code>case_when()</code>이 효과적인 대안이 된다. 기본적인 형태는 <code>LHS ~ RHS</code>로서, <code>LHS</code>는 조건이고, <code>RHS</code>에는 할당하려는 값이 된다.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="chapter-dplyr.html#cb418-1" tabindex="-1"></a><span class="fu">case_when</span>(</span>
<span id="cb418-2"><a href="chapter-dplyr.html#cb418-2" tabindex="-1"></a>  condition_1 <span class="sc">~</span> value_1,</span>
<span id="cb418-3"><a href="chapter-dplyr.html#cb418-3" tabindex="-1"></a>  condition_2 <span class="sc">~</span> value_2,</span>
<span id="cb418-4"><a href="chapter-dplyr.html#cb418-4" tabindex="-1"></a>  condition_3 <span class="sc">~</span> value_3,</span>
<span id="cb418-5"><a href="chapter-dplyr.html#cb418-5" tabindex="-1"></a>  <span class="at">.default =</span> </span>
<span id="cb418-6"><a href="chapter-dplyr.html#cb418-6" tabindex="-1"></a>    )</span></code></pre></div>
<p>순서대로 <code>LHS</code>의 조건이 평가되며, 첫 번째 <code>TRUE</code>가 되는 조건의 <code>RHS</code>의 값이 부여된다.
모든 조건이 <code>FALSE</code> 이거나 <code>NA</code>인 경우에는 <code>.default</code>에 지정된 값이 부여되며, 제시되는 조건의 개수에는 제한이 없다.
예를 들어, 다음의 숫자형 벡터 <code>score</code>의 각 자료에 대하여 80 미만이면 <code>"C"</code>, 80에서 90 미만이면 <code>"B"</code>, 90 이상이면 <code>"A"</code>를 부여해 보자.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="chapter-dplyr.html#cb419-1" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">88</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="dv">78</span>, <span class="dv">65</span>)</span></code></pre></div>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="chapter-dplyr.html#cb420-1" tabindex="-1"></a><span class="fu">case_when</span>(</span>
<span id="cb420-2"><a href="chapter-dplyr.html#cb420-2" tabindex="-1"></a>  score <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">&quot;C&quot;</span>,</span>
<span id="cb420-3"><a href="chapter-dplyr.html#cb420-3" tabindex="-1"></a>  score <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb420-4"><a href="chapter-dplyr.html#cb420-4" tabindex="-1"></a>  score <span class="sc">&lt;</span> <span class="cn">Inf</span> <span class="sc">~</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb420-5"><a href="chapter-dplyr.html#cb420-5" tabindex="-1"></a>  )</span>
<span id="cb420-6"><a href="chapter-dplyr.html#cb420-6" tabindex="-1"></a><span class="do">## [1] &quot;B&quot; &quot;B&quot; &quot;A&quot; &quot;A&quot; &quot;C&quot; &quot;C&quot;</span></span></code></pre></div>
<p>조건의 순서가 바뀌는 경우에는 잘못된 결과가 나올 수 있는데, 다음은 어떤 문제가 있는 것인가?</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="chapter-dplyr.html#cb421-1" tabindex="-1"></a><span class="fu">case_when</span>(</span>
<span id="cb421-2"><a href="chapter-dplyr.html#cb421-2" tabindex="-1"></a>  score <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb421-3"><a href="chapter-dplyr.html#cb421-3" tabindex="-1"></a>  score <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">&quot;C&quot;</span>,</span>
<span id="cb421-4"><a href="chapter-dplyr.html#cb421-4" tabindex="-1"></a>  score <span class="sc">&lt;</span> <span class="cn">Inf</span> <span class="sc">~</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb421-5"><a href="chapter-dplyr.html#cb421-5" tabindex="-1"></a>  )</span>
<span id="cb421-6"><a href="chapter-dplyr.html#cb421-6" tabindex="-1"></a><span class="do">## [1] &quot;B&quot; &quot;B&quot; &quot;A&quot; &quot;A&quot; &quot;B&quot; &quot;B&quot;</span></span></code></pre></div>
<p>자료에 <code>NA</code>가 있으면, 비교 결과도 <code>NA</code>가 나오게 된다.
이 경우 다른 값을 부여하고자 한다면, <code>.default</code>에 지정을 하면 된다.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="chapter-dplyr.html#cb422-1" tabindex="-1"></a>score2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">88</span>,<span class="dv">90</span>,<span class="dv">100</span>,<span class="dv">78</span>,<span class="dv">65</span>, <span class="cn">NA</span>)</span></code></pre></div>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="chapter-dplyr.html#cb423-1" tabindex="-1"></a><span class="fu">case_when</span>(</span>
<span id="cb423-2"><a href="chapter-dplyr.html#cb423-2" tabindex="-1"></a>    score2 <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">&quot;C&quot;</span>,</span>
<span id="cb423-3"><a href="chapter-dplyr.html#cb423-3" tabindex="-1"></a>    score2 <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb423-4"><a href="chapter-dplyr.html#cb423-4" tabindex="-1"></a>    score2 <span class="sc">&lt;</span> <span class="cn">Inf</span> <span class="sc">~</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb423-5"><a href="chapter-dplyr.html#cb423-5" tabindex="-1"></a>    )</span>
<span id="cb423-6"><a href="chapter-dplyr.html#cb423-6" tabindex="-1"></a><span class="do">## [1] &quot;B&quot; &quot;B&quot; &quot;A&quot; &quot;A&quot; &quot;C&quot; &quot;C&quot; NA</span></span></code></pre></div>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="chapter-dplyr.html#cb424-1" tabindex="-1"></a><span class="fu">case_when</span>(</span>
<span id="cb424-2"><a href="chapter-dplyr.html#cb424-2" tabindex="-1"></a>    score2 <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">&quot;C&quot;</span>,</span>
<span id="cb424-3"><a href="chapter-dplyr.html#cb424-3" tabindex="-1"></a>    score2 <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb424-4"><a href="chapter-dplyr.html#cb424-4" tabindex="-1"></a>    score2 <span class="sc">&lt;</span> <span class="cn">Inf</span> <span class="sc">~</span> <span class="st">&quot;A&quot;</span>,</span>
<span id="cb424-5"><a href="chapter-dplyr.html#cb424-5" tabindex="-1"></a>    <span class="at">.default =</span> <span class="st">&quot;F&quot;</span></span>
<span id="cb424-6"><a href="chapter-dplyr.html#cb424-6" tabindex="-1"></a>    )</span>
<span id="cb424-7"><a href="chapter-dplyr.html#cb424-7" tabindex="-1"></a><span class="do">## [1] &quot;B&quot; &quot;B&quot; &quot;A&quot; &quot;A&quot; &quot;C&quot; &quot;C&quot; &quot;F&quot;</span></span></code></pre></div>
<p>이제 <code>mtcars</code> 예제로 돌아가서, 다음의 변경된 조건으로 변수 <code>gp_kml</code>을 생성해 보자.</p>
<p>∙ 변수 <code>gp_kml</code>: <code>kml</code>이 11 이상이면 <code>"excellent"</code>, 11 미만 8 이상이면 <code>"good"</code>, 8 미만이면 <code>"bad"</code></p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="chapter-dplyr.html#cb425-1" tabindex="-1"></a><span class="fu">as_tibble</span>(mtcars) <span class="sc">|&gt;</span>  </span>
<span id="cb425-2"><a href="chapter-dplyr.html#cb425-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kml =</span> <span class="fl">0.43</span><span class="sc">*</span>mpg,</span>
<span id="cb425-3"><a href="chapter-dplyr.html#cb425-3" tabindex="-1"></a>         <span class="at">gp_kml =</span> <span class="fu">case_when</span>(</span>
<span id="cb425-4"><a href="chapter-dplyr.html#cb425-4" tabindex="-1"></a>           kml <span class="sc">&lt;</span> <span class="dv">8</span>   <span class="sc">~</span> <span class="st">&quot;bad&quot;</span>,</span>
<span id="cb425-5"><a href="chapter-dplyr.html#cb425-5" tabindex="-1"></a>           kml <span class="sc">&lt;</span> <span class="dv">11</span>  <span class="sc">~</span> <span class="st">&quot;good&quot;</span>,</span>
<span id="cb425-6"><a href="chapter-dplyr.html#cb425-6" tabindex="-1"></a>           <span class="at">.default =</span> <span class="st">&quot;excellent&quot;</span></span>
<span id="cb425-7"><a href="chapter-dplyr.html#cb425-7" tabindex="-1"></a>           ),</span>
<span id="cb425-8"><a href="chapter-dplyr.html#cb425-8" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb425-9"><a href="chapter-dplyr.html#cb425-9" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb425-10"><a href="chapter-dplyr.html#cb425-10" tabindex="-1"></a><span class="do">## # A tibble: 32 × 13</span></span>
<span id="cb425-11"><a href="chapter-dplyr.html#cb425-11" tabindex="-1"></a><span class="do">##     kml gp_kml   mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb425-12"><a href="chapter-dplyr.html#cb425-12" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb425-13"><a href="chapter-dplyr.html#cb425-13" tabindex="-1"></a><span class="do">## 1  9.03 good    21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb425-14"><a href="chapter-dplyr.html#cb425-14" tabindex="-1"></a><span class="do">## 2  9.03 good    21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb425-15"><a href="chapter-dplyr.html#cb425-15" tabindex="-1"></a><span class="do">## 3  9.80 good    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb425-16"><a href="chapter-dplyr.html#cb425-16" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
<p><code>LHS</code>에 “excellent”에 대한 조건을 먼저 제시하려면 다음과 같이 진행하면 된다.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="chapter-dplyr.html#cb426-1" tabindex="-1"></a><span class="fu">as_tibble</span>(mtcars) <span class="sc">|&gt;</span>  </span>
<span id="cb426-2"><a href="chapter-dplyr.html#cb426-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kml =</span> <span class="fl">0.43</span><span class="sc">*</span>mpg,</span>
<span id="cb426-3"><a href="chapter-dplyr.html#cb426-3" tabindex="-1"></a>         <span class="at">gp_kml =</span> <span class="fu">case_when</span>(</span>
<span id="cb426-4"><a href="chapter-dplyr.html#cb426-4" tabindex="-1"></a>           kml <span class="sc">&gt;=</span> <span class="dv">11</span>   <span class="sc">~</span> <span class="st">&quot;excellent&quot;</span>,</span>
<span id="cb426-5"><a href="chapter-dplyr.html#cb426-5" tabindex="-1"></a>           kml <span class="sc">&gt;=</span> <span class="dv">8</span>    <span class="sc">~</span> <span class="st">&quot;good&quot;</span>,</span>
<span id="cb426-6"><a href="chapter-dplyr.html#cb426-6" tabindex="-1"></a>           <span class="at">.default =</span> <span class="st">&quot;bad&quot;</span></span>
<span id="cb426-7"><a href="chapter-dplyr.html#cb426-7" tabindex="-1"></a>         ),</span>
<span id="cb426-8"><a href="chapter-dplyr.html#cb426-8" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb426-9"><a href="chapter-dplyr.html#cb426-9" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb426-10"><a href="chapter-dplyr.html#cb426-10" tabindex="-1"></a><span class="do">## # A tibble: 32 × 13</span></span>
<span id="cb426-11"><a href="chapter-dplyr.html#cb426-11" tabindex="-1"></a><span class="do">##     kml gp_kml   mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span id="cb426-12"><a href="chapter-dplyr.html#cb426-12" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb426-13"><a href="chapter-dplyr.html#cb426-13" tabindex="-1"></a><span class="do">## 1  9.03 good    21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span id="cb426-14"><a href="chapter-dplyr.html#cb426-14" tabindex="-1"></a><span class="do">## 2  9.03 good    21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span id="cb426-15"><a href="chapter-dplyr.html#cb426-15" tabindex="-1"></a><span class="do">## 3  9.80 good    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span id="cb426-16"><a href="chapter-dplyr.html#cb426-16" tabindex="-1"></a><span class="do">## # ℹ 29 more rows</span></span></code></pre></div>
</div>
</div>
<div id="여러-행-자료의-요약-summarise" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> 여러 행 자료의 요약: <code>summarise()</code><a href="chapter-dplyr.html#여러-행-자료의-요약-summarise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>변수들의 요약통계량을 계산할 때 유용하게 사용되는 함수가 <code>summarise()</code>이다. 첫 번째 입력 요소는 데이터 프레임이고, 이어서 <code>name = fun</code>의 형태로 원하는 요약통계량 값을 계산할 함수와 열의 이름을 입력한다. 예를 들어 데이터 프레임 <code>mpg</code>의 변수 <code>hwy</code>의 전체 케이스와 서로 다른 값을 갖고 있는 케이스의 개수, 그리고 평균값을 계산해 보자. 전체 케이스는 함수 <code>n()</code>으로, 서로 다른 값을 갖는 케이스의 개수는 <code>n_distinct()</code>로 계산한다.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="chapter-dplyr.html#cb427-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb427-2"><a href="chapter-dplyr.html#cb427-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">n_hwy =</span> <span class="fu">n_distinct</span>(hwy), <span class="at">avg_hwy =</span> <span class="fu">mean</span>(hwy))</span>
<span id="cb427-3"><a href="chapter-dplyr.html#cb427-3" tabindex="-1"></a><span class="do">## # A tibble: 1 × 3</span></span>
<span id="cb427-4"><a href="chapter-dplyr.html#cb427-4" tabindex="-1"></a><span class="do">##       n n_hwy avg_hwy</span></span>
<span id="cb427-5"><a href="chapter-dplyr.html#cb427-5" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb427-6"><a href="chapter-dplyr.html#cb427-6" tabindex="-1"></a><span class="do">## 1   234    27    23.4</span></span></code></pre></div>
<p><code>dplyr 1.0.0</code> 버전부터 길이가 2 이상이 되는 벡터를 결과로 출력하는 함수도 사용할 수 있는데, 이 경우 길이가 1인 요약통계량의 값이 함께 있다면 반복이 되어서 길이를 맞춘다.
이 기능이 편리함도 있지만 예상하지 못한 오류의 발생 가능성이 있어서, <code>dplyr 1.1.0</code> 버전부터는 경고 문구가 출력되며 함수 <code>reframe()</code> 대신 사용할 것으로 권유하고 있다.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="chapter-dplyr.html#cb428-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> </span>
<span id="cb428-2"><a href="chapter-dplyr.html#cb428-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_hwy =</span> <span class="fu">mean</span>(hwy), <span class="at">rng_hwy =</span> <span class="fu">range</span>(hwy))</span>
<span id="cb428-3"><a href="chapter-dplyr.html#cb428-3" tabindex="-1"></a><span class="do">## Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in dplyr 1.1.0.</span></span>
<span id="cb428-4"><a href="chapter-dplyr.html#cb428-4" tabindex="-1"></a><span class="do">## ℹ Please use `reframe()` instead.</span></span>
<span id="cb428-5"><a href="chapter-dplyr.html#cb428-5" tabindex="-1"></a><span class="do">## ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()` always returns an ungrouped data frame and adjust</span></span>
<span id="cb428-6"><a href="chapter-dplyr.html#cb428-6" tabindex="-1"></a><span class="do">##   accordingly.</span></span>
<span id="cb428-7"><a href="chapter-dplyr.html#cb428-7" tabindex="-1"></a><span class="do">## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span>
<span id="cb428-8"><a href="chapter-dplyr.html#cb428-8" tabindex="-1"></a><span class="do">## # A tibble: 2 × 2</span></span>
<span id="cb428-9"><a href="chapter-dplyr.html#cb428-9" tabindex="-1"></a><span class="do">##   avg_hwy rng_hwy</span></span>
<span id="cb428-10"><a href="chapter-dplyr.html#cb428-10" tabindex="-1"></a><span class="do">##     &lt;dbl&gt;   &lt;int&gt;</span></span>
<span id="cb428-11"><a href="chapter-dplyr.html#cb428-11" tabindex="-1"></a><span class="do">## 1    23.4      12</span></span>
<span id="cb428-12"><a href="chapter-dplyr.html#cb428-12" tabindex="-1"></a><span class="do">## 2    23.4      44</span></span></code></pre></div>
<p>함수 <code>reframe()</code>을 사용해서 작업해 보자.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="chapter-dplyr.html#cb429-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> </span>
<span id="cb429-2"><a href="chapter-dplyr.html#cb429-2" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">avg_hwy =</span> <span class="fu">mean</span>(hwy), <span class="at">rng_hwy =</span> <span class="fu">range</span>(hwy))</span>
<span id="cb429-3"><a href="chapter-dplyr.html#cb429-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 2</span></span>
<span id="cb429-4"><a href="chapter-dplyr.html#cb429-4" tabindex="-1"></a><span class="do">##   avg_hwy rng_hwy</span></span>
<span id="cb429-5"><a href="chapter-dplyr.html#cb429-5" tabindex="-1"></a><span class="do">##     &lt;dbl&gt;   &lt;int&gt;</span></span>
<span id="cb429-6"><a href="chapter-dplyr.html#cb429-6" tabindex="-1"></a><span class="do">## 1    23.4      12</span></span>
<span id="cb429-7"><a href="chapter-dplyr.html#cb429-7" tabindex="-1"></a><span class="do">## 2    23.4      44</span></span></code></pre></div>
<p>길이가 서로 다른 벡터로는 데이터 프레임을 구성할 수 없다. 다만 예외적으로 길이가 1인 벡터에게만 반복을 허용하는 것이다. 따라서 평균값과 범위(최소, 최대), 그리고 사분위수(0.25분위수, 0.5분위수, 0.75분위수)를 함께 나타내려는 다음 시도는 잘못된 것이다.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="chapter-dplyr.html#cb430-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> </span>
<span id="cb430-2"><a href="chapter-dplyr.html#cb430-2" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">avg_hwy =</span> <span class="fu">mean</span>(hwy), <span class="at">rng_hwy =</span> <span class="fu">range</span>(hwy), </span>
<span id="cb430-3"><a href="chapter-dplyr.html#cb430-3" tabindex="-1"></a>          <span class="at">q_hwy =</span> <span class="fu">quantile</span>(hwy, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>)))</span>
<span id="cb430-4"><a href="chapter-dplyr.html#cb430-4" tabindex="-1"></a><span class="do">## Error in `reframe()`:</span></span>
<span id="cb430-5"><a href="chapter-dplyr.html#cb430-5" tabindex="-1"></a><span class="do">## ! Can&#39;t recycle `q_hwy = quantile(hwy, probs = c(0.25, 0.5, 0.75))`.</span></span>
<span id="cb430-6"><a href="chapter-dplyr.html#cb430-6" tabindex="-1"></a><span class="do">## Caused by error:</span></span>
<span id="cb430-7"><a href="chapter-dplyr.html#cb430-7" tabindex="-1"></a><span class="do">## ! `q_hwy` must be size 2 or 1, not 3.</span></span>
<span id="cb430-8"><a href="chapter-dplyr.html#cb430-8" tabindex="-1"></a><span class="do">## ℹ An earlier column had size 2.</span></span></code></pre></div>
<p>함수 <code>summarise()</code>는 사실 그 자체만으로는 그렇게 특별히 유용한 함수라고 하기 어렵다. 그러나 전체 데이터를 몇 개의 그룹으로 구분하는 함수 <code>group_by()</code>와 함께 사용하면 매우 강력한 분석 도구가 된다.</p>
</div>
<div id="그룹-데이터-프레임" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> 그룹 데이터 프레임<a href="chapter-dplyr.html#그룹-데이터-프레임" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>dplyr</code> 기본 함수들은 그룹으로 구분된 데이터 프레임을 대상으로 작업할 때 더욱 강력한 위력을 발휘할 수 있다. 이 절에서는 함수 <code>group_by()</code>를 사용하여 그룹 데이터 프레임을 생성하는 방법과 <code>dplyr</code> 기본 함수들이 그룹 데이터 프레임에서는 어떤 방식으로 작동되는지에 대해 살펴보도록 하자.</p>
<div id="그룹-데이터-프레임의-생성-group_by" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> 그룹 데이터 프레임의 생성: <code>group_by()</code><a href="chapter-dplyr.html#그룹-데이터-프레임의-생성-group_by" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>함수 <code>group_by()</code>는 한 개 이상의 변수를 이용하여 전체 데이터를 그룹으로 구분하는 기능을 갖고 있다. 첫 번째 입력요소는 데이터 프레임이고, 이어서 그룹을 구분하는 데 사용될 변수를 나열하면 된다. 실행결과는 tibble이며, 실행 전의 tibble과 출력된 형태에서는 큰 차이를 볼 수 없으나 <code>grouped_df</code>라는 class 속성이 추가된 tibble이 된다.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="chapter-dplyr.html#cb431-1" tabindex="-1"></a>by_cyl <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span>  </span>
<span id="cb431-2"><a href="chapter-dplyr.html#cb431-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">|&gt;</span>  </span>
<span id="cb431-3"><a href="chapter-dplyr.html#cb431-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb431-4"><a href="chapter-dplyr.html#cb431-4" tabindex="-1"></a><span class="do">## # A tibble: 234 × 11</span></span>
<span id="cb431-5"><a href="chapter-dplyr.html#cb431-5" tabindex="-1"></a><span class="do">## # Groups:   cyl [4]</span></span>
<span id="cb431-6"><a href="chapter-dplyr.html#cb431-6" tabindex="-1"></a><span class="do">##   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class </span></span>
<span id="cb431-7"><a href="chapter-dplyr.html#cb431-7" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; </span></span>
<span id="cb431-8"><a href="chapter-dplyr.html#cb431-8" tabindex="-1"></a><span class="do">## 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…</span></span>
<span id="cb431-9"><a href="chapter-dplyr.html#cb431-9" tabindex="-1"></a><span class="do">## 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…</span></span>
<span id="cb431-10"><a href="chapter-dplyr.html#cb431-10" tabindex="-1"></a><span class="do">## 3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…</span></span>
<span id="cb431-11"><a href="chapter-dplyr.html#cb431-11" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="chapter-dplyr.html#cb432-1" tabindex="-1"></a>by_cyl_drv <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span> </span>
<span id="cb432-2"><a href="chapter-dplyr.html#cb432-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl, drv) <span class="sc">|&gt;</span> </span>
<span id="cb432-3"><a href="chapter-dplyr.html#cb432-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb432-4"><a href="chapter-dplyr.html#cb432-4" tabindex="-1"></a><span class="do">## # A tibble: 234 × 11</span></span>
<span id="cb432-5"><a href="chapter-dplyr.html#cb432-5" tabindex="-1"></a><span class="do">## # Groups:   cyl, drv [9]</span></span>
<span id="cb432-6"><a href="chapter-dplyr.html#cb432-6" tabindex="-1"></a><span class="do">##   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class </span></span>
<span id="cb432-7"><a href="chapter-dplyr.html#cb432-7" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; </span></span>
<span id="cb432-8"><a href="chapter-dplyr.html#cb432-8" tabindex="-1"></a><span class="do">## 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…</span></span>
<span id="cb432-9"><a href="chapter-dplyr.html#cb432-9" tabindex="-1"></a><span class="do">## 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…</span></span>
<span id="cb432-10"><a href="chapter-dplyr.html#cb432-10" tabindex="-1"></a><span class="do">## 3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…</span></span>
<span id="cb432-11"><a href="chapter-dplyr.html#cb432-11" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<p>그룹 데이터 프레임 <code>by_cyl</code>를 출력해 보면 <code>Groups: cyl [4]</code>라는 결과가 나타나는데, 이것은 변수 <code>cyl</code>에 의해 4개 그룹이 구성되었다는 것을 의미한다. 또한 <code>by_cyl_drv</code>의 경우에는 <code>cyl</code>과 <code>drv</code>의 조합으로 9개 그룹이 생성되었다는 것을 알 수 있다.</p>
<ul>
<li>그룹별 자료 개수 확인</li>
</ul>
<p>각 그룹에 속한 자료의 개수는 함수 <code>tally()</code> 또는 <code>count()</code>를 사용하면 알 수 있다. 함수 <code>tally()</code>는 그룹 변수 지정 기능이 없어서 그룹 데이터 프레임을 입력하면 각 그룹별 자료의 개수를 출력하지만, 일반 데이터 프레임을 입력하면 전체 자료 개수를 출력한다.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="chapter-dplyr.html#cb433-1" tabindex="-1"></a>by_cyl <span class="sc">|&gt;</span> <span class="fu">tally</span>()</span>
<span id="cb433-2"><a href="chapter-dplyr.html#cb433-2" tabindex="-1"></a><span class="do">## # A tibble: 4 × 2</span></span>
<span id="cb433-3"><a href="chapter-dplyr.html#cb433-3" tabindex="-1"></a><span class="do">##     cyl     n</span></span>
<span id="cb433-4"><a href="chapter-dplyr.html#cb433-4" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb433-5"><a href="chapter-dplyr.html#cb433-5" tabindex="-1"></a><span class="do">## 1     4    81</span></span>
<span id="cb433-6"><a href="chapter-dplyr.html#cb433-6" tabindex="-1"></a><span class="do">## 2     5     4</span></span>
<span id="cb433-7"><a href="chapter-dplyr.html#cb433-7" tabindex="-1"></a><span class="do">## 3     6    79</span></span>
<span id="cb433-8"><a href="chapter-dplyr.html#cb433-8" tabindex="-1"></a><span class="do">## 4     8    70</span></span></code></pre></div>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="chapter-dplyr.html#cb434-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">tally</span>()</span>
<span id="cb434-2"><a href="chapter-dplyr.html#cb434-2" tabindex="-1"></a><span class="do">## # A tibble: 1 × 1</span></span>
<span id="cb434-3"><a href="chapter-dplyr.html#cb434-3" tabindex="-1"></a><span class="do">##       n</span></span>
<span id="cb434-4"><a href="chapter-dplyr.html#cb434-4" tabindex="-1"></a><span class="do">##   &lt;int&gt;</span></span>
<span id="cb434-5"><a href="chapter-dplyr.html#cb434-5" tabindex="-1"></a><span class="do">## 1   234</span></span></code></pre></div>
<p>반면에 함수 <code>count()</code>는 그룹 변수를 지정해서, 각 그룹별 자료의 개수를 계산할 수 있다.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="chapter-dplyr.html#cb435-1" tabindex="-1"></a>by_cyl <span class="sc">|&gt;</span> <span class="fu">count</span>()</span>
<span id="cb435-2"><a href="chapter-dplyr.html#cb435-2" tabindex="-1"></a><span class="do">## # A tibble: 4 × 2</span></span>
<span id="cb435-3"><a href="chapter-dplyr.html#cb435-3" tabindex="-1"></a><span class="do">## # Groups:   cyl [4]</span></span>
<span id="cb435-4"><a href="chapter-dplyr.html#cb435-4" tabindex="-1"></a><span class="do">##     cyl     n</span></span>
<span id="cb435-5"><a href="chapter-dplyr.html#cb435-5" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb435-6"><a href="chapter-dplyr.html#cb435-6" tabindex="-1"></a><span class="do">## 1     4    81</span></span>
<span id="cb435-7"><a href="chapter-dplyr.html#cb435-7" tabindex="-1"></a><span class="do">## 2     5     4</span></span>
<span id="cb435-8"><a href="chapter-dplyr.html#cb435-8" tabindex="-1"></a><span class="do">## 3     6    79</span></span>
<span id="cb435-9"><a href="chapter-dplyr.html#cb435-9" tabindex="-1"></a><span class="do">## 4     8    70</span></span></code></pre></div>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="chapter-dplyr.html#cb436-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">count</span>(cyl)</span>
<span id="cb436-2"><a href="chapter-dplyr.html#cb436-2" tabindex="-1"></a><span class="do">## # A tibble: 4 × 2</span></span>
<span id="cb436-3"><a href="chapter-dplyr.html#cb436-3" tabindex="-1"></a><span class="do">##     cyl     n</span></span>
<span id="cb436-4"><a href="chapter-dplyr.html#cb436-4" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb436-5"><a href="chapter-dplyr.html#cb436-5" tabindex="-1"></a><span class="do">## 1     4    81</span></span>
<span id="cb436-6"><a href="chapter-dplyr.html#cb436-6" tabindex="-1"></a><span class="do">## 2     5     4</span></span>
<span id="cb436-7"><a href="chapter-dplyr.html#cb436-7" tabindex="-1"></a><span class="do">## 3     6    79</span></span>
<span id="cb436-8"><a href="chapter-dplyr.html#cb436-8" tabindex="-1"></a><span class="do">## 4     8    70</span></span></code></pre></div>
<ul>
<li>그룹 변수의 변경</li>
</ul>
<p>기존의 그룹 데이터 프레임에 그룹을 구성하는 변수를 추가해서 더 세분화된 그룹을 구성할 수 있다. 변수 <code>cyl</code>로 구성된 그룹 데이터 프레임에 <code>drv</code>로 생성되는 그룹을 추가하기 위해서는 옵션 <code>.add=TRUE</code>를 지정해야 한다.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="chapter-dplyr.html#cb437-1" tabindex="-1"></a>by_cyl <span class="sc">|&gt;</span> </span>
<span id="cb437-2"><a href="chapter-dplyr.html#cb437-2" tabindex="-1"></a>  <span class="fu">group_by</span>(drv, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb437-3"><a href="chapter-dplyr.html#cb437-3" tabindex="-1"></a>  <span class="fu">tally</span>()</span>
<span id="cb437-4"><a href="chapter-dplyr.html#cb437-4" tabindex="-1"></a><span class="do">## # A tibble: 9 × 3</span></span>
<span id="cb437-5"><a href="chapter-dplyr.html#cb437-5" tabindex="-1"></a><span class="do">## # Groups:   cyl [4]</span></span>
<span id="cb437-6"><a href="chapter-dplyr.html#cb437-6" tabindex="-1"></a><span class="do">##     cyl drv       n</span></span>
<span id="cb437-7"><a href="chapter-dplyr.html#cb437-7" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb437-8"><a href="chapter-dplyr.html#cb437-8" tabindex="-1"></a><span class="do">## 1     4 4        23</span></span>
<span id="cb437-9"><a href="chapter-dplyr.html#cb437-9" tabindex="-1"></a><span class="do">## 2     4 f        58</span></span>
<span id="cb437-10"><a href="chapter-dplyr.html#cb437-10" tabindex="-1"></a><span class="do">## 3     5 f         4</span></span>
<span id="cb437-11"><a href="chapter-dplyr.html#cb437-11" tabindex="-1"></a><span class="do">## 4     6 4        32</span></span>
<span id="cb437-12"><a href="chapter-dplyr.html#cb437-12" tabindex="-1"></a><span class="do">## 5     6 f        43</span></span>
<span id="cb437-13"><a href="chapter-dplyr.html#cb437-13" tabindex="-1"></a><span class="do">## 6     6 r         4</span></span>
<span id="cb437-14"><a href="chapter-dplyr.html#cb437-14" tabindex="-1"></a><span class="do">## 7     8 4        48</span></span>
<span id="cb437-15"><a href="chapter-dplyr.html#cb437-15" tabindex="-1"></a><span class="do">## 8     8 f         1</span></span>
<span id="cb437-16"><a href="chapter-dplyr.html#cb437-16" tabindex="-1"></a><span class="do">## 9     8 r        21</span></span></code></pre></div>
<p>옵션 <code>.add=TRUE</code>를 추가하지 않으면 기존의 그룹 변수가 새로운 그룹 변수로 대체된다.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="chapter-dplyr.html#cb438-1" tabindex="-1"></a>by_cyl <span class="sc">|&gt;</span> </span>
<span id="cb438-2"><a href="chapter-dplyr.html#cb438-2" tabindex="-1"></a>  <span class="fu">group_by</span>(drv) <span class="sc">|&gt;</span> </span>
<span id="cb438-3"><a href="chapter-dplyr.html#cb438-3" tabindex="-1"></a>  <span class="fu">tally</span>()</span>
<span id="cb438-4"><a href="chapter-dplyr.html#cb438-4" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb438-5"><a href="chapter-dplyr.html#cb438-5" tabindex="-1"></a><span class="do">##   drv       n</span></span>
<span id="cb438-6"><a href="chapter-dplyr.html#cb438-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb438-7"><a href="chapter-dplyr.html#cb438-7" tabindex="-1"></a><span class="do">## 1 4       103</span></span>
<span id="cb438-8"><a href="chapter-dplyr.html#cb438-8" tabindex="-1"></a><span class="do">## 2 f       106</span></span>
<span id="cb438-9"><a href="chapter-dplyr.html#cb438-9" tabindex="-1"></a><span class="do">## 3 r        25</span></span></code></pre></div>
<p>함수 <code>group_by()</code>로 구성된 그룹은 함수 <code>ungroup()</code>으로 해체할 수 있다.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="chapter-dplyr.html#cb439-1" tabindex="-1"></a>by_cyl <span class="sc">|&gt;</span> </span>
<span id="cb439-2"><a href="chapter-dplyr.html#cb439-2" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb439-3"><a href="chapter-dplyr.html#cb439-3" tabindex="-1"></a>  <span class="fu">tally</span>()</span>
<span id="cb439-4"><a href="chapter-dplyr.html#cb439-4" tabindex="-1"></a><span class="do">## # A tibble: 1 × 1</span></span>
<span id="cb439-5"><a href="chapter-dplyr.html#cb439-5" tabindex="-1"></a><span class="do">##       n</span></span>
<span id="cb439-6"><a href="chapter-dplyr.html#cb439-6" tabindex="-1"></a><span class="do">##   &lt;int&gt;</span></span>
<span id="cb439-7"><a href="chapter-dplyr.html#cb439-7" tabindex="-1"></a><span class="do">## 1   234</span></span></code></pre></div>
</div>
<div id="그룹-데이터-프레임에서-기본-함수들의-작동-방식" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> 그룹 데이터 프레임에서 기본 함수들의 작동 방식<a href="chapter-dplyr.html#그룹-데이터-프레임에서-기본-함수들의-작동-방식" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>지금부터는 그룹 데이터 프레임에서 dplyr 기본 함수들의 작동 방식을 예제를 통해서 살펴보자.</p>
<ul>
<li>함수 <code>summarise()</code></li>
</ul>
<p>그룹 데이터 프레임에 대해서는 각 그룹별 요약 통계량을 계산한다. 예제로 데이터 프레임 <code>airquality</code>를 대상으로 다음의 문제를 해결해 보자.</p>
<ol style="list-style-type: decimal">
<li><p>변수 <code>Ozone</code>의 월별 평균값</p></li>
<li><p>월별로 변수 <code>Ozone</code>의 결측값이 있는 날수와 실제 관측된 날수</p></li>
<li><p>월별로 첫날과 마지막 날의 변수 <code>Ozone</code>의 값</p></li>
<li><p>월별로 변수 <code>Ozone</code>의 가장 작은 값과 가장 큰 값</p></li>
<li><p>월별로 변수 <code>Ozone</code>의 개별 값이 전체 기간 동안의 평균값보다 작은 날수</p></li>
</ol>
<p>다섯 문제 모두 월별로 구분된 데이터 프레임이 필요하기 때문에 변수 <code>Month</code>로 그룹을 구성한 데이터 프레임을 만들어야 한다.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="chapter-dplyr.html#cb440-1" tabindex="-1"></a>airs_M <span class="ot">&lt;-</span> airquality <span class="sc">|&gt;</span>  </span>
<span id="cb440-2"><a href="chapter-dplyr.html#cb440-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Month)</span></code></pre></div>
<p>변수 <code>Ozone</code>에는 많은 수의 결측값이 있다. 따라서 함수 <code>mean()</code>에는 반드시 옵션 <code>na.rm = TRUE</code>를 함께 입력해야 결측값을 제외한 평균값이 계산된다.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="chapter-dplyr.html#cb441-1" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb441-2"><a href="chapter-dplyr.html#cb441-2" tabindex="-1"></a>airs_M <span class="sc">|&gt;</span>  </span>
<span id="cb441-3"><a href="chapter-dplyr.html#cb441-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_OZ =</span> <span class="fu">mean</span>(Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb441-4"><a href="chapter-dplyr.html#cb441-4" tabindex="-1"></a><span class="do">## # A tibble: 5 × 2</span></span>
<span id="cb441-5"><a href="chapter-dplyr.html#cb441-5" tabindex="-1"></a><span class="do">##   Month avg_OZ</span></span>
<span id="cb441-6"><a href="chapter-dplyr.html#cb441-6" tabindex="-1"></a><span class="do">##   &lt;int&gt;  &lt;dbl&gt;</span></span>
<span id="cb441-7"><a href="chapter-dplyr.html#cb441-7" tabindex="-1"></a><span class="do">## 1     5   23.6</span></span>
<span id="cb441-8"><a href="chapter-dplyr.html#cb441-8" tabindex="-1"></a><span class="do">## 2     6   29.4</span></span>
<span id="cb441-9"><a href="chapter-dplyr.html#cb441-9" tabindex="-1"></a><span class="do">## 3     7   59.1</span></span>
<span id="cb441-10"><a href="chapter-dplyr.html#cb441-10" tabindex="-1"></a><span class="do">## 4     8   60.0</span></span>
<span id="cb441-11"><a href="chapter-dplyr.html#cb441-11" tabindex="-1"></a><span class="do">## 5     9   31.4</span></span></code></pre></div>
<p>결측값이 있는 날수는 함수 <code>is.na()</code>로 생성된 논리형 벡터를 함수 <code>sum()</code>에 입력하여 <code>TRUE</code>의 개수를 세면 알 수 있다. 또한 실제 관측이 있던 날수는 결측값이 아닌 날수이므로 함수 <code>is.na()</code>의 결과를 반대로 바꿔주고 함수 <code>sum()</code>에 입력하면 된다.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="chapter-dplyr.html#cb442-1" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb442-2"><a href="chapter-dplyr.html#cb442-2" tabindex="-1"></a>airs_M <span class="sc">|&gt;</span> </span>
<span id="cb442-3"><a href="chapter-dplyr.html#cb442-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_miss =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(Ozone)), </span>
<span id="cb442-4"><a href="chapter-dplyr.html#cb442-4" tabindex="-1"></a>            <span class="at">n_obs =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Ozone)))</span>
<span id="cb442-5"><a href="chapter-dplyr.html#cb442-5" tabindex="-1"></a><span class="do">## # A tibble: 5 × 3</span></span>
<span id="cb442-6"><a href="chapter-dplyr.html#cb442-6" tabindex="-1"></a><span class="do">##   Month n_miss n_obs</span></span>
<span id="cb442-7"><a href="chapter-dplyr.html#cb442-7" tabindex="-1"></a><span class="do">##   &lt;int&gt;  &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb442-8"><a href="chapter-dplyr.html#cb442-8" tabindex="-1"></a><span class="do">## 1     5      5    26</span></span>
<span id="cb442-9"><a href="chapter-dplyr.html#cb442-9" tabindex="-1"></a><span class="do">## 2     6     21     9</span></span>
<span id="cb442-10"><a href="chapter-dplyr.html#cb442-10" tabindex="-1"></a><span class="do">## 3     7      5    26</span></span>
<span id="cb442-11"><a href="chapter-dplyr.html#cb442-11" tabindex="-1"></a><span class="do">## 4     8      5    26</span></span>
<span id="cb442-12"><a href="chapter-dplyr.html#cb442-12" tabindex="-1"></a><span class="do">## 5     9      1    29</span></span></code></pre></div>
<p>월별 첫날과 마지막날의 변수 <code>Ozone</code> 값을 출력하기 위해서는 함수 <code>first()</code>와 <code>last()</code>를 이용해야 한다. 벡터 <code>x</code>에 대해서 <code>first(x)</code>와 <code>last(x)</code>는 각각 <code>x[1]</code>과 <code>x[length(x)]</code>의 결과가 출력된다. 유사한 기능을 가진 함수로 <code>nth()</code>가 있다. 벡터 <code>x</code>에 대해서 <code>nth(x, 2)</code>는 <code>x[2]</code>의 결과가 출력되며, <code>nth(x, -2)</code>는 끝에서 두 번째 자료인 <code>x[length(x)-1]</code>이 출력된다.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="chapter-dplyr.html#cb443-1" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb443-2"><a href="chapter-dplyr.html#cb443-2" tabindex="-1"></a>airs_M <span class="sc">|&gt;</span>  </span>
<span id="cb443-3"><a href="chapter-dplyr.html#cb443-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">first_Oz =</span> <span class="fu">first</span>(Ozone), </span>
<span id="cb443-4"><a href="chapter-dplyr.html#cb443-4" tabindex="-1"></a>            <span class="at">last_Oz =</span> <span class="fu">last</span>(Ozone))</span>
<span id="cb443-5"><a href="chapter-dplyr.html#cb443-5" tabindex="-1"></a><span class="do">## # A tibble: 5 × 3</span></span>
<span id="cb443-6"><a href="chapter-dplyr.html#cb443-6" tabindex="-1"></a><span class="do">##   Month first_Oz last_Oz</span></span>
<span id="cb443-7"><a href="chapter-dplyr.html#cb443-7" tabindex="-1"></a><span class="do">##   &lt;int&gt;    &lt;int&gt;   &lt;int&gt;</span></span>
<span id="cb443-8"><a href="chapter-dplyr.html#cb443-8" tabindex="-1"></a><span class="do">## 1     5       41      37</span></span>
<span id="cb443-9"><a href="chapter-dplyr.html#cb443-9" tabindex="-1"></a><span class="do">## 2     6       NA      NA</span></span>
<span id="cb443-10"><a href="chapter-dplyr.html#cb443-10" tabindex="-1"></a><span class="do">## 3     7      135      59</span></span>
<span id="cb443-11"><a href="chapter-dplyr.html#cb443-11" tabindex="-1"></a><span class="do">## 4     8       39      85</span></span>
<span id="cb443-12"><a href="chapter-dplyr.html#cb443-12" tabindex="-1"></a><span class="do">## 5     9       96      20</span></span></code></pre></div>
<p>함수 <code>max()</code>와 <code>min()</code>도 옵션 <code>na.rm = TRUE</code>을 입력해야 결측값을 제외하고 가장 큰 값과 가장 작은 값을 구한다.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="chapter-dplyr.html#cb444-1" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb444-2"><a href="chapter-dplyr.html#cb444-2" tabindex="-1"></a>airs_M <span class="sc">|&gt;</span>  </span>
<span id="cb444-3"><a href="chapter-dplyr.html#cb444-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_Oz =</span> <span class="fu">max</span>(Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb444-4"><a href="chapter-dplyr.html#cb444-4" tabindex="-1"></a>            <span class="at">min_Oz =</span> <span class="fu">min</span>(Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb444-5"><a href="chapter-dplyr.html#cb444-5" tabindex="-1"></a><span class="do">## # A tibble: 5 × 3</span></span>
<span id="cb444-6"><a href="chapter-dplyr.html#cb444-6" tabindex="-1"></a><span class="do">##   Month max_Oz min_Oz</span></span>
<span id="cb444-7"><a href="chapter-dplyr.html#cb444-7" tabindex="-1"></a><span class="do">##   &lt;int&gt;  &lt;int&gt;  &lt;int&gt;</span></span>
<span id="cb444-8"><a href="chapter-dplyr.html#cb444-8" tabindex="-1"></a><span class="do">## 1     5    115      1</span></span>
<span id="cb444-9"><a href="chapter-dplyr.html#cb444-9" tabindex="-1"></a><span class="do">## 2     6     71     12</span></span>
<span id="cb444-10"><a href="chapter-dplyr.html#cb444-10" tabindex="-1"></a><span class="do">## 3     7    135      7</span></span>
<span id="cb444-11"><a href="chapter-dplyr.html#cb444-11" tabindex="-1"></a><span class="do">## 4     8    168      9</span></span>
<span id="cb444-12"><a href="chapter-dplyr.html#cb444-12" tabindex="-1"></a><span class="do">## 5     9     96      7</span></span></code></pre></div>
<p>월별로 변수 <code>Ozone</code>의 개별 값이 전체 기간 동안의 평균값보다 작은 날수를 세어보자. 전체 기간 동안의 평균값은 따로 계산해서 사용하는 것이 더 편리하다.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="chapter-dplyr.html#cb445-1" tabindex="-1"></a><span class="co"># 5</span></span>
<span id="cb445-2"><a href="chapter-dplyr.html#cb445-2" tabindex="-1"></a>m_Oz <span class="ot">&lt;-</span> <span class="fu">mean</span>(airquality<span class="sc">$</span>Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="chapter-dplyr.html#cb446-1" tabindex="-1"></a>airs_M <span class="sc">|&gt;</span>  </span>
<span id="cb446-2"><a href="chapter-dplyr.html#cb446-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">low_Oz =</span> <span class="fu">sum</span>(Ozone <span class="sc">&lt;</span> m_Oz, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb446-3"><a href="chapter-dplyr.html#cb446-3" tabindex="-1"></a><span class="do">## # A tibble: 5 × 2</span></span>
<span id="cb446-4"><a href="chapter-dplyr.html#cb446-4" tabindex="-1"></a><span class="do">##   Month low_Oz</span></span>
<span id="cb446-5"><a href="chapter-dplyr.html#cb446-5" tabindex="-1"></a><span class="do">##   &lt;int&gt;  &lt;int&gt;</span></span>
<span id="cb446-6"><a href="chapter-dplyr.html#cb446-6" tabindex="-1"></a><span class="do">## 1     5     24</span></span>
<span id="cb446-7"><a href="chapter-dplyr.html#cb446-7" tabindex="-1"></a><span class="do">## 2     6      8</span></span>
<span id="cb446-8"><a href="chapter-dplyr.html#cb446-8" tabindex="-1"></a><span class="do">## 3     7      8</span></span>
<span id="cb446-9"><a href="chapter-dplyr.html#cb446-9" tabindex="-1"></a><span class="do">## 4     8     10</span></span>
<span id="cb446-10"><a href="chapter-dplyr.html#cb446-10" tabindex="-1"></a><span class="do">## 5     9     22</span></span></code></pre></div>
<ul>
<li>함수 <code>select()</code></li>
</ul>
<p>그룹을 구성하고 있는 변수는 선택 대상이 아니어도 항상 포함된다.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="chapter-dplyr.html#cb447-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb447-2"><a href="chapter-dplyr.html#cb447-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">|&gt;</span>   </span>
<span id="cb447-3"><a href="chapter-dplyr.html#cb447-3" tabindex="-1"></a>  <span class="fu">select</span>(hwy) <span class="sc">|&gt;</span> </span>
<span id="cb447-4"><a href="chapter-dplyr.html#cb447-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb447-5"><a href="chapter-dplyr.html#cb447-5" tabindex="-1"></a><span class="do">## # A tibble: 234 × 2</span></span>
<span id="cb447-6"><a href="chapter-dplyr.html#cb447-6" tabindex="-1"></a><span class="do">## # Groups:   cyl [4]</span></span>
<span id="cb447-7"><a href="chapter-dplyr.html#cb447-7" tabindex="-1"></a><span class="do">##     cyl   hwy</span></span>
<span id="cb447-8"><a href="chapter-dplyr.html#cb447-8" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb447-9"><a href="chapter-dplyr.html#cb447-9" tabindex="-1"></a><span class="do">## 1     4    29</span></span>
<span id="cb447-10"><a href="chapter-dplyr.html#cb447-10" tabindex="-1"></a><span class="do">## 2     4    29</span></span>
<span id="cb447-11"><a href="chapter-dplyr.html#cb447-11" tabindex="-1"></a><span class="do">## 3     4    31</span></span>
<span id="cb447-12"><a href="chapter-dplyr.html#cb447-12" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<ul>
<li>함수 <code>arrange()</code></li>
</ul>
<p>옵션 <code>.by_group = TRUE</code>를 추가하면, 그룹 변수가 첫 번째 정렬 변수로 사용된다. 그룹 변수 <code>cyl</code>로 먼저 정렬을 하고 이어서 각 그룹 내에서 <code>hwy</code>에 의해 정렬을 해 보자.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="chapter-dplyr.html#cb448-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb448-2"><a href="chapter-dplyr.html#cb448-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">|&gt;</span>  </span>
<span id="cb448-3"><a href="chapter-dplyr.html#cb448-3" tabindex="-1"></a>  <span class="fu">arrange</span>(hwy, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb448-4"><a href="chapter-dplyr.html#cb448-4" tabindex="-1"></a>  <span class="fu">select</span>(model, hwy)</span>
<span id="cb448-5"><a href="chapter-dplyr.html#cb448-5" tabindex="-1"></a><span class="do">## # A tibble: 234 × 3</span></span>
<span id="cb448-6"><a href="chapter-dplyr.html#cb448-6" tabindex="-1"></a><span class="do">## # Groups:   cyl [4]</span></span>
<span id="cb448-7"><a href="chapter-dplyr.html#cb448-7" tabindex="-1"></a><span class="do">##      cyl model               hwy</span></span>
<span id="cb448-8"><a href="chapter-dplyr.html#cb448-8" tabindex="-1"></a><span class="do">##    &lt;int&gt; &lt;chr&gt;             &lt;int&gt;</span></span>
<span id="cb448-9"><a href="chapter-dplyr.html#cb448-9" tabindex="-1"></a><span class="do">##  1     4 4runner 4wd          20</span></span>
<span id="cb448-10"><a href="chapter-dplyr.html#cb448-10" tabindex="-1"></a><span class="do">##  2     4 4runner 4wd          20</span></span>
<span id="cb448-11"><a href="chapter-dplyr.html#cb448-11" tabindex="-1"></a><span class="do">##  3     4 toyota tacoma 4wd    20</span></span>
<span id="cb448-12"><a href="chapter-dplyr.html#cb448-12" tabindex="-1"></a><span class="do">##  4     4 toyota tacoma 4wd    20</span></span>
<span id="cb448-13"><a href="chapter-dplyr.html#cb448-13" tabindex="-1"></a><span class="do">##  5     4 toyota tacoma 4wd    22</span></span>
<span id="cb448-14"><a href="chapter-dplyr.html#cb448-14" tabindex="-1"></a><span class="do">##  6     4 forester awd         23</span></span>
<span id="cb448-15"><a href="chapter-dplyr.html#cb448-15" tabindex="-1"></a><span class="do">##  7     4 caravan 2wd          24</span></span>
<span id="cb448-16"><a href="chapter-dplyr.html#cb448-16" tabindex="-1"></a><span class="do">##  8     4 forester awd         24</span></span>
<span id="cb448-17"><a href="chapter-dplyr.html#cb448-17" tabindex="-1"></a><span class="do">##  9     4 a4 quattro           25</span></span>
<span id="cb448-18"><a href="chapter-dplyr.html#cb448-18" tabindex="-1"></a><span class="do">## 10     4 forester awd         25</span></span>
<span id="cb448-19"><a href="chapter-dplyr.html#cb448-19" tabindex="-1"></a><span class="do">## # ℹ 224 more rows</span></span></code></pre></div>
<p>옵션 <code>.by_group = TRUE</code>를 추가하지 않으면 <code>hwy</code>에 의한 정렬이 이루어진다.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="chapter-dplyr.html#cb449-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb449-2"><a href="chapter-dplyr.html#cb449-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">|&gt;</span>  </span>
<span id="cb449-3"><a href="chapter-dplyr.html#cb449-3" tabindex="-1"></a>  <span class="fu">arrange</span>(hwy) <span class="sc">|&gt;</span>  </span>
<span id="cb449-4"><a href="chapter-dplyr.html#cb449-4" tabindex="-1"></a>  <span class="fu">select</span>(model, hwy)</span>
<span id="cb449-5"><a href="chapter-dplyr.html#cb449-5" tabindex="-1"></a><span class="do">## # A tibble: 234 × 3</span></span>
<span id="cb449-6"><a href="chapter-dplyr.html#cb449-6" tabindex="-1"></a><span class="do">## # Groups:   cyl [4]</span></span>
<span id="cb449-7"><a href="chapter-dplyr.html#cb449-7" tabindex="-1"></a><span class="do">##      cyl model                 hwy</span></span>
<span id="cb449-8"><a href="chapter-dplyr.html#cb449-8" tabindex="-1"></a><span class="do">##    &lt;int&gt; &lt;chr&gt;               &lt;int&gt;</span></span>
<span id="cb449-9"><a href="chapter-dplyr.html#cb449-9" tabindex="-1"></a><span class="do">##  1     8 dakota pickup 4wd      12</span></span>
<span id="cb449-10"><a href="chapter-dplyr.html#cb449-10" tabindex="-1"></a><span class="do">##  2     8 durango 4wd            12</span></span>
<span id="cb449-11"><a href="chapter-dplyr.html#cb449-11" tabindex="-1"></a><span class="do">##  3     8 ram 1500 pickup 4wd    12</span></span>
<span id="cb449-12"><a href="chapter-dplyr.html#cb449-12" tabindex="-1"></a><span class="do">##  4     8 ram 1500 pickup 4wd    12</span></span>
<span id="cb449-13"><a href="chapter-dplyr.html#cb449-13" tabindex="-1"></a><span class="do">##  5     8 grand cherokee 4wd     12</span></span>
<span id="cb449-14"><a href="chapter-dplyr.html#cb449-14" tabindex="-1"></a><span class="do">##  6     8 k1500 tahoe 4wd        14</span></span>
<span id="cb449-15"><a href="chapter-dplyr.html#cb449-15" tabindex="-1"></a><span class="do">##  7     8 grand cherokee 4wd     14</span></span>
<span id="cb449-16"><a href="chapter-dplyr.html#cb449-16" tabindex="-1"></a><span class="do">##  8     8 c1500 suburban 2wd     15</span></span>
<span id="cb449-17"><a href="chapter-dplyr.html#cb449-17" tabindex="-1"></a><span class="do">##  9     8 k1500 tahoe 4wd        15</span></span>
<span id="cb449-18"><a href="chapter-dplyr.html#cb449-18" tabindex="-1"></a><span class="do">## 10     8 dakota pickup 4wd      15</span></span>
<span id="cb449-19"><a href="chapter-dplyr.html#cb449-19" tabindex="-1"></a><span class="do">## # ℹ 224 more rows</span></span></code></pre></div>
<ul>
<li>함수 <code>mutate()</code>와 <code>transmute()</code></li>
</ul>
<p>그룹 데이터 프레임에서 <code>mean()</code>과 같은 요약통계량 함수나 <code>min_rank()</code>와 같은 순위 계산 함수는 각 그룹별로 그 결과를 계산하기 때문에 이러한 함수를 사용해서 새로운 열을 생성하는 경우에는 그룹이 구성되지 않은 데이터 프레임의 경우와 다른 결과를 생성하게 된다.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="chapter-dplyr.html#cb450-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb450-2"><a href="chapter-dplyr.html#cb450-2" tabindex="-1"></a>  <span class="fu">select</span>(cyl, hwy) <span class="sc">|&gt;</span>  </span>
<span id="cb450-3"><a href="chapter-dplyr.html#cb450-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">std_hwy =</span> hwy <span class="sc">-</span> <span class="fu">mean</span>(hwy), <span class="at">rank =</span> <span class="fu">min_rank</span>(hwy)) <span class="sc">|&gt;</span>  </span>
<span id="cb450-4"><a href="chapter-dplyr.html#cb450-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb450-5"><a href="chapter-dplyr.html#cb450-5" tabindex="-1"></a><span class="do">## # A tibble: 234 × 4</span></span>
<span id="cb450-6"><a href="chapter-dplyr.html#cb450-6" tabindex="-1"></a><span class="do">##     cyl   hwy std_hwy  rank</span></span>
<span id="cb450-7"><a href="chapter-dplyr.html#cb450-7" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb450-8"><a href="chapter-dplyr.html#cb450-8" tabindex="-1"></a><span class="do">## 1     4    29    5.56   187</span></span>
<span id="cb450-9"><a href="chapter-dplyr.html#cb450-9" tabindex="-1"></a><span class="do">## 2     4    29    5.56   187</span></span>
<span id="cb450-10"><a href="chapter-dplyr.html#cb450-10" tabindex="-1"></a><span class="do">## 3     4    31    7.56   213</span></span>
<span id="cb450-11"><a href="chapter-dplyr.html#cb450-11" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="chapter-dplyr.html#cb451-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb451-2"><a href="chapter-dplyr.html#cb451-2" tabindex="-1"></a>  <span class="fu">select</span>(cyl, hwy) <span class="sc">|&gt;</span>  </span>
<span id="cb451-3"><a href="chapter-dplyr.html#cb451-3" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">|&gt;</span>  </span>
<span id="cb451-4"><a href="chapter-dplyr.html#cb451-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">std_hwy =</span> hwy <span class="sc">-</span> <span class="fu">mean</span>(hwy), <span class="at">rank =</span> <span class="fu">min_rank</span>(hwy)) <span class="sc">|&gt;</span>  </span>
<span id="cb451-5"><a href="chapter-dplyr.html#cb451-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb451-6"><a href="chapter-dplyr.html#cb451-6" tabindex="-1"></a><span class="do">## # A tibble: 234 × 4</span></span>
<span id="cb451-7"><a href="chapter-dplyr.html#cb451-7" tabindex="-1"></a><span class="do">## # Groups:   cyl [4]</span></span>
<span id="cb451-8"><a href="chapter-dplyr.html#cb451-8" tabindex="-1"></a><span class="do">##     cyl   hwy std_hwy  rank</span></span>
<span id="cb451-9"><a href="chapter-dplyr.html#cb451-9" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb451-10"><a href="chapter-dplyr.html#cb451-10" tabindex="-1"></a><span class="do">## 1     4    29   0.198    38</span></span>
<span id="cb451-11"><a href="chapter-dplyr.html#cb451-11" tabindex="-1"></a><span class="do">## 2     4    29   0.198    38</span></span>
<span id="cb451-12"><a href="chapter-dplyr.html#cb451-12" tabindex="-1"></a><span class="do">## 3     4    31   2.20     60</span></span>
<span id="cb451-13"><a href="chapter-dplyr.html#cb451-13" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<p>함수 <code>min_rank()</code>는 입력된 벡터의 순위를 계산하는 함수로서 오름차순으로 순위가 계산되며, 크기가 같은 자료들에 대해서는 해당되는 순위 중 가장 작은 순위가 모두에게 부여된다.
내림차순에 의한 순위계산을 하려면 <code>desc()</code>를 함께 사용해야 한다.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="chapter-dplyr.html#cb452-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">30</span>)</span>
<span id="cb452-2"><a href="chapter-dplyr.html#cb452-2" tabindex="-1"></a><span class="fu">min_rank</span>(x)</span>
<span id="cb452-3"><a href="chapter-dplyr.html#cb452-3" tabindex="-1"></a><span class="do">## [1] 1 2 2 4</span></span>
<span id="cb452-4"><a href="chapter-dplyr.html#cb452-4" tabindex="-1"></a><span class="fu">min_rank</span>(<span class="fu">desc</span>(x))</span>
<span id="cb452-5"><a href="chapter-dplyr.html#cb452-5" tabindex="-1"></a><span class="do">## [1] 4 2 2 1</span></span></code></pre></div>
<ul>
<li>함수 <code>filter()</code></li>
</ul>
<p>요약통계량 함수를 사용해서 조건을 설정한다면 각 그룹별로 다른 조건에 의한 행 선택이 이루어진다. 데이터 프레임 <code>mpg</code>에서 <code>cyl</code>의 그룹별로 <code>hwy</code>가 가장 큰 값을 갖는 행을 찾아보자.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="chapter-dplyr.html#cb453-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb453-2"><a href="chapter-dplyr.html#cb453-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">|&gt;</span>   </span>
<span id="cb453-3"><a href="chapter-dplyr.html#cb453-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, hwy) <span class="sc">|&gt;</span>  </span>
<span id="cb453-4"><a href="chapter-dplyr.html#cb453-4" tabindex="-1"></a>  <span class="fu">filter</span>(hwy <span class="sc">==</span> <span class="fu">max</span>(hwy)) <span class="sc">|&gt;</span>  </span>
<span id="cb453-5"><a href="chapter-dplyr.html#cb453-5" tabindex="-1"></a>  <span class="fu">arrange</span>(hwy, <span class="at">.by_group =</span> <span class="cn">TRUE</span>)</span>
<span id="cb453-6"><a href="chapter-dplyr.html#cb453-6" tabindex="-1"></a><span class="do">## # A tibble: 8 × 4</span></span>
<span id="cb453-7"><a href="chapter-dplyr.html#cb453-7" tabindex="-1"></a><span class="do">## # Groups:   cyl [4]</span></span>
<span id="cb453-8"><a href="chapter-dplyr.html#cb453-8" tabindex="-1"></a><span class="do">##     cyl manufacturer model        hwy</span></span>
<span id="cb453-9"><a href="chapter-dplyr.html#cb453-9" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt;</span></span>
<span id="cb453-10"><a href="chapter-dplyr.html#cb453-10" tabindex="-1"></a><span class="do">## 1     4 volkswagen   jetta         44</span></span>
<span id="cb453-11"><a href="chapter-dplyr.html#cb453-11" tabindex="-1"></a><span class="do">## 2     4 volkswagen   new beetle    44</span></span>
<span id="cb453-12"><a href="chapter-dplyr.html#cb453-12" tabindex="-1"></a><span class="do">## 3     5 volkswagen   jetta         29</span></span>
<span id="cb453-13"><a href="chapter-dplyr.html#cb453-13" tabindex="-1"></a><span class="do">## 4     5 volkswagen   jetta         29</span></span>
<span id="cb453-14"><a href="chapter-dplyr.html#cb453-14" tabindex="-1"></a><span class="do">## 5     5 volkswagen   new beetle    29</span></span>
<span id="cb453-15"><a href="chapter-dplyr.html#cb453-15" tabindex="-1"></a><span class="do">## 6     6 chevrolet    malibu        29</span></span>
<span id="cb453-16"><a href="chapter-dplyr.html#cb453-16" tabindex="-1"></a><span class="do">## 7     8 chevrolet    corvette      26</span></span>
<span id="cb453-17"><a href="chapter-dplyr.html#cb453-17" tabindex="-1"></a><span class="do">## 8     8 chevrolet    corvette      26</span></span></code></pre></div>
<ul>
<li>함수 <code>slice()</code></li>
</ul>
<p>그룹별로 각각 행을 선택할 수 있게 된다. 데이터 프레임 <code>airquality</code>에서 변수 <code>Ozone</code>의 매달 첫날과 마지막날, 가장 큰 값과 가장 작은 값을 갖는 행을 다음과 같이 선택할 수 있다.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="chapter-dplyr.html#cb454-1" tabindex="-1"></a>airs_M <span class="ot">&lt;-</span> airquality <span class="sc">|&gt;</span> </span>
<span id="cb454-2"><a href="chapter-dplyr.html#cb454-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Month) <span class="sc">|&gt;</span> </span>
<span id="cb454-3"><a href="chapter-dplyr.html#cb454-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span></code></pre></div>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="chapter-dplyr.html#cb455-1" tabindex="-1"></a>airs_M <span class="sc">|&gt;</span> </span>
<span id="cb455-2"><a href="chapter-dplyr.html#cb455-2" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb455-3"><a href="chapter-dplyr.html#cb455-3" tabindex="-1"></a><span class="do">## # A tibble: 5 × 3</span></span>
<span id="cb455-4"><a href="chapter-dplyr.html#cb455-4" tabindex="-1"></a><span class="do">## # Groups:   Month [5]</span></span>
<span id="cb455-5"><a href="chapter-dplyr.html#cb455-5" tabindex="-1"></a><span class="do">##   Ozone Month   Day</span></span>
<span id="cb455-6"><a href="chapter-dplyr.html#cb455-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb455-7"><a href="chapter-dplyr.html#cb455-7" tabindex="-1"></a><span class="do">## 1    41     5     1</span></span>
<span id="cb455-8"><a href="chapter-dplyr.html#cb455-8" tabindex="-1"></a><span class="do">## 2    NA     6     1</span></span>
<span id="cb455-9"><a href="chapter-dplyr.html#cb455-9" tabindex="-1"></a><span class="do">## 3   135     7     1</span></span>
<span id="cb455-10"><a href="chapter-dplyr.html#cb455-10" tabindex="-1"></a><span class="do">## 4    39     8     1</span></span>
<span id="cb455-11"><a href="chapter-dplyr.html#cb455-11" tabindex="-1"></a><span class="do">## 5    96     9     1</span></span></code></pre></div>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="chapter-dplyr.html#cb456-1" tabindex="-1"></a>airs_M <span class="sc">|&gt;</span> </span>
<span id="cb456-2"><a href="chapter-dplyr.html#cb456-2" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb456-3"><a href="chapter-dplyr.html#cb456-3" tabindex="-1"></a><span class="do">## # A tibble: 5 × 3</span></span>
<span id="cb456-4"><a href="chapter-dplyr.html#cb456-4" tabindex="-1"></a><span class="do">## # Groups:   Month [5]</span></span>
<span id="cb456-5"><a href="chapter-dplyr.html#cb456-5" tabindex="-1"></a><span class="do">##   Ozone Month   Day</span></span>
<span id="cb456-6"><a href="chapter-dplyr.html#cb456-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb456-7"><a href="chapter-dplyr.html#cb456-7" tabindex="-1"></a><span class="do">## 1    37     5    31</span></span>
<span id="cb456-8"><a href="chapter-dplyr.html#cb456-8" tabindex="-1"></a><span class="do">## 2    NA     6    30</span></span>
<span id="cb456-9"><a href="chapter-dplyr.html#cb456-9" tabindex="-1"></a><span class="do">## 3    59     7    31</span></span>
<span id="cb456-10"><a href="chapter-dplyr.html#cb456-10" tabindex="-1"></a><span class="do">## 4    85     8    31</span></span>
<span id="cb456-11"><a href="chapter-dplyr.html#cb456-11" tabindex="-1"></a><span class="do">## 5    20     9    30</span></span></code></pre></div>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="chapter-dplyr.html#cb457-1" tabindex="-1"></a>airs_M <span class="sc">|&gt;</span> </span>
<span id="cb457-2"><a href="chapter-dplyr.html#cb457-2" tabindex="-1"></a>  <span class="fu">slice_min</span>(Ozone, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb457-3"><a href="chapter-dplyr.html#cb457-3" tabindex="-1"></a><span class="do">## # A tibble: 6 × 3</span></span>
<span id="cb457-4"><a href="chapter-dplyr.html#cb457-4" tabindex="-1"></a><span class="do">## # Groups:   Month [5]</span></span>
<span id="cb457-5"><a href="chapter-dplyr.html#cb457-5" tabindex="-1"></a><span class="do">##   Ozone Month   Day</span></span>
<span id="cb457-6"><a href="chapter-dplyr.html#cb457-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb457-7"><a href="chapter-dplyr.html#cb457-7" tabindex="-1"></a><span class="do">## 1     1     5    21</span></span>
<span id="cb457-8"><a href="chapter-dplyr.html#cb457-8" tabindex="-1"></a><span class="do">## 2    12     6    19</span></span>
<span id="cb457-9"><a href="chapter-dplyr.html#cb457-9" tabindex="-1"></a><span class="do">## 3     7     7    15</span></span>
<span id="cb457-10"><a href="chapter-dplyr.html#cb457-10" tabindex="-1"></a><span class="do">## 4     9     8     2</span></span>
<span id="cb457-11"><a href="chapter-dplyr.html#cb457-11" tabindex="-1"></a><span class="do">## 5     9     8    22</span></span>
<span id="cb457-12"><a href="chapter-dplyr.html#cb457-12" tabindex="-1"></a><span class="do">## 6     7     9    24</span></span></code></pre></div>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="chapter-dplyr.html#cb458-1" tabindex="-1"></a>airs_M <span class="sc">|&gt;</span> </span>
<span id="cb458-2"><a href="chapter-dplyr.html#cb458-2" tabindex="-1"></a>  <span class="fu">slice_max</span>(Ozone, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb458-3"><a href="chapter-dplyr.html#cb458-3" tabindex="-1"></a><span class="do">## # A tibble: 5 × 3</span></span>
<span id="cb458-4"><a href="chapter-dplyr.html#cb458-4" tabindex="-1"></a><span class="do">## # Groups:   Month [5]</span></span>
<span id="cb458-5"><a href="chapter-dplyr.html#cb458-5" tabindex="-1"></a><span class="do">##   Ozone Month   Day</span></span>
<span id="cb458-6"><a href="chapter-dplyr.html#cb458-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb458-7"><a href="chapter-dplyr.html#cb458-7" tabindex="-1"></a><span class="do">## 1   115     5    30</span></span>
<span id="cb458-8"><a href="chapter-dplyr.html#cb458-8" tabindex="-1"></a><span class="do">## 2    71     6     9</span></span>
<span id="cb458-9"><a href="chapter-dplyr.html#cb458-9" tabindex="-1"></a><span class="do">## 3   135     7     1</span></span>
<span id="cb458-10"><a href="chapter-dplyr.html#cb458-10" tabindex="-1"></a><span class="do">## 4   168     8    25</span></span>
<span id="cb458-11"><a href="chapter-dplyr.html#cb458-11" tabindex="-1"></a><span class="do">## 5    96     9     1</span></span></code></pre></div>
</div>
</div>
<div id="다수의-열을-대상으로-하는-작업-across" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> 다수의 열을 대상으로 하는 작업: <code>across()</code><a href="chapter-dplyr.html#다수의-열을-대상으로-하는-작업-across" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>함수 <code>summarise()</code> 등에서 여러 열을 대상으로 동일한 작업을 수행해야 하는 경우가 있다. 예를 들어 모든 숫자형 변수의 평균값을 계산해야 하는 경우, 숫자형 변수를 하나하나 <code>mean()</code>에 적용해서 평균값을 계산해야 한다면 무척 번거로운 일이 될 것이다. 이와 같이 여러 열을 대상으로 작업을 해야 하는 경우에는 함수 <code>across()</code>를 활용하는 것이 필수적이다.</p>
<p>함수 <code>across()</code>는 <code>summarise()</code>나 <code>mutate()</code>와 같은 <code>dplyr</code> 기본 함수 안에서 사용하는 것으로서 사용법은 <code>across(.cols = everything(), .fns = NULL, ..., .names = NULL)</code>이다. 첫 번째 입력 요소 <code>.cols</code>에는 <code>&lt;tidy-select&gt;</code> 방식으로 작업 대상이 되는 열을 지정한다. 아무것도 지정하지 않으면 모든 열이 선택되는 것이 디폴트이다. 두 번째 입력 요소 <code>.fns</code>에는 선택된 각각의 열에 적용되는 함수를 지정한다. 적용될 함수는 다음과 같이 3 가지 방법으로 지정할 수 있다.</p>
<ol style="list-style-type: decimal">
<li><p>하나의 함수: 예) <code>mean</code></p></li>
<li><p><code>purrr</code>에서 적용되는 방식의 함수: 예) <code>~ mean(.x, na.rm = TRUE)</code></p></li>
<li><p>여러 함수의 리스트: 예) <code>list(mean = mean, n_miss = ~ sum(is.na(.x)))</code></p></li>
</ol>
<p>하나의 함수만을 다른 부가적인 입력 요소 없이 사용하는 경우에는 함수의 이름만 지정하면 된다. 패키지 <code>purrr</code>은 core tidyverse에 속한 패키지로서 효율적인 프로그래밍 기법을 제공하고 있다. 자세한 소개는 <a href="chapter-programming.html#chapter-programming">7</a>장에서 찾아볼 수 있다. 함수의 기본적인 형식은 항상 물결표(~)로 시작을 하며 한 변수만 적용 대상인 경우에는 점(.) 또는 <code>.x</code>를 개별 열(변수) 대신 사용하면 된다. 여러 함수를 적용해야 하는 경우에는 <code>list()</code> 안에 <code>name = fun</code>의 형식으로 나열해 주면 된다.</p>
<p>마지막 입력 요소 <code>.names</code>는 결과물로 생성되는 열 이름의 작성에 관련된 것이다. 패키지 <code>glue</code>에서 제공하는 방식을 사용하게 되며, 선택된 열을 <code>{col}</code>로, 사용된 함수를 <code>{fn}</code>으로 각각 표시한다. 디폴트는 하나의 함수만이 <code>.fns</code>에 지정되면 <code>{col}</code>, 여러 함수가 리스트로 지정되면 <code>{col}_{fn}</code>이 새로 생성된 열의 이름이 된다.</p>
<ul>
<li>함수 <code>summarise()</code>와 함께 사용</li>
</ul>
<p>예제를 통하여 함수 <code>across()</code>를 <code>summarise()</code>와 함께 사용하면 작업의 효율성을 얼마나 높일 수 있는지 살펴보자. 우선 데이터 프레임 <code>iris</code>에서 모든 숫자형 변수들의 평균값을 구해보자.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="chapter-dplyr.html#cb459-1" tabindex="-1"></a>iris_t <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(iris)</span></code></pre></div>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="chapter-dplyr.html#cb460-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb460-2"><a href="chapter-dplyr.html#cb460-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean))</span>
<span id="cb460-3"><a href="chapter-dplyr.html#cb460-3" tabindex="-1"></a><span class="do">## # A tibble: 1 × 4</span></span>
<span id="cb460-4"><a href="chapter-dplyr.html#cb460-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb460-5"><a href="chapter-dplyr.html#cb460-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb460-6"><a href="chapter-dplyr.html#cb460-6" tabindex="-1"></a><span class="do">## 1         5.84        3.06         3.76        1.20</span></span></code></pre></div>
<p>숫자형 변수에 대해서는 평균을 계산하고 요인에 대해서는 수준의 개수를 구해보자.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="chapter-dplyr.html#cb461-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>    </span>
<span id="cb461-2"><a href="chapter-dplyr.html#cb461-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean), </span>
<span id="cb461-3"><a href="chapter-dplyr.html#cb461-3" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">where</span>(is.factor), nlevels)</span>
<span id="cb461-4"><a href="chapter-dplyr.html#cb461-4" tabindex="-1"></a>            )</span>
<span id="cb461-5"><a href="chapter-dplyr.html#cb461-5" tabindex="-1"></a><span class="do">## # A tibble: 1 × 5</span></span>
<span id="cb461-6"><a href="chapter-dplyr.html#cb461-6" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb461-7"><a href="chapter-dplyr.html#cb461-7" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;   &lt;int&gt;</span></span>
<span id="cb461-8"><a href="chapter-dplyr.html#cb461-8" tabindex="-1"></a><span class="do">## 1         5.84        3.06         3.76        1.20       3</span></span></code></pre></div>
<p>전체 행의 개수와 숫자형 변수의 표준편차를 구해보자.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="chapter-dplyr.html#cb462-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb462-2"><a href="chapter-dplyr.html#cb462-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sd))</span>
<span id="cb462-3"><a href="chapter-dplyr.html#cb462-3" tabindex="-1"></a><span class="do">## # A tibble: 1 × 5</span></span>
<span id="cb462-4"><a href="chapter-dplyr.html#cb462-4" tabindex="-1"></a><span class="do">##       n Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb462-5"><a href="chapter-dplyr.html#cb462-5" tabindex="-1"></a><span class="do">##   &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb462-6"><a href="chapter-dplyr.html#cb462-6" tabindex="-1"></a><span class="do">## 1    NA        0.828       0.436         1.77       0.762</span></span></code></pre></div>
<p>전체 행 개수 <code>n</code>이 150이 아닌 NA가 된 이유는 <code>n</code>이 숫자이기 때문에 <code>across()</code>에 의하여 다른 4개의 열과 더불어 표준편차를 계산하는 열로 선택된 것이고, 숫자 하나에 대해서는 표준편차를 계산할 수 없기 때문이다. 이 문제는 <code>n</code>의 계산을 <code>across()</code> 다음으로 배치하면 해결된다. 이와 같이 <code>across()</code>에서 <code>where(is.numeric)</code>으로 열을 선택하는 경우, 숫자 요약 과정에 대해서는 주의할 필요가 있다.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="chapter-dplyr.html#cb463-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb463-2"><a href="chapter-dplyr.html#cb463-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sd), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb463-3"><a href="chapter-dplyr.html#cb463-3" tabindex="-1"></a><span class="do">## # A tibble: 1 × 5</span></span>
<span id="cb463-4"><a href="chapter-dplyr.html#cb463-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width     n</span></span>
<span id="cb463-5"><a href="chapter-dplyr.html#cb463-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb463-6"><a href="chapter-dplyr.html#cb463-6" tabindex="-1"></a><span class="do">## 1        0.828       0.436         1.77       0.762   150</span></span></code></pre></div>
<p>이름이 <code>Se</code>로 시작하는 변수의 평균과 표준편차를 구해보자.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="chapter-dplyr.html#cb464-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb464-2"><a href="chapter-dplyr.html#cb464-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Se&quot;</span>), <span class="fu">list</span>(<span class="at">M =</span> mean, <span class="at">SD =</span> sd)))</span>
<span id="cb464-3"><a href="chapter-dplyr.html#cb464-3" tabindex="-1"></a><span class="do">## # A tibble: 1 × 4</span></span>
<span id="cb464-4"><a href="chapter-dplyr.html#cb464-4" tabindex="-1"></a><span class="do">##   Sepal.Length_M Sepal.Length_SD Sepal.Width_M Sepal.Width_SD</span></span>
<span id="cb464-5"><a href="chapter-dplyr.html#cb464-5" tabindex="-1"></a><span class="do">##            &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb464-6"><a href="chapter-dplyr.html#cb464-6" tabindex="-1"></a><span class="do">## 1           5.84           0.828          3.06          0.436</span></span></code></pre></div>
<p>결과로 생성되는 열의 이름을 다른 형식으로 바꿔보자.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="chapter-dplyr.html#cb465-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb465-2"><a href="chapter-dplyr.html#cb465-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Se&quot;</span>), <span class="fu">list</span>(<span class="at">M =</span> mean, <span class="at">SD =</span> sd),</span>
<span id="cb465-3"><a href="chapter-dplyr.html#cb465-3" tabindex="-1"></a>                   <span class="at">.names=</span><span class="st">&quot;{fn}_{col}&quot;</span>))</span>
<span id="cb465-4"><a href="chapter-dplyr.html#cb465-4" tabindex="-1"></a><span class="do">## # A tibble: 1 × 4</span></span>
<span id="cb465-5"><a href="chapter-dplyr.html#cb465-5" tabindex="-1"></a><span class="do">##   M_Sepal.Length SD_Sepal.Length M_Sepal.Width SD_Sepal.Width</span></span>
<span id="cb465-6"><a href="chapter-dplyr.html#cb465-6" tabindex="-1"></a><span class="do">##            &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb465-7"><a href="chapter-dplyr.html#cb465-7" tabindex="-1"></a><span class="do">## 1           5.84           0.828          3.06          0.436</span></span></code></pre></div>
<p>각 숫자형 변수들의 결측값 개수를 구해보자.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="chapter-dplyr.html#cb466-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb466-2"><a href="chapter-dplyr.html#cb466-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.x))))</span>
<span id="cb466-3"><a href="chapter-dplyr.html#cb466-3" tabindex="-1"></a><span class="do">## # A tibble: 1 × 4</span></span>
<span id="cb466-4"><a href="chapter-dplyr.html#cb466-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb466-5"><a href="chapter-dplyr.html#cb466-5" tabindex="-1"></a><span class="do">##          &lt;int&gt;       &lt;int&gt;        &lt;int&gt;       &lt;int&gt;</span></span>
<span id="cb466-6"><a href="chapter-dplyr.html#cb466-6" tabindex="-1"></a><span class="do">## 1            0           0            0           0</span></span></code></pre></div>
<p>변수 <code>Species</code>별로 각 숫자형 변수의 자료에서 중복되지 않은 숫자의 개수를 구해보자.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="chapter-dplyr.html#cb467-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span>  </span>
<span id="cb467-2"><a href="chapter-dplyr.html#cb467-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span>  </span>
<span id="cb467-3"><a href="chapter-dplyr.html#cb467-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">length</span>(<span class="fu">unique</span>(.x))))</span>
<span id="cb467-4"><a href="chapter-dplyr.html#cb467-4" tabindex="-1"></a><span class="do">## # A tibble: 3 × 5</span></span>
<span id="cb467-5"><a href="chapter-dplyr.html#cb467-5" tabindex="-1"></a><span class="do">##   Species    Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb467-6"><a href="chapter-dplyr.html#cb467-6" tabindex="-1"></a><span class="do">##   &lt;fct&gt;             &lt;int&gt;       &lt;int&gt;        &lt;int&gt;       &lt;int&gt;</span></span>
<span id="cb467-7"><a href="chapter-dplyr.html#cb467-7" tabindex="-1"></a><span class="do">## 1 setosa               15          16            9           6</span></span>
<span id="cb467-8"><a href="chapter-dplyr.html#cb467-8" tabindex="-1"></a><span class="do">## 2 versicolor           21          14           19           9</span></span>
<span id="cb467-9"><a href="chapter-dplyr.html#cb467-9" tabindex="-1"></a><span class="do">## 3 virginica            21          13           20          12</span></span></code></pre></div>
<p>함수 <code>unique()</code>는 중복되지 않은 자료를 추출하는 기능을 갖고 있어서, 그 결과를 <code>length()</code>에 입력하면 중복되지 않는 숫자의 개수를 계산할 수 있다. 동일한 결과는 함수 <code>n_distinct()</code>를 사용해도 얻을 수 있다.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="chapter-dplyr.html#cb468-1" tabindex="-1"></a>iris <span class="sc">|&gt;</span>  </span>
<span id="cb468-2"><a href="chapter-dplyr.html#cb468-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span>  </span>
<span id="cb468-3"><a href="chapter-dplyr.html#cb468-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), n_distinct))</span>
<span id="cb468-4"><a href="chapter-dplyr.html#cb468-4" tabindex="-1"></a><span class="do">## # A tibble: 3 × 5</span></span>
<span id="cb468-5"><a href="chapter-dplyr.html#cb468-5" tabindex="-1"></a><span class="do">##   Species    Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb468-6"><a href="chapter-dplyr.html#cb468-6" tabindex="-1"></a><span class="do">##   &lt;fct&gt;             &lt;int&gt;       &lt;int&gt;        &lt;int&gt;       &lt;int&gt;</span></span>
<span id="cb468-7"><a href="chapter-dplyr.html#cb468-7" tabindex="-1"></a><span class="do">## 1 setosa               15          16            9           6</span></span>
<span id="cb468-8"><a href="chapter-dplyr.html#cb468-8" tabindex="-1"></a><span class="do">## 2 versicolor           21          14           19           9</span></span>
<span id="cb468-9"><a href="chapter-dplyr.html#cb468-9" tabindex="-1"></a><span class="do">## 3 virginica            21          13           20          12</span></span></code></pre></div>
<p>데이터 프레임 <code>airquality</code>에서 변수 <code>Ozone</code>과 <code>Solar.R</code>의 평균과 표준편차를 구해보자.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="chapter-dplyr.html#cb469-1" tabindex="-1"></a>mean_sd <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb469-2"><a href="chapter-dplyr.html#cb469-2" tabindex="-1"></a>  <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb469-3"><a href="chapter-dplyr.html#cb469-3" tabindex="-1"></a>  <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">sd</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb469-4"><a href="chapter-dplyr.html#cb469-4" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="chapter-dplyr.html#cb470-1" tabindex="-1"></a><span class="fu">as_tibble</span>(airquality) <span class="sc">|&gt;</span> </span>
<span id="cb470-2"><a href="chapter-dplyr.html#cb470-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(Ozone, Solar.R), mean_sd))</span>
<span id="cb470-3"><a href="chapter-dplyr.html#cb470-3" tabindex="-1"></a><span class="do">## # A tibble: 1 × 4</span></span>
<span id="cb470-4"><a href="chapter-dplyr.html#cb470-4" tabindex="-1"></a><span class="do">##   Ozone_mean Ozone_sd Solar.R_mean Solar.R_sd</span></span>
<span id="cb470-5"><a href="chapter-dplyr.html#cb470-5" tabindex="-1"></a><span class="do">##        &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb470-6"><a href="chapter-dplyr.html#cb470-6" tabindex="-1"></a><span class="do">## 1       42.1     33.0         186.       90.1</span></span></code></pre></div>
<ul>
<li>다른 기본 함수와 함께 사용</li>
</ul>
<p>데이터 프레임 <code>iris</code>에서 요인을 문자형 변수로 전환해 보자. 마지막 변수 <code>Species</code>의 유형이 문자형으로 변환되었음을 확인할 수 있다.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="chapter-dplyr.html#cb471-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb471-2"><a href="chapter-dplyr.html#cb471-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.factor), as.character)) <span class="sc">|&gt;</span>  </span>
<span id="cb471-3"><a href="chapter-dplyr.html#cb471-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb471-4"><a href="chapter-dplyr.html#cb471-4" tabindex="-1"></a><span class="do">## # A tibble: 150 × 5</span></span>
<span id="cb471-5"><a href="chapter-dplyr.html#cb471-5" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb471-6"><a href="chapter-dplyr.html#cb471-6" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  </span></span>
<span id="cb471-7"><a href="chapter-dplyr.html#cb471-7" tabindex="-1"></a><span class="do">## 1          5.1         3.5          1.4         0.2 setosa </span></span>
<span id="cb471-8"><a href="chapter-dplyr.html#cb471-8" tabindex="-1"></a><span class="do">## 2          4.9         3            1.4         0.2 setosa </span></span>
<span id="cb471-9"><a href="chapter-dplyr.html#cb471-9" tabindex="-1"></a><span class="do">## 3          4.7         3.2          1.3         0.2 setosa </span></span>
<span id="cb471-10"><a href="chapter-dplyr.html#cb471-10" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span></code></pre></div>
<p>이번에는 센티미터 단위로 측정된 자료를 인치 단위로 변환해 보자.
원자료가 인치 단위로 변환된 자료로 모두 대체가 되었다.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="chapter-dplyr.html#cb472-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb472-2"><a href="chapter-dplyr.html#cb472-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> .x<span class="sc">/</span><span class="fl">2.54</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb472-3"><a href="chapter-dplyr.html#cb472-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">3</span>)</span>
<span id="cb472-4"><a href="chapter-dplyr.html#cb472-4" tabindex="-1"></a><span class="do">## # A tibble: 150 × 5</span></span>
<span id="cb472-5"><a href="chapter-dplyr.html#cb472-5" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb472-6"><a href="chapter-dplyr.html#cb472-6" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span></span>
<span id="cb472-7"><a href="chapter-dplyr.html#cb472-7" tabindex="-1"></a><span class="do">## 1         2.01        1.38        0.551      0.0787 setosa </span></span>
<span id="cb472-8"><a href="chapter-dplyr.html#cb472-8" tabindex="-1"></a><span class="do">## 2         1.93        1.18        0.551      0.0787 setosa </span></span>
<span id="cb472-9"><a href="chapter-dplyr.html#cb472-9" tabindex="-1"></a><span class="do">## 3         1.85        1.26        0.512      0.0787 setosa </span></span>
<span id="cb472-10"><a href="chapter-dplyr.html#cb472-10" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span></code></pre></div>
<p>기존의 자료를 그대로 유지하려면, 옵션 <code>.names</code>에 새롭게 생성된 변수의 이름을 지정하면 된다.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="chapter-dplyr.html#cb473-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb473-2"><a href="chapter-dplyr.html#cb473-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> .x<span class="sc">/</span><span class="fl">2.54</span>,</span>
<span id="cb473-3"><a href="chapter-dplyr.html#cb473-3" tabindex="-1"></a>                <span class="at">.names=</span><span class="st">&quot;{col}_inch&quot;</span>),</span>
<span id="cb473-4"><a href="chapter-dplyr.html#cb473-4" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb473-5"><a href="chapter-dplyr.html#cb473-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb473-6"><a href="chapter-dplyr.html#cb473-6" tabindex="-1"></a><span class="do">## # A tibble: 150 × 9</span></span>
<span id="cb473-7"><a href="chapter-dplyr.html#cb473-7" tabindex="-1"></a><span class="do">##   Sepal.Length_inch Sepal.Width_inch Petal.Length_inch Petal.Width_inch</span></span>
<span id="cb473-8"><a href="chapter-dplyr.html#cb473-8" tabindex="-1"></a><span class="do">##               &lt;dbl&gt;            &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb473-9"><a href="chapter-dplyr.html#cb473-9" tabindex="-1"></a><span class="do">## 1              2.01             1.38             0.551           0.0787</span></span>
<span id="cb473-10"><a href="chapter-dplyr.html#cb473-10" tabindex="-1"></a><span class="do">## 2              1.93             1.18             0.551           0.0787</span></span>
<span id="cb473-11"><a href="chapter-dplyr.html#cb473-11" tabindex="-1"></a><span class="do">## 3              1.85             1.26             0.512           0.0787</span></span>
<span id="cb473-12"><a href="chapter-dplyr.html#cb473-12" tabindex="-1"></a><span class="do">## # ℹ 147 more rows</span></span>
<span id="cb473-13"><a href="chapter-dplyr.html#cb473-13" tabindex="-1"></a><span class="do">## # ℹ 5 more variables: Sepal.Length &lt;dbl&gt;, Sepal.Width &lt;dbl&gt;,</span></span>
<span id="cb473-14"><a href="chapter-dplyr.html#cb473-14" tabindex="-1"></a><span class="do">## #   Petal.Length &lt;dbl&gt;, Petal.Width &lt;dbl&gt;, Species &lt;fct&gt;</span></span></code></pre></div>
<p>이름에 <code>Len</code>이 있는 변수의 자료가 모두 6.5 이상이 되는 행을 선택해 보자.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="chapter-dplyr.html#cb474-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb474-2"><a href="chapter-dplyr.html#cb474-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">&quot;Len&quot;</span>), <span class="sc">~</span> .x <span class="sc">&gt;=</span> <span class="fl">6.5</span>))</span>
<span id="cb474-3"><a href="chapter-dplyr.html#cb474-3" tabindex="-1"></a><span class="do">## # A tibble: 4 × 5</span></span>
<span id="cb474-4"><a href="chapter-dplyr.html#cb474-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species  </span></span>
<span id="cb474-5"><a href="chapter-dplyr.html#cb474-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;    </span></span>
<span id="cb474-6"><a href="chapter-dplyr.html#cb474-6" tabindex="-1"></a><span class="do">## 1          7.6         3            6.6         2.1 virginica</span></span>
<span id="cb474-7"><a href="chapter-dplyr.html#cb474-7" tabindex="-1"></a><span class="do">## 2          7.7         3.8          6.7         2.2 virginica</span></span>
<span id="cb474-8"><a href="chapter-dplyr.html#cb474-8" tabindex="-1"></a><span class="do">## 3          7.7         2.6          6.9         2.3 virginica</span></span>
<span id="cb474-9"><a href="chapter-dplyr.html#cb474-9" tabindex="-1"></a><span class="do">## 4          7.7         2.8          6.7         2   virginica</span></span></code></pre></div>
<p>함수 <code>filter()</code>에는 <code>across()</code> 대신 <code>if_any()</code>나 <code>if_all()</code>의 사용이 권장되고 있다.
두 함수의 사용법은 <code>across()</code>와 동일하며, 논리형 벡터를 출력한다.
<code>if_any()</code>는 <code>TRUE</code>인 경우가 하나만 있어서 <code>TRUE</code>를 출력하고, <code>if_all()</code>은 모두 <code>TRUE</code>가 되어야 <code>TRUE</code>를 출력한다.</p>
<p>이름에 <code>Len</code>이 있는 변수의 자료가 모두 6.5 이상이 되는 행을 선택하는 문제는 <code>if_all()</code>을 사용하면 된다.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="chapter-dplyr.html#cb475-1" tabindex="-1"></a>iris_t <span class="sc">|&gt;</span>  </span>
<span id="cb475-2"><a href="chapter-dplyr.html#cb475-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(<span class="fu">contains</span>(<span class="st">&quot;Len&quot;</span>), <span class="sc">~</span> .x <span class="sc">&gt;=</span> <span class="fl">6.5</span>))</span>
<span id="cb475-3"><a href="chapter-dplyr.html#cb475-3" tabindex="-1"></a><span class="do">## # A tibble: 4 × 5</span></span>
<span id="cb475-4"><a href="chapter-dplyr.html#cb475-4" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species  </span></span>
<span id="cb475-5"><a href="chapter-dplyr.html#cb475-5" tabindex="-1"></a><span class="do">##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;    </span></span>
<span id="cb475-6"><a href="chapter-dplyr.html#cb475-6" tabindex="-1"></a><span class="do">## 1          7.6         3            6.6         2.1 virginica</span></span>
<span id="cb475-7"><a href="chapter-dplyr.html#cb475-7" tabindex="-1"></a><span class="do">## 2          7.7         3.8          6.7         2.2 virginica</span></span>
<span id="cb475-8"><a href="chapter-dplyr.html#cb475-8" tabindex="-1"></a><span class="do">## 3          7.7         2.6          6.9         2.3 virginica</span></span>
<span id="cb475-9"><a href="chapter-dplyr.html#cb475-9" tabindex="-1"></a><span class="do">## 4          7.7         2.8          6.7         2   virginica</span></span></code></pre></div>
<p>데이터 프레임 <code>airquality</code>에서 적어도 하나의 결측값이 있는 행은 모두 제거해 보자.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="chapter-dplyr.html#cb476-1" tabindex="-1"></a><span class="fu">as_tibble</span>(airquality) <span class="sc">|&gt;</span> </span>
<span id="cb476-2"><a href="chapter-dplyr.html#cb476-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.x))) <span class="sc">|&gt;</span>  </span>
<span id="cb476-3"><a href="chapter-dplyr.html#cb476-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb476-4"><a href="chapter-dplyr.html#cb476-4" tabindex="-1"></a><span class="do">## # A tibble: 111 × 6</span></span>
<span id="cb476-5"><a href="chapter-dplyr.html#cb476-5" tabindex="-1"></a><span class="do">##   Ozone Solar.R  Wind  Temp Month   Day</span></span>
<span id="cb476-6"><a href="chapter-dplyr.html#cb476-6" tabindex="-1"></a><span class="do">##   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb476-7"><a href="chapter-dplyr.html#cb476-7" tabindex="-1"></a><span class="do">## 1    41     190   7.4    67     5     1</span></span>
<span id="cb476-8"><a href="chapter-dplyr.html#cb476-8" tabindex="-1"></a><span class="do">## 2    36     118   8      72     5     2</span></span>
<span id="cb476-9"><a href="chapter-dplyr.html#cb476-9" tabindex="-1"></a><span class="do">## 3    12     149  12.6    74     5     3</span></span>
<span id="cb476-10"><a href="chapter-dplyr.html#cb476-10" tabindex="-1"></a><span class="do">## # ℹ 108 more rows</span></span></code></pre></div>
<p>결측값이 있는 행의 제거는 함수 <code>drop_na()</code>으로도 할 수 있다.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="chapter-dplyr.html#cb477-1" tabindex="-1"></a><span class="fu">as_tibble</span>(airquality) <span class="sc">|&gt;</span></span>
<span id="cb477-2"><a href="chapter-dplyr.html#cb477-2" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb477-3"><a href="chapter-dplyr.html#cb477-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb477-4"><a href="chapter-dplyr.html#cb477-4" tabindex="-1"></a><span class="do">## # A tibble: 111 × 6</span></span>
<span id="cb477-5"><a href="chapter-dplyr.html#cb477-5" tabindex="-1"></a><span class="do">##   Ozone Solar.R  Wind  Temp Month   Day</span></span>
<span id="cb477-6"><a href="chapter-dplyr.html#cb477-6" tabindex="-1"></a><span class="do">##   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb477-7"><a href="chapter-dplyr.html#cb477-7" tabindex="-1"></a><span class="do">## 1    41     190   7.4    67     5     1</span></span>
<span id="cb477-8"><a href="chapter-dplyr.html#cb477-8" tabindex="-1"></a><span class="do">## 2    36     118   8      72     5     2</span></span>
<span id="cb477-9"><a href="chapter-dplyr.html#cb477-9" tabindex="-1"></a><span class="do">## 3    12     149  12.6    74     5     3</span></span>
<span id="cb477-10"><a href="chapter-dplyr.html#cb477-10" tabindex="-1"></a><span class="do">## # ℹ 108 more rows</span></span></code></pre></div>
<p>함수 <code>distinct()</code>와 <code>count()</code>도 <code>across()</code>와 함께 사용할 수 있는데, 이 두 함수의 경우에는 입력 요소 <code>.fns</code>를 지정할 필요가 없다.</p>
<p>데이터 프레임 <code>mpg</code>에서 처음 두 변수는 <code>manufacturer</code>와 <code>model</code>이다.
두 변수의 자료가 중복되지 않는 행을 선택해 보자.
함수 <code>distinct()</code>에 변수의 이름을 단순 나열하는 방법을 사용할 수 있지만,
함수 <code>across()</code>를 사용하면 <code>&lt;tidy-select&gt;</code> 방식을 사용할 수 있게 된다.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="chapter-dplyr.html#cb478-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb478-2"><a href="chapter-dplyr.html#cb478-2" tabindex="-1"></a>  <span class="fu">distinct</span>(manufacturer, model, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb478-3"><a href="chapter-dplyr.html#cb478-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb478-4"><a href="chapter-dplyr.html#cb478-4" tabindex="-1"></a><span class="do">## # A tibble: 38 × 11</span></span>
<span id="cb478-5"><a href="chapter-dplyr.html#cb478-5" tabindex="-1"></a><span class="do">##   manufacturer model      displ  year   cyl trans  drv     cty   hwy fl    class</span></span>
<span id="cb478-6"><a href="chapter-dplyr.html#cb478-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb478-7"><a href="chapter-dplyr.html#cb478-7" tabindex="-1"></a><span class="do">## 1 audi         a4           1.8  1999     4 auto(… f        18    29 p     comp…</span></span>
<span id="cb478-8"><a href="chapter-dplyr.html#cb478-8" tabindex="-1"></a><span class="do">## 2 audi         a4 quattro   1.8  1999     4 manua… 4        18    26 p     comp…</span></span>
<span id="cb478-9"><a href="chapter-dplyr.html#cb478-9" tabindex="-1"></a><span class="do">## 3 audi         a6 quattro   2.8  1999     6 auto(… 4        15    24 p     mids…</span></span>
<span id="cb478-10"><a href="chapter-dplyr.html#cb478-10" tabindex="-1"></a><span class="do">## # ℹ 35 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="chapter-dplyr.html#cb479-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> </span>
<span id="cb479-2"><a href="chapter-dplyr.html#cb479-2" tabindex="-1"></a>  <span class="fu">distinct</span>(<span class="fu">across</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb479-3"><a href="chapter-dplyr.html#cb479-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb479-4"><a href="chapter-dplyr.html#cb479-4" tabindex="-1"></a><span class="do">## # A tibble: 38 × 11</span></span>
<span id="cb479-5"><a href="chapter-dplyr.html#cb479-5" tabindex="-1"></a><span class="do">##   manufacturer model      displ  year   cyl trans  drv     cty   hwy fl    class</span></span>
<span id="cb479-6"><a href="chapter-dplyr.html#cb479-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb479-7"><a href="chapter-dplyr.html#cb479-7" tabindex="-1"></a><span class="do">## 1 audi         a4           1.8  1999     4 auto(… f        18    29 p     comp…</span></span>
<span id="cb479-8"><a href="chapter-dplyr.html#cb479-8" tabindex="-1"></a><span class="do">## 2 audi         a4 quattro   1.8  1999     4 manua… 4        18    26 p     comp…</span></span>
<span id="cb479-9"><a href="chapter-dplyr.html#cb479-9" tabindex="-1"></a><span class="do">## 3 audi         a6 quattro   2.8  1999     6 auto(… 4        15    24 p     mids…</span></span>
<span id="cb479-10"><a href="chapter-dplyr.html#cb479-10" tabindex="-1"></a><span class="do">## # ℹ 35 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="chapter-dplyr.html#cb480-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb480-2"><a href="chapter-dplyr.html#cb480-2" tabindex="-1"></a>  <span class="fu">distinct</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;m&quot;</span>)), <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb480-3"><a href="chapter-dplyr.html#cb480-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb480-4"><a href="chapter-dplyr.html#cb480-4" tabindex="-1"></a><span class="do">## # A tibble: 38 × 11</span></span>
<span id="cb480-5"><a href="chapter-dplyr.html#cb480-5" tabindex="-1"></a><span class="do">##   manufacturer model      displ  year   cyl trans  drv     cty   hwy fl    class</span></span>
<span id="cb480-6"><a href="chapter-dplyr.html#cb480-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb480-7"><a href="chapter-dplyr.html#cb480-7" tabindex="-1"></a><span class="do">## 1 audi         a4           1.8  1999     4 auto(… f        18    29 p     comp…</span></span>
<span id="cb480-8"><a href="chapter-dplyr.html#cb480-8" tabindex="-1"></a><span class="do">## 2 audi         a4 quattro   1.8  1999     4 manua… 4        18    26 p     comp…</span></span>
<span id="cb480-9"><a href="chapter-dplyr.html#cb480-9" tabindex="-1"></a><span class="do">## 3 audi         a6 quattro   2.8  1999     6 auto(… 4        15    24 p     mids…</span></span>
<span id="cb480-10"><a href="chapter-dplyr.html#cb480-10" tabindex="-1"></a><span class="do">## # ℹ 35 more rows</span></span></code></pre></div>
<p>변수 <code>manufacturer</code>와 <code>model</code>로 구성되는 각 그룹에 속한 행의 개수를 계산해서 내림차순으로 정렬해보자.
이 문제는 함수 <code>count()</code>를 사용하면 되며, 내림차순으로 정렬하는 것은 옵션 <code>sort=TRUE</code>를 추가하면 된다.
함수 <code>count</code>에서도 변수의 이름을 단순 나열하는 방법을 사용할 수 있지만,
함수 <code>across()</code>를 사용하면 <code>&lt;tidy-select&gt;</code> 방식을 사용할 수 있게 된다.</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="chapter-dplyr.html#cb481-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb481-2"><a href="chapter-dplyr.html#cb481-2" tabindex="-1"></a>  <span class="fu">count</span>(manufacturer, model, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb481-3"><a href="chapter-dplyr.html#cb481-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb481-4"><a href="chapter-dplyr.html#cb481-4" tabindex="-1"></a><span class="do">## # A tibble: 38 × 3</span></span>
<span id="cb481-5"><a href="chapter-dplyr.html#cb481-5" tabindex="-1"></a><span class="do">##   manufacturer model                   n</span></span>
<span id="cb481-6"><a href="chapter-dplyr.html#cb481-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt;               &lt;int&gt;</span></span>
<span id="cb481-7"><a href="chapter-dplyr.html#cb481-7" tabindex="-1"></a><span class="do">## 1 dodge        caravan 2wd            11</span></span>
<span id="cb481-8"><a href="chapter-dplyr.html#cb481-8" tabindex="-1"></a><span class="do">## 2 dodge        ram 1500 pickup 4wd    10</span></span>
<span id="cb481-9"><a href="chapter-dplyr.html#cb481-9" tabindex="-1"></a><span class="do">## 3 dodge        dakota pickup 4wd       9</span></span>
<span id="cb481-10"><a href="chapter-dplyr.html#cb481-10" tabindex="-1"></a><span class="do">## # ℹ 35 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="chapter-dplyr.html#cb482-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> </span>
<span id="cb482-2"><a href="chapter-dplyr.html#cb482-2" tabindex="-1"></a>  <span class="fu">count</span>(<span class="fu">across</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb482-3"><a href="chapter-dplyr.html#cb482-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb482-4"><a href="chapter-dplyr.html#cb482-4" tabindex="-1"></a><span class="do">## # A tibble: 38 × 3</span></span>
<span id="cb482-5"><a href="chapter-dplyr.html#cb482-5" tabindex="-1"></a><span class="do">##   manufacturer model                   n</span></span>
<span id="cb482-6"><a href="chapter-dplyr.html#cb482-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt;               &lt;int&gt;</span></span>
<span id="cb482-7"><a href="chapter-dplyr.html#cb482-7" tabindex="-1"></a><span class="do">## 1 dodge        caravan 2wd            11</span></span>
<span id="cb482-8"><a href="chapter-dplyr.html#cb482-8" tabindex="-1"></a><span class="do">## 2 dodge        ram 1500 pickup 4wd    10</span></span>
<span id="cb482-9"><a href="chapter-dplyr.html#cb482-9" tabindex="-1"></a><span class="do">## 3 dodge        dakota pickup 4wd       9</span></span>
<span id="cb482-10"><a href="chapter-dplyr.html#cb482-10" tabindex="-1"></a><span class="do">## # ℹ 35 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="chapter-dplyr.html#cb483-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb483-2"><a href="chapter-dplyr.html#cb483-2" tabindex="-1"></a>  <span class="fu">count</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;m&quot;</span>)), <span class="at">sort=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb483-3"><a href="chapter-dplyr.html#cb483-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb483-4"><a href="chapter-dplyr.html#cb483-4" tabindex="-1"></a><span class="do">## # A tibble: 38 × 3</span></span>
<span id="cb483-5"><a href="chapter-dplyr.html#cb483-5" tabindex="-1"></a><span class="do">##   manufacturer model                   n</span></span>
<span id="cb483-6"><a href="chapter-dplyr.html#cb483-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt;               &lt;int&gt;</span></span>
<span id="cb483-7"><a href="chapter-dplyr.html#cb483-7" tabindex="-1"></a><span class="do">## 1 dodge        caravan 2wd            11</span></span>
<span id="cb483-8"><a href="chapter-dplyr.html#cb483-8" tabindex="-1"></a><span class="do">## 2 dodge        ram 1500 pickup 4wd    10</span></span>
<span id="cb483-9"><a href="chapter-dplyr.html#cb483-9" tabindex="-1"></a><span class="do">## 3 dodge        dakota pickup 4wd       9</span></span>
<span id="cb483-10"><a href="chapter-dplyr.html#cb483-10" tabindex="-1"></a><span class="do">## # ℹ 35 more rows</span></span></code></pre></div>
<p>이 문제는 함수 <code>group_by()</code>와 <code>tally()</code>를 함께 사용해도 된다.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="chapter-dplyr.html#cb484-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> </span>
<span id="cb484-2"><a href="chapter-dplyr.html#cb484-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb484-3"><a href="chapter-dplyr.html#cb484-3" tabindex="-1"></a>  <span class="fu">tally</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb484-4"><a href="chapter-dplyr.html#cb484-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb484-5"><a href="chapter-dplyr.html#cb484-5" tabindex="-1"></a><span class="do">## # A tibble: 38 × 3</span></span>
<span id="cb484-6"><a href="chapter-dplyr.html#cb484-6" tabindex="-1"></a><span class="do">## # Groups:   manufacturer [15]</span></span>
<span id="cb484-7"><a href="chapter-dplyr.html#cb484-7" tabindex="-1"></a><span class="do">##   manufacturer model                   n</span></span>
<span id="cb484-8"><a href="chapter-dplyr.html#cb484-8" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt;               &lt;int&gt;</span></span>
<span id="cb484-9"><a href="chapter-dplyr.html#cb484-9" tabindex="-1"></a><span class="do">## 1 dodge        caravan 2wd            11</span></span>
<span id="cb484-10"><a href="chapter-dplyr.html#cb484-10" tabindex="-1"></a><span class="do">## 2 dodge        ram 1500 pickup 4wd    10</span></span>
<span id="cb484-11"><a href="chapter-dplyr.html#cb484-11" tabindex="-1"></a><span class="do">## 3 dodge        dakota pickup 4wd       9</span></span>
<span id="cb484-12"><a href="chapter-dplyr.html#cb484-12" tabindex="-1"></a><span class="do">## # ℹ 35 more rows</span></span></code></pre></div>
</div>
<div id="행-단위-작업-rowwise" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> 행 단위 작업: <code>rowwise()</code><a href="chapter-dplyr.html#행-단위-작업-rowwise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>dplyr</code>은 열 단위 작업에 특화되어 있다고 할 수 있다. 이것은 관찰값이 행, 변수가 열을 구성하고 있는 데이터 프레임에서 주된 분석 대상이 되는 것은 행이 아닌 열이기 때문이다. 이러한 측면에서 R의 큰 장점 중에 하나인 벡터 연산이 주로 열 단위로 이루어지는 것은 당연한 현상이다. 하지만 경우에 따라서는 행 단위의 연산을 해야 하는데, 이것은 매우 번거로울 수 있다. 예컨대, 각 행마다 여러 열 자료들의 합계 등의 요약 통계량을 구해야 한다면 루프 연산을 사용해야 한다.</p>
<p>함수 <code>rowwise()</code>를 사용하면 행 단위 연산이 가능하게 되는데, 이것은 각각의 행이 개별 그룹으로 취급을 받기 때문이다. 간단한 예를 가지고 작동 방식을 살펴보자.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="chapter-dplyr.html#cb485-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">z =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb485-2"><a href="chapter-dplyr.html#cb485-2" tabindex="-1"></a>df1 <span class="sc">|&gt;</span>  <span class="fu">rowwise</span>()</span>
<span id="cb485-3"><a href="chapter-dplyr.html#cb485-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 3</span></span>
<span id="cb485-4"><a href="chapter-dplyr.html#cb485-4" tabindex="-1"></a><span class="do">## # Rowwise: </span></span>
<span id="cb485-5"><a href="chapter-dplyr.html#cb485-5" tabindex="-1"></a><span class="do">##       x     y     z</span></span>
<span id="cb485-6"><a href="chapter-dplyr.html#cb485-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb485-7"><a href="chapter-dplyr.html#cb485-7" tabindex="-1"></a><span class="do">## 1     1     3     5</span></span>
<span id="cb485-8"><a href="chapter-dplyr.html#cb485-8" tabindex="-1"></a><span class="do">## 2     2     4     6</span></span></code></pre></div>
<p>함수 <code>rowwise()</code>로 생성된 데이터 프레임은 입력된 데이터 프레임 df1과 차이가 없어 보인다. 다만 <code>rowwise_df</code>라는 class 속성이 추가되는 것인데, 이것으로 인하여 함수 <code>summarise()</code>나 <code>mutate()</code>의 작동 방식이 달라진다. 함수 <code>rowwise()</code>로 구성된 행 단위의 그룹은 <code>ungroup()</code>으로 해체할 수 있다.</p>
<p>행 단위로 세 변수 x, y, z의 합을 나타내는 열을 생성해 보자.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="chapter-dplyr.html#cb486-1" tabindex="-1"></a>df1 <span class="sc">|&gt;</span> </span>
<span id="cb486-2"><a href="chapter-dplyr.html#cb486-2" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb486-3"><a href="chapter-dplyr.html#cb486-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(<span class="fu">c</span>(x, y, z)))</span>
<span id="cb486-4"><a href="chapter-dplyr.html#cb486-4" tabindex="-1"></a><span class="do">## # A tibble: 2 × 4</span></span>
<span id="cb486-5"><a href="chapter-dplyr.html#cb486-5" tabindex="-1"></a><span class="do">## # Rowwise: </span></span>
<span id="cb486-6"><a href="chapter-dplyr.html#cb486-6" tabindex="-1"></a><span class="do">##       x     y     z total</span></span>
<span id="cb486-7"><a href="chapter-dplyr.html#cb486-7" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb486-8"><a href="chapter-dplyr.html#cb486-8" tabindex="-1"></a><span class="do">## 1     1     3     5     9</span></span>
<span id="cb486-9"><a href="chapter-dplyr.html#cb486-9" tabindex="-1"></a><span class="do">## 2     2     4     6    12</span></span></code></pre></div>
<p>함수 <code>rowwise()</code> 없이 <code>mutate(df1, total = sum(c(x, y, z)))</code>를 실행하면 모든 행을 대상으로 세 변수의 합을 계산하게 된다.</p>
<p>행 단위 연산을 수행할 때에도 대부분의 경우에는 많은 열을 대상으로 작업을 하게 된다. 함수 <code>rowwise()</code>로 생성된 데이터 프레임을 대상으로 <code>summarise()</code>나 <code>mutate()</code>로 작업을 할 때, <code>&lt;tidy-select&gt;</code> 방식으로 열을 선택하기 위해서는 함수 <code>c_across()</code>를 함께 사용해야 한다. 사용법은 <code>c_across(cols = everything())</code>이며 <code>cols</code>에 <code>&lt;tidy-select&gt;</code> 방식으로 선택할 열을 지정하면 된다.</p>
<p>다음에 주어진 데이터 프레임 <code>df2</code>의 모든 숫자형 변수의 행 단위 합을 계산해 보자.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="chapter-dplyr.html#cb487-1" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">w =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">x =</span> <span class="dv">20</span><span class="sc">:</span><span class="dv">22</span>, <span class="at">y =</span> <span class="dv">30</span><span class="sc">:</span><span class="dv">32</span>, <span class="at">z =</span> <span class="dv">40</span><span class="sc">:</span><span class="dv">42</span>)</span></code></pre></div>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="chapter-dplyr.html#cb488-1" tabindex="-1"></a>df2 <span class="sc">|&gt;</span> </span>
<span id="cb488-2"><a href="chapter-dplyr.html#cb488-2" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb488-3"><a href="chapter-dplyr.html#cb488-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="fu">where</span>(is.numeric))))</span>
<span id="cb488-4"><a href="chapter-dplyr.html#cb488-4" tabindex="-1"></a><span class="do">## # A tibble: 3 × 1</span></span>
<span id="cb488-5"><a href="chapter-dplyr.html#cb488-5" tabindex="-1"></a><span class="do">##   total</span></span>
<span id="cb488-6"><a href="chapter-dplyr.html#cb488-6" tabindex="-1"></a><span class="do">##   &lt;int&gt;</span></span>
<span id="cb488-7"><a href="chapter-dplyr.html#cb488-7" tabindex="-1"></a><span class="do">## 1   101</span></span>
<span id="cb488-8"><a href="chapter-dplyr.html#cb488-8" tabindex="-1"></a><span class="do">## 2   106</span></span>
<span id="cb488-9"><a href="chapter-dplyr.html#cb488-9" tabindex="-1"></a><span class="do">## 3   111</span></span></code></pre></div>
<p>함수 <code>rowwise()</code> 안에서도 <code>&lt;tidy-select&gt;</code> 방식으로 열을 선택해서 지정할 수 있는데, 이렇게 지정된 열은 각 행의 ID 변수 역할을 하게 되어서 연산 과정에 포함되지 않는다.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="chapter-dplyr.html#cb489-1" tabindex="-1"></a>df2 <span class="sc">|&gt;</span> </span>
<span id="cb489-2"><a href="chapter-dplyr.html#cb489-2" tabindex="-1"></a>  <span class="fu">rowwise</span>(id) <span class="sc">|&gt;</span> </span>
<span id="cb489-3"><a href="chapter-dplyr.html#cb489-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="fu">where</span>(is.numeric))))</span>
<span id="cb489-4"><a href="chapter-dplyr.html#cb489-4" tabindex="-1"></a><span class="do">## # A tibble: 3 × 6</span></span>
<span id="cb489-5"><a href="chapter-dplyr.html#cb489-5" tabindex="-1"></a><span class="do">## # Rowwise:  id</span></span>
<span id="cb489-6"><a href="chapter-dplyr.html#cb489-6" tabindex="-1"></a><span class="do">##      id     w     x     y     z total</span></span>
<span id="cb489-7"><a href="chapter-dplyr.html#cb489-7" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb489-8"><a href="chapter-dplyr.html#cb489-8" tabindex="-1"></a><span class="do">## 1     1    10    20    30    40   100</span></span>
<span id="cb489-9"><a href="chapter-dplyr.html#cb489-9" tabindex="-1"></a><span class="do">## 2     2    11    21    31    41   104</span></span>
<span id="cb489-10"><a href="chapter-dplyr.html#cb489-10" tabindex="-1"></a><span class="do">## 3     3    12    22    32    42   108</span></span></code></pre></div>
<p>행 단위 연산으로 생성된 데이터 프레임을 대상으로 아무런 문제없이 열 단위 연산을 수 행할 수 있다. 데이터 프레임 <code>df2</code>의 각 열을 행 단위 합 <code>total</code>에 대한 비율로 변환해 보자.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="chapter-dplyr.html#cb490-1" tabindex="-1"></a>df2 <span class="sc">|&gt;</span> </span>
<span id="cb490-2"><a href="chapter-dplyr.html#cb490-2" tabindex="-1"></a>  <span class="fu">rowwise</span>(id) <span class="sc">|&gt;</span>  </span>
<span id="cb490-3"><a href="chapter-dplyr.html#cb490-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="fu">where</span>(is.numeric)))) <span class="sc">|&gt;</span>  </span>
<span id="cb490-4"><a href="chapter-dplyr.html#cb490-4" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb490-5"><a href="chapter-dplyr.html#cb490-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(w<span class="sc">:</span>z, <span class="sc">~</span> .x<span class="sc">/</span>total))</span>
<span id="cb490-6"><a href="chapter-dplyr.html#cb490-6" tabindex="-1"></a><span class="do">## # A tibble: 3 × 6</span></span>
<span id="cb490-7"><a href="chapter-dplyr.html#cb490-7" tabindex="-1"></a><span class="do">##      id     w     x     y     z total</span></span>
<span id="cb490-8"><a href="chapter-dplyr.html#cb490-8" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb490-9"><a href="chapter-dplyr.html#cb490-9" tabindex="-1"></a><span class="do">## 1     1 0.1   0.2   0.3   0.4     100</span></span>
<span id="cb490-10"><a href="chapter-dplyr.html#cb490-10" tabindex="-1"></a><span class="do">## 2     2 0.106 0.202 0.298 0.394   104</span></span>
<span id="cb490-11"><a href="chapter-dplyr.html#cb490-11" tabindex="-1"></a><span class="do">## 3     3 0.111 0.204 0.296 0.389   108</span></span></code></pre></div>
<p>함수 <code>ungroup()</code>을 제외하고 실행해도 동일한 결과를 얻을 수 있지만, <code>rowwise_df</code> class 속성이 생성된 데이터 프레임에 그대로 남아있게 된다.</p>
</div>
<div id="연습문제-2" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> 연습문제<a href="chapter-dplyr.html#연습문제-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>1.</strong> 데이터 프레임 <code>iris</code>는 세 가지 종류 붓꽃 <code>setosa</code> , <code>versicolor</code> , <code>virginica</code>의 꽃잎과 꽃받침의 길이와 폭을 측정한 자료이다.</p>
<ul>
<li>변수 <code>Species</code>가 <code>"setosa"</code>인 붓꽃 중에 변수 <code>Sepal.Length</code>의 값이 가장 큰 붓꽃을 선택해서 다음과 같은 형태로 출력해 보자.</li>
</ul>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="chapter-dplyr.html#cb491-1" tabindex="-1"></a>ex1_1</span>
<span id="cb491-2"><a href="chapter-dplyr.html#cb491-2" tabindex="-1"></a><span class="do">## # A tibble: 1 × 2</span></span>
<span id="cb491-3"><a href="chapter-dplyr.html#cb491-3" tabindex="-1"></a><span class="do">##   Species Sepal.Length</span></span>
<span id="cb491-4"><a href="chapter-dplyr.html#cb491-4" tabindex="-1"></a><span class="do">##   &lt;fct&gt;          &lt;dbl&gt;</span></span>
<span id="cb491-5"><a href="chapter-dplyr.html#cb491-5" tabindex="-1"></a><span class="do">## 1 setosa           5.8</span></span></code></pre></div>
<ul>
<li><code>"versicolor"</code>와 <code>"virginica"</code> 중에 <code>Petal.Length</code>와 <code>Petal.Width</code>의 합이 가장 작은 붓꽃을 찾아서 다음과 같은 형태로 출력해 보자.</li>
</ul>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="chapter-dplyr.html#cb492-1" tabindex="-1"></a>ex1_2</span>
<span id="cb492-2"><a href="chapter-dplyr.html#cb492-2" tabindex="-1"></a><span class="do">## # A tibble: 1 × 3</span></span>
<span id="cb492-3"><a href="chapter-dplyr.html#cb492-3" tabindex="-1"></a><span class="do">##   Species    Petal.Length Petal.Width</span></span>
<span id="cb492-4"><a href="chapter-dplyr.html#cb492-4" tabindex="-1"></a><span class="do">##   &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb492-5"><a href="chapter-dplyr.html#cb492-5" tabindex="-1"></a><span class="do">## 1 versicolor            3         1.1</span></span></code></pre></div>
<ul>
<li>붓꽃 <code>setosa</code> 중에 변수 <code>Petal.Length</code>가 3 이하고, <code>Petal.Width</code>가 1 이하인 케이스가 몇 송이가 되는지 확인해 보자.</li>
</ul>
<p><strong>2.</strong> 데이터 프레임 <code>mpg</code>에는 234대 자동차의 연비와 관련된 자료가 입력되어 있다.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="chapter-dplyr.html#cb493-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span>  </span>
<span id="cb493-2"><a href="chapter-dplyr.html#cb493-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb493-3"><a href="chapter-dplyr.html#cb493-3" tabindex="-1"></a><span class="do">## # A tibble: 234 × 11</span></span>
<span id="cb493-4"><a href="chapter-dplyr.html#cb493-4" tabindex="-1"></a><span class="do">##   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class </span></span>
<span id="cb493-5"><a href="chapter-dplyr.html#cb493-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; </span></span>
<span id="cb493-6"><a href="chapter-dplyr.html#cb493-6" tabindex="-1"></a><span class="do">## 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…</span></span>
<span id="cb493-7"><a href="chapter-dplyr.html#cb493-7" tabindex="-1"></a><span class="do">## 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…</span></span>
<span id="cb493-8"><a href="chapter-dplyr.html#cb493-8" tabindex="-1"></a><span class="do">## 3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…</span></span>
<span id="cb493-9"><a href="chapter-dplyr.html#cb493-9" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<ul>
<li>변수 <code>manufacturer</code>에는 몇 종류의 회사가 입력되어 있는지 확인해서, 다음의 형태로 출력해 보자.</li>
</ul>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="chapter-dplyr.html#cb494-1" tabindex="-1"></a>ex2_1</span>
<span id="cb494-2"><a href="chapter-dplyr.html#cb494-2" tabindex="-1"></a><span class="do">## # A tibble: 15 × 1</span></span>
<span id="cb494-3"><a href="chapter-dplyr.html#cb494-3" tabindex="-1"></a><span class="do">##    manufacturer</span></span>
<span id="cb494-4"><a href="chapter-dplyr.html#cb494-4" tabindex="-1"></a><span class="do">##    &lt;chr&gt;       </span></span>
<span id="cb494-5"><a href="chapter-dplyr.html#cb494-5" tabindex="-1"></a><span class="do">##  1 audi        </span></span>
<span id="cb494-6"><a href="chapter-dplyr.html#cb494-6" tabindex="-1"></a><span class="do">##  2 chevrolet   </span></span>
<span id="cb494-7"><a href="chapter-dplyr.html#cb494-7" tabindex="-1"></a><span class="do">##  3 dodge       </span></span>
<span id="cb494-8"><a href="chapter-dplyr.html#cb494-8" tabindex="-1"></a><span class="do">##  4 ford        </span></span>
<span id="cb494-9"><a href="chapter-dplyr.html#cb494-9" tabindex="-1"></a><span class="do">##  5 honda       </span></span>
<span id="cb494-10"><a href="chapter-dplyr.html#cb494-10" tabindex="-1"></a><span class="do">##  6 hyundai     </span></span>
<span id="cb494-11"><a href="chapter-dplyr.html#cb494-11" tabindex="-1"></a><span class="do">##  7 jeep        </span></span>
<span id="cb494-12"><a href="chapter-dplyr.html#cb494-12" tabindex="-1"></a><span class="do">##  8 land rover  </span></span>
<span id="cb494-13"><a href="chapter-dplyr.html#cb494-13" tabindex="-1"></a><span class="do">##  9 lincoln     </span></span>
<span id="cb494-14"><a href="chapter-dplyr.html#cb494-14" tabindex="-1"></a><span class="do">## 10 mercury     </span></span>
<span id="cb494-15"><a href="chapter-dplyr.html#cb494-15" tabindex="-1"></a><span class="do">## 11 nissan      </span></span>
<span id="cb494-16"><a href="chapter-dplyr.html#cb494-16" tabindex="-1"></a><span class="do">## 12 pontiac     </span></span>
<span id="cb494-17"><a href="chapter-dplyr.html#cb494-17" tabindex="-1"></a><span class="do">## 13 subaru      </span></span>
<span id="cb494-18"><a href="chapter-dplyr.html#cb494-18" tabindex="-1"></a><span class="do">## 14 toyota      </span></span>
<span id="cb494-19"><a href="chapter-dplyr.html#cb494-19" tabindex="-1"></a><span class="do">## 15 volkswagen</span></span></code></pre></div>
<ul>
<li>변수 <code>manufacturer</code>의 값이 같은 자동차가 많이 있는데, 각 <code>manufacturer</code>별로 변수 <code>cty</code>의 값이 가장 큰 자동차를 선택해 보자. 선택된 자동차의 변수 <code>manufacturer</code>, <code>model</code>, <code>displ</code>과 <code>cty</code>를 다음의 형태로 출력해 보자.</li>
</ul>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="chapter-dplyr.html#cb495-1" tabindex="-1"></a>ex2_2</span>
<span id="cb495-2"><a href="chapter-dplyr.html#cb495-2" tabindex="-1"></a><span class="do">## # A tibble: 15 × 4</span></span>
<span id="cb495-3"><a href="chapter-dplyr.html#cb495-3" tabindex="-1"></a><span class="do">##    manufacturer model              displ   cty</span></span>
<span id="cb495-4"><a href="chapter-dplyr.html#cb495-4" tabindex="-1"></a><span class="do">##    &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb495-5"><a href="chapter-dplyr.html#cb495-5" tabindex="-1"></a><span class="do">##  1 audi         a4                   1.8    21</span></span>
<span id="cb495-6"><a href="chapter-dplyr.html#cb495-6" tabindex="-1"></a><span class="do">##  2 chevrolet    malibu               2.4    22</span></span>
<span id="cb495-7"><a href="chapter-dplyr.html#cb495-7" tabindex="-1"></a><span class="do">##  3 dodge        caravan 2wd          2.4    18</span></span>
<span id="cb495-8"><a href="chapter-dplyr.html#cb495-8" tabindex="-1"></a><span class="do">##  4 ford         mustang              3.8    18</span></span>
<span id="cb495-9"><a href="chapter-dplyr.html#cb495-9" tabindex="-1"></a><span class="do">##  5 honda        civic                1.6    28</span></span>
<span id="cb495-10"><a href="chapter-dplyr.html#cb495-10" tabindex="-1"></a><span class="do">##  6 hyundai      sonata               2.4    21</span></span>
<span id="cb495-11"><a href="chapter-dplyr.html#cb495-11" tabindex="-1"></a><span class="do">##  7 jeep         grand cherokee 4wd   3      17</span></span>
<span id="cb495-12"><a href="chapter-dplyr.html#cb495-12" tabindex="-1"></a><span class="do">##  8 land rover   range rover          4.2    12</span></span>
<span id="cb495-13"><a href="chapter-dplyr.html#cb495-13" tabindex="-1"></a><span class="do">##  9 lincoln      navigator 2wd        5.4    12</span></span>
<span id="cb495-14"><a href="chapter-dplyr.html#cb495-14" tabindex="-1"></a><span class="do">## 10 mercury      mountaineer 4wd      4      14</span></span>
<span id="cb495-15"><a href="chapter-dplyr.html#cb495-15" tabindex="-1"></a><span class="do">## 11 nissan       altima               2.5    23</span></span>
<span id="cb495-16"><a href="chapter-dplyr.html#cb495-16" tabindex="-1"></a><span class="do">## 12 pontiac      grand prix           3.1    18</span></span>
<span id="cb495-17"><a href="chapter-dplyr.html#cb495-17" tabindex="-1"></a><span class="do">## 13 subaru       impreza awd          2.2    21</span></span>
<span id="cb495-18"><a href="chapter-dplyr.html#cb495-18" tabindex="-1"></a><span class="do">## 14 toyota       corolla              1.8    28</span></span>
<span id="cb495-19"><a href="chapter-dplyr.html#cb495-19" tabindex="-1"></a><span class="do">## 15 volkswagen   new beetle           1.9    35</span></span></code></pre></div>
<ul>
<li>모든 문자형 변수의 이름을 대문자로 수정하고 순서를 앞으로 이동해서 <code>mpg_ch</code>에 할당해 보자. <code>mpg_ch</code>의 형태는 다음과 같다.</li>
</ul>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="chapter-dplyr.html#cb496-1" tabindex="-1"></a>mpg_ch <span class="sc">|&gt;</span> </span>
<span id="cb496-2"><a href="chapter-dplyr.html#cb496-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb496-3"><a href="chapter-dplyr.html#cb496-3" tabindex="-1"></a><span class="do">## # A tibble: 234 × 11</span></span>
<span id="cb496-4"><a href="chapter-dplyr.html#cb496-4" tabindex="-1"></a><span class="do">##   MANUFACTURER MODEL TRANS      DRV   FL    CLASS  displ  year   cyl   cty   hwy</span></span>
<span id="cb496-5"><a href="chapter-dplyr.html#cb496-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb496-6"><a href="chapter-dplyr.html#cb496-6" tabindex="-1"></a><span class="do">## 1 audi         a4    auto(l5)   f     p     compa…   1.8  1999     4    18    29</span></span>
<span id="cb496-7"><a href="chapter-dplyr.html#cb496-7" tabindex="-1"></a><span class="do">## 2 audi         a4    manual(m5) f     p     compa…   1.8  1999     4    21    29</span></span>
<span id="cb496-8"><a href="chapter-dplyr.html#cb496-8" tabindex="-1"></a><span class="do">## 3 audi         a4    manual(m6) f     p     compa…   2    2008     4    20    31</span></span>
<span id="cb496-9"><a href="chapter-dplyr.html#cb496-9" tabindex="-1"></a><span class="do">## # ℹ 231 more rows</span></span></code></pre></div>
<p><strong>3.</strong> 다음은 Wikipedia에서 covid-19 관련 자료가 있는 웹 페이지(<a href="https://en.wikipedia.org/wiki/COVID-19_pandemic_by_country_and_territory">https://en.wikipedia.org/wiki/COVID-19_pandemic_by_country_and_territory)</a>에 있는 HTML 테이블의 일부분이다.</p>
<p><img src="Figure/ch4_ex1.PNG" width="400" /></p>
<ul>
<li>R로 불러와서 다음과 같이 tibble 형태로 출력해 보자.</li>
</ul>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="chapter-dplyr.html#cb497-1" tabindex="-1"></a>ex3_1</span>
<span id="cb497-2"><a href="chapter-dplyr.html#cb497-2" tabindex="-1"></a><span class="do">## # A tibble: 240 × 5</span></span>
<span id="cb497-3"><a href="chapter-dplyr.html#cb497-3" tabindex="-1"></a><span class="do">##    ``    Country                `Deaths / million` Deaths    Cases      </span></span>
<span id="cb497-4"><a href="chapter-dplyr.html#cb497-4" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;chr&gt;                  &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt;      </span></span>
<span id="cb497-5"><a href="chapter-dplyr.html#cb497-5" tabindex="-1"></a><span class="do">##  1 &quot;&quot;    World[a]               881                7,026,534 774,493,392</span></span>
<span id="cb497-6"><a href="chapter-dplyr.html#cb497-6" tabindex="-1"></a><span class="do">##  2 &quot;&quot;    Peru                   6,507              221,583   4,536,733  </span></span>
<span id="cb497-7"><a href="chapter-dplyr.html#cb497-7" tabindex="-1"></a><span class="do">##  3 &quot;&quot;    Bulgaria               5,703              38,681    1,327,689  </span></span>
<span id="cb497-8"><a href="chapter-dplyr.html#cb497-8" tabindex="-1"></a><span class="do">##  4 &quot;&quot;    Bosnia and Herzegovina 5,066              16,382    403,565    </span></span>
<span id="cb497-9"><a href="chapter-dplyr.html#cb497-9" tabindex="-1"></a><span class="do">##  5 &quot;&quot;    Hungary                4,918              49,022    2,229,538  </span></span>
<span id="cb497-10"><a href="chapter-dplyr.html#cb497-10" tabindex="-1"></a><span class="do">##  6 &quot;&quot;    North Macedonia        4,761              9,968     350,499    </span></span>
<span id="cb497-11"><a href="chapter-dplyr.html#cb497-11" tabindex="-1"></a><span class="do">##  7 &quot;&quot;    Slovenia               4,697              9,957     1,355,444  </span></span>
<span id="cb497-12"><a href="chapter-dplyr.html#cb497-12" tabindex="-1"></a><span class="do">##  8 &quot;&quot;    Croatia                4,636              18,687    1,309,728  </span></span>
<span id="cb497-13"><a href="chapter-dplyr.html#cb497-13" tabindex="-1"></a><span class="do">##  9 &quot;&quot;    Georgia                4,575              17,132    1,855,289  </span></span>
<span id="cb497-14"><a href="chapter-dplyr.html#cb497-14" tabindex="-1"></a><span class="do">## 10 &quot;&quot;    Montenegro             4,232              2,654     251,280    </span></span>
<span id="cb497-15"><a href="chapter-dplyr.html#cb497-15" tabindex="-1"></a><span class="do">## # ℹ 230 more rows</span></span></code></pre></div>
<ul>
<li>자료가 없는 <code>ex3_1</code>의 첫 번째 변수를 제거하고, 변수 <code>'Deaths / million'</code>의 이름을 <code>Death_rate</code>로 변경하자. 또한 첫 번째 행과 잘못된 자료가 입력된 마지막 8개 행도 제거해서, <code>ex3_2</code>에 할당해 보자. 변경된 데이터 프레임의 처음 3개 행과 마지막 3개 행의 내용은 다음과 같다.</li>
</ul>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="chapter-dplyr.html#cb498-1" tabindex="-1"></a>ex3_2 <span class="sc">|&gt;</span> </span>
<span id="cb498-2"><a href="chapter-dplyr.html#cb498-2" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb498-3"><a href="chapter-dplyr.html#cb498-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 4</span></span>
<span id="cb498-4"><a href="chapter-dplyr.html#cb498-4" tabindex="-1"></a><span class="do">##   Country                Death_rate Deaths  Cases    </span></span>
<span id="cb498-5"><a href="chapter-dplyr.html#cb498-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;                  &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;    </span></span>
<span id="cb498-6"><a href="chapter-dplyr.html#cb498-6" tabindex="-1"></a><span class="do">## 1 Peru                   6,507      221,583 4,536,733</span></span>
<span id="cb498-7"><a href="chapter-dplyr.html#cb498-7" tabindex="-1"></a><span class="do">## 2 Bulgaria               5,703      38,681  1,327,689</span></span>
<span id="cb498-8"><a href="chapter-dplyr.html#cb498-8" tabindex="-1"></a><span class="do">## 3 Bosnia and Herzegovina 5,066      16,382  403,565</span></span></code></pre></div>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="chapter-dplyr.html#cb499-1" tabindex="-1"></a>ex3_2 <span class="sc">|&gt;</span>  </span>
<span id="cb499-2"><a href="chapter-dplyr.html#cb499-2" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb499-3"><a href="chapter-dplyr.html#cb499-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 4</span></span>
<span id="cb499-4"><a href="chapter-dplyr.html#cb499-4" tabindex="-1"></a><span class="do">##   Country     Death_rate Deaths Cases </span></span>
<span id="cb499-5"><a href="chapter-dplyr.html#cb499-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt; </span></span>
<span id="cb499-6"><a href="chapter-dplyr.html#cb499-6" tabindex="-1"></a><span class="do">## 1 Chad        10         194    7,698 </span></span>
<span id="cb499-7"><a href="chapter-dplyr.html#cb499-7" tabindex="-1"></a><span class="do">## 2 Burundi     1          15     54,546</span></span>
<span id="cb499-8"><a href="chapter-dplyr.html#cb499-8" tabindex="-1"></a><span class="do">## 3 North Korea 0          6      1</span></span></code></pre></div>
<ul>
<li>백만명당 사망자 수를 나타내는 변수 <code>Death_rate</code>의 값이 가장 작은 3개 나라를 선택해서 다음과 같이 출력해 보자.</li>
</ul>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="chapter-dplyr.html#cb500-1" tabindex="-1"></a>ex3_3</span>
<span id="cb500-2"><a href="chapter-dplyr.html#cb500-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 4</span></span>
<span id="cb500-3"><a href="chapter-dplyr.html#cb500-3" tabindex="-1"></a><span class="do">##   Country     Death_rate Deaths Cases</span></span>
<span id="cb500-4"><a href="chapter-dplyr.html#cb500-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb500-5"><a href="chapter-dplyr.html#cb500-5" tabindex="-1"></a><span class="do">## 1 North Korea          0      6     1</span></span>
<span id="cb500-6"><a href="chapter-dplyr.html#cb500-6" tabindex="-1"></a><span class="do">## 2 Burundi              1     15 54546</span></span>
<span id="cb500-7"><a href="chapter-dplyr.html#cb500-7" tabindex="-1"></a><span class="do">## 3 Chad                10    194  7698</span></span></code></pre></div>
<ul>
<li>변수 <code>Cases</code>는 감염자 수를 나타내고, 변수 <code>Deaths</code>는 사망자 수를 나타내고 있다. 감염자 수에 대한 사망자 수의 비율, 즉 <code>Deaths</code>/<code>Cases</code>의 값이 가장 낮은 3개 나라를 선택해서 다음과 같이 출력해 보자.</li>
</ul>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="chapter-dplyr.html#cb501-1" tabindex="-1"></a>ex3_4</span>
<span id="cb501-2"><a href="chapter-dplyr.html#cb501-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 4</span></span>
<span id="cb501-3"><a href="chapter-dplyr.html#cb501-3" tabindex="-1"></a><span class="do">##   Country      Death_rate Deaths Cases</span></span>
<span id="cb501-4"><a href="chapter-dplyr.html#cb501-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb501-5"><a href="chapter-dplyr.html#cb501-5" tabindex="-1"></a><span class="do">## 1 Nauru                78      1  5393</span></span>
<span id="cb501-6"><a href="chapter-dplyr.html#cb501-6" tabindex="-1"></a><span class="do">## 2 Burundi               1     15 54546</span></span>
<span id="cb501-7"><a href="chapter-dplyr.html#cb501-7" tabindex="-1"></a><span class="do">## 3 Cook Islands        117      2  7203</span></span></code></pre></div>
<p><strong>4.</strong> 전통적 데이터 프레임과 tibble로 구성된 리스트를 만들어 보자.</p>
<ul>
<li>다음과 같은 리스트 <code>ex4</code>를 만들어 보자.</li>
</ul>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="chapter-dplyr.html#cb502-1" tabindex="-1"></a>ex4</span>
<span id="cb502-2"><a href="chapter-dplyr.html#cb502-2" tabindex="-1"></a><span class="do">## $df1</span></span>
<span id="cb502-3"><a href="chapter-dplyr.html#cb502-3" tabindex="-1"></a><span class="do">##   name Sales</span></span>
<span id="cb502-4"><a href="chapter-dplyr.html#cb502-4" tabindex="-1"></a><span class="do">## 1 Park    14</span></span>
<span id="cb502-5"><a href="chapter-dplyr.html#cb502-5" tabindex="-1"></a><span class="do">## 2  Lee    16</span></span>
<span id="cb502-6"><a href="chapter-dplyr.html#cb502-6" tabindex="-1"></a><span class="do">## 3  Kim    21</span></span>
<span id="cb502-7"><a href="chapter-dplyr.html#cb502-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb502-8"><a href="chapter-dplyr.html#cb502-8" tabindex="-1"></a><span class="do">## $df2</span></span>
<span id="cb502-9"><a href="chapter-dplyr.html#cb502-9" tabindex="-1"></a><span class="do">## # A tibble: 4 × 3</span></span>
<span id="cb502-10"><a href="chapter-dplyr.html#cb502-10" tabindex="-1"></a><span class="do">##     age gender income</span></span>
<span id="cb502-11"><a href="chapter-dplyr.html#cb502-11" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;</span></span>
<span id="cb502-12"><a href="chapter-dplyr.html#cb502-12" tabindex="-1"></a><span class="do">## 1    24 M        2000</span></span>
<span id="cb502-13"><a href="chapter-dplyr.html#cb502-13" tabindex="-1"></a><span class="do">## 2    35 F        3100</span></span>
<span id="cb502-14"><a href="chapter-dplyr.html#cb502-14" tabindex="-1"></a><span class="do">## 3    28 F        3800</span></span>
<span id="cb502-15"><a href="chapter-dplyr.html#cb502-15" tabindex="-1"></a><span class="do">## 4    21 F         200</span></span></code></pre></div>
<ul>
<li>리스트 <code>ex4</code>의 첫 번째 요소인 데이터 프레임에서 변수 <code>Sales</code>가 20을 초과하는 행을 선택해서 다음과 같이 출력하되, 패키지 <code>dplyr</code>의 함수를 전혀 사용하지 않고 해당 행을 선택하는 방법과 <code>dplyr</code> 함수에 의해 선택하는 방법으로 각각 실행해 보자.</li>
</ul>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="chapter-dplyr.html#cb503-1" tabindex="-1"></a>ex4_1</span>
<span id="cb503-2"><a href="chapter-dplyr.html#cb503-2" tabindex="-1"></a><span class="do">##   name Sales</span></span>
<span id="cb503-3"><a href="chapter-dplyr.html#cb503-3" tabindex="-1"></a><span class="do">## 3  Kim    21</span></span></code></pre></div>
<ul>
<li>리스트 <code>ex4</code>의 두 번째 요소인 tibble에서 변수 <code>gender</code>가 <code>"F"</code>인 행들의 변수 <code>income</code>의 평균값을 벡터로 출력하되, 패키지 <code>dplyr</code>의 함수를 사용해서 계산해 보자.</li>
</ul>
<p><strong>5.</strong> 패키지 <code>ggplot2</code>에 있는 데이터 프레임 <code>mpg</code>에는 234대 차량의 연비와 관련된 자료가 다음과 같이 입력되어 있다.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="chapter-dplyr.html#cb504-1" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb504-2"><a href="chapter-dplyr.html#cb504-2" tabindex="-1"></a><span class="do">## # A tibble: 234 × 11</span></span>
<span id="cb504-3"><a href="chapter-dplyr.html#cb504-3" tabindex="-1"></a><span class="do">##   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class </span></span>
<span id="cb504-4"><a href="chapter-dplyr.html#cb504-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; </span></span>
<span id="cb504-5"><a href="chapter-dplyr.html#cb504-5" tabindex="-1"></a><span class="do">## 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…</span></span>
<span id="cb504-6"><a href="chapter-dplyr.html#cb504-6" tabindex="-1"></a><span class="do">## 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…</span></span>
<span id="cb504-7"><a href="chapter-dplyr.html#cb504-7" tabindex="-1"></a><span class="do">## # ℹ 232 more rows</span></span></code></pre></div>
<ul>
<li><p>변수 <code>year</code>는 차량의 생산 연도를 나타내고 있다. 2008년에 생산된 차량 대수를 확인해서 출력하라.</p></li>
<li><p>변수 <code>displ</code>은 차량 엔진의 배기량을 나타내는 변수이다. 2008년에 생산된 차량 중 배기량이 4 이상인 차량을 선택해서 출력하라.</p></li>
<li><p>변수 <code>hwy</code>는 고속도로 주행 연비를 나타내는 변수이다. 2008년에 생산됐고 <code>displ</code>의 값이 4 이상인 차량 중 고속도로 연비가 가장 높은 4대 차량을 선택해서 출력하라.</p></li>
<li><p>변수 <code>hwy</code>에는 반올림된 값이 입력되어 있기 때문에, 같은 값을 갖고 있는 차량이 많이 있다. 중복된 값을 삭제하고, 연비가 가장 높은 차량부터 출력하라.</p></li>
<li><p>변수 <code>cty</code>는 시내주행 연비를 나타내는 변수이며, <code>hwy</code>의 경우처럼 반올임된 값이 입력되어 있다. 변수 <code>cty</code>와 <code>hwy</code>가 중복된 값을 갖지 않도록 정리해서 출력하라. 출력 결과는 다음과 같다.</p></li>
</ul>
<pre><code>## # A tibble: 15 × 11
##   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class 
##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…
## 2 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…
## # ℹ 13 more rows</code></pre>
<ul>
<li><p><code>mpg</code>의 11개 변수에는 문자형과 실수형, 그리고 정수형 변수가 있다. 문자형 변수만을 선택해서 출력하라.</p></li>
<li><p>정수형 변수가 아닌 변수를 선택하되, 문자형 변수의 경우에는 변수의 이름을 모두 대문자로 변경해서 출력하라. 출력 결과는 다음과 같다.</p></li>
</ul>
<pre><code>## # A tibble: 234 × 7
##   MANUFACTURER MODEL displ TRANS      DRV   FL    CLASS  
##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  
## 1 audi         a4      1.8 auto(l5)   f     p     compact
## 2 audi         a4      1.8 manual(m5) f     p     compact
## # ℹ 232 more rows</code></pre>
<ul>
<li>변수 <code>trans</code>는 차량의 변속기 종류를 나타내는 변수이다. 모두 10 종류의 변속기가 입력되어 있는데, 이것을 두 종류로 통합해서 새로운 변수 <code>am</code>에 입력하고자 한다. 통합 방식은 <code>trans</code> 값의 첫 글자가 <code>a</code>이면 <code>auto</code>로 값을 변경하고, 그외의 경우에는 <code>manual</code>로 변경하는 것이다. 변경 결과로 생성된 변수 <code>am</code>의 유형은 요인으로 하고, 위치는 <code>cyl</code> 다음에 두며, 변수 <code>trans</code>는 삭제한다. 변경된 결과는 다음과 같다.</li>
</ul>
<pre><code>## # A tibble: 234 × 11
##   manufacturer model displ  year   cyl am     drv     cty   hwy fl    class  
##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  
## 1 audi         a4      1.8  1999     4 auto   f        18    29 p     compact
## 2 audi         a4      1.8  1999     4 manual f        21    29 p     compact
## # ℹ 232 more rows</code></pre>
<ul>
<li>변수 <code>class</code>는 차량의 유형을 나타내는 변수이다. 차량 유형별 <code>hwy</code>의 평균과 각 유형에 속하는 차량 대수를 계산해서, 다음과 같이 평균 연비가 가장 낮은 차량 유형부터 나타나도록 출력하라.</li>
</ul>
<pre><code>## # A tibble: 7 × 3
##   class      avg_hwy     n
##   &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;
## 1 pickup        16.9    33
## 2 suv           18.1    62
## 3 minivan       22.4    11
## 4 2seater       24.8     5
## 5 midsize       27.3    41
## 6 subcompact    28.1    35
## 7 compact       28.3    47</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="데이터-입력.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
