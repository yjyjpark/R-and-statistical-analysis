<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 장 Tidyverse를 활용한 데이터 다루기 | R과 통계분석</title>
  <meta name="description" content="6 장 Tidyverse를 활용한 데이터 다루기 | R과 통계분석" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="6 장 Tidyverse를 활용한 데이터 다루기 | R과 통계분석" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 장 Tidyverse를 활용한 데이터 다루기 | R과 통계분석" />
  
  
  

<meta name="author" content="박동련" />


<meta name="date" content="2024-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-ggplot2.html"/>
<link rel="next" href="chapter-programming.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>소개하기</a></li>
<li class="chapter" data-level="1" data-path="R-start.html"><a href="R-start.html"><i class="fa fa-check"></i><b>1</b> R 시작하기</a>
<ul>
<li class="chapter" data-level="1.1" data-path="R-start.html"><a href="R-start.html#r의-소개"><i class="fa fa-check"></i><b>1.1</b> R의 소개</a></li>
<li class="chapter" data-level="1.2" data-path="R-start.html"><a href="R-start.html#r의-설치"><i class="fa fa-check"></i><b>1.2</b> R의 설치</a></li>
<li class="chapter" data-level="1.3" data-path="R-start.html"><a href="R-start.html#rstudio의-설치-및-r의-실행"><i class="fa fa-check"></i><b>1.3</b> RStudio의 설치 및 R의 실행</a></li>
<li class="chapter" data-level="1.4" data-path="R-start.html"><a href="R-start.html#작업공간"><i class="fa fa-check"></i><b>1.4</b> 작업공간</a></li>
<li class="chapter" data-level="1.5" data-path="R-start.html"><a href="R-start.html#스크립트-파일의-활용"><i class="fa fa-check"></i><b>1.5</b> 스크립트 파일의 활용</a></li>
<li class="chapter" data-level="1.6" data-path="R-start.html"><a href="R-start.html#section-batch"><i class="fa fa-check"></i><b>1.6</b> 일괄처리</a></li>
<li class="chapter" data-level="1.7" data-path="R-start.html"><a href="R-start.html#section-package"><i class="fa fa-check"></i><b>1.7</b> R의 확장: 패키지</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="R-start.html"><a href="R-start.html#패키지의-종류"><i class="fa fa-check"></i><b>1.7.1</b> 패키지의 종류</a></li>
<li class="chapter" data-level="1.7.2" data-path="R-start.html"><a href="R-start.html#패키지의-설치-및-사용"><i class="fa fa-check"></i><b>1.7.2</b> 패키지의 설치 및 사용</a></li>
<li class="chapter" data-level="1.7.3" data-path="R-start.html"><a href="R-start.html#패키지-tidyverse의-소개"><i class="fa fa-check"></i><b>1.7.3</b> 패키지 <code>tidyverse</code>의 소개</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structure.html"><a href="data-structure.html"><i class="fa fa-check"></i><b>2</b> R 데이터 구조</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structure.html"><a href="data-structure.html#벡터"><i class="fa fa-check"></i><b>2.1</b> 벡터</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-structure.html"><a href="data-structure.html#벡터의-기본-특성"><i class="fa fa-check"></i><b>2.1.1</b> 벡터의 기본 특성</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-structure.html"><a href="data-structure.html#다양한-형태를-갖는-벡터의-생성"><i class="fa fa-check"></i><b>2.1.2</b> 다양한 형태를 갖는 벡터의 생성</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-structure.html"><a href="data-structure.html#문자열을-위한-함수"><i class="fa fa-check"></i><b>2.1.3</b> 문자열을 위한 함수</a></li>
<li class="chapter" data-level="2.1.4" data-path="data-structure.html"><a href="data-structure.html#벡터의-연산"><i class="fa fa-check"></i><b>2.1.4</b> 벡터의 연산</a></li>
<li class="chapter" data-level="2.1.5" data-path="data-structure.html"><a href="data-structure.html#vector-compare"><i class="fa fa-check"></i><b>2.1.5</b> 벡터의 비교</a></li>
<li class="chapter" data-level="2.1.6" data-path="data-structure.html"><a href="data-structure.html#벡터의-인덱싱"><i class="fa fa-check"></i><b>2.1.6</b> 벡터의 인덱싱</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-structure.html"><a href="data-structure.html#요인"><i class="fa fa-check"></i><b>2.2</b> 요인</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-structure.html"><a href="data-structure.html#요인의-기본-특성"><i class="fa fa-check"></i><b>2.2.1</b> 요인의 기본 특성</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-structure.html"><a href="data-structure.html#숫자형-벡터를-요인으로-변환"><i class="fa fa-check"></i><b>2.2.2</b> 숫자형 벡터를 요인으로 변환</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-structure.html"><a href="data-structure.html#날짜"><i class="fa fa-check"></i><b>2.3</b> 날짜</a></li>
<li class="chapter" data-level="2.4" data-path="data-structure.html"><a href="data-structure.html#행렬-및-배열"><i class="fa fa-check"></i><b>2.4</b> 행렬 및 배열</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-structure.html"><a href="data-structure.html#행렬과-배열의-기본-특성"><i class="fa fa-check"></i><b>2.4.1</b> 행렬과 배열의 기본 특성</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-structure.html"><a href="data-structure.html#행렬의-연산"><i class="fa fa-check"></i><b>2.4.2</b> 행렬의 연산</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-structure.html"><a href="data-structure.html#section-dataframe"><i class="fa fa-check"></i><b>2.5</b> 데이터 프레임</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-structure.html"><a href="data-structure.html#데이터-프레임의-생성"><i class="fa fa-check"></i><b>2.5.1</b> 데이터 프레임의 생성</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-structure.html"><a href="data-structure.html#데이터-프레임의-인덱싱"><i class="fa fa-check"></i><b>2.5.2</b> 데이터 프레임의 인덱싱</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-structure.html"><a href="data-structure.html#함수-with"><i class="fa fa-check"></i><b>2.5.3</b> 함수 <code>with()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-structure.html"><a href="data-structure.html#tibble-개선된-형태의-데이터-프레임"><i class="fa fa-check"></i><b>2.6</b> tibble: 개선된 형태의 데이터 프레임</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data-structure.html"><a href="data-structure.html#tibble-생성"><i class="fa fa-check"></i><b>2.6.1</b> tibble 생성</a></li>
<li class="chapter" data-level="2.6.2" data-path="data-structure.html"><a href="data-structure.html#tibble과-전통적인-데이터-프레임의-차이"><i class="fa fa-check"></i><b>2.6.2</b> tibble과 전통적인 데이터 프레임의 차이</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-structure.html"><a href="data-structure.html#section-list"><i class="fa fa-check"></i><b>2.7</b> 리스트</a></li>
<li class="chapter" data-level="2.8" data-path="data-structure.html"><a href="data-structure.html#연습문제"><i class="fa fa-check"></i><b>2.8</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="데이터-입력.html"><a href="데이터-입력.html"><i class="fa fa-check"></i><b>3</b> 데이터 입력</a>
<ul>
<li class="chapter" data-level="3.1" data-path="데이터-입력.html"><a href="데이터-입력.html#텍스트-파일-불러오기-패키지-readr-함수의-활용"><i class="fa fa-check"></i><b>3.1</b> 텍스트 파일 불러오기: 패키지 <code>readr</code> 함수의 활용</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="데이터-입력.html"><a href="데이터-입력.html#함수-read_table로-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.1.1</b> 함수 <code>read_table()</code>로 데이터 파일 불러오기</a></li>
<li class="chapter" data-level="3.1.2" data-path="데이터-입력.html"><a href="데이터-입력.html#함수-read_csv로-csv-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.1.2</b> 함수 <code>read_csv()</code>로 CSV 데이터 파일 불러오기</a></li>
<li class="chapter" data-level="3.1.3" data-path="데이터-입력.html"><a href="데이터-입력.html#함수-read_fwf로-고정-포맷-구조를-갖는-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.1.3</b> 함수 <code>read_fwf()</code>로 고정 포맷 구조를 갖는 데이터 파일 불러오기</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="데이터-입력.html"><a href="데이터-입력.html#excel-파일-불러오기"><i class="fa fa-check"></i><b>3.2</b> Excel 파일 불러오기</a></li>
<li class="chapter" data-level="3.3" data-path="데이터-입력.html"><a href="데이터-입력.html#sas-데이터-파일-불러오기"><i class="fa fa-check"></i><b>3.3</b> SAS 데이터 파일 불러오기</a></li>
<li class="chapter" data-level="3.4" data-path="데이터-입력.html"><a href="데이터-입력.html#html-테이블-불러오기"><i class="fa fa-check"></i><b>3.4</b> HTML 테이블 불러오기</a></li>
<li class="chapter" data-level="3.5" data-path="데이터-입력.html"><a href="데이터-입력.html#연습문제-1"><i class="fa fa-check"></i><b>3.5</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html"><i class="fa fa-check"></i><b>4</b> <code>dplyr</code>에 의한 데이터 다듬기</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#행을-작업-대상으로-하는-함수"><i class="fa fa-check"></i><b>4.1</b> 행을 작업 대상으로 하는 함수</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#조건에-의한-행-선택-filter"><i class="fa fa-check"></i><b>4.1.1</b> 조건에 의한 행 선택: <code>filter()</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#위치에-의한-행-선택-slice-및-그와-관련된-함수"><i class="fa fa-check"></i><b>4.1.2</b> 위치에 의한 행 선택: <code>slice()</code> 및 그와 관련된 함수</a></li>
<li class="chapter" data-level="4.1.3" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#행의-정렬-arrange"><i class="fa fa-check"></i><b>4.1.3</b> 행의 정렬: <code>arrange()</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#중복된-행의-제거-distinct"><i class="fa fa-check"></i><b>4.1.4</b> 중복된 행의 제거: <code>distinct()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#열을-작업-대상으로-하는-함수"><i class="fa fa-check"></i><b>4.2</b> 열을 작업 대상으로 하는 함수</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#열의-선택-select"><i class="fa fa-check"></i><b>4.2.1</b> 열의 선택: <code>select()</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#열-이름-변경-rename과-rename_with"><i class="fa fa-check"></i><b>4.2.2</b> 열 이름 변경: <code>rename()</code>과 <code>rename_with()</code></a></li>
<li class="chapter" data-level="4.2.3" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#열의-위치-변경-relocate"><i class="fa fa-check"></i><b>4.2.3</b> 열의 위치 변경: <code>relocate()</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#새로운-열의-추가-mutate와-transmute"><i class="fa fa-check"></i><b>4.2.4</b> 새로운 열의 추가: <code>mutate()</code>와 <code>transmute()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#여러-행-자료의-요약-summarise"><i class="fa fa-check"></i><b>4.3</b> 여러 행 자료의 요약: <code>summarise()</code></a></li>
<li class="chapter" data-level="4.4" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#그룹-데이터-프레임"><i class="fa fa-check"></i><b>4.4</b> 그룹 데이터 프레임</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#그룹-데이터-프레임의-생성-group_by"><i class="fa fa-check"></i><b>4.4.1</b> 그룹 데이터 프레임의 생성: <code>group_by()</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#그룹-데이터-프레임에서-기본-함수들의-작동-방식"><i class="fa fa-check"></i><b>4.4.2</b> 그룹 데이터 프레임에서 기본 함수들의 작동 방식</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#다수의-열을-대상으로-하는-작업-across"><i class="fa fa-check"></i><b>4.5</b> 다수의 열을 대상으로 하는 작업: <code>across()</code></a></li>
<li class="chapter" data-level="4.6" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#행-단위-작업-rowwise"><i class="fa fa-check"></i><b>4.6</b> 행 단위 작업: <code>rowwise()</code></a></li>
<li class="chapter" data-level="4.7" data-path="chapter-dplyr.html"><a href="chapter-dplyr.html#연습문제-2"><i class="fa fa-check"></i><b>4.7</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html"><i class="fa fa-check"></i><b>5</b> <code>ggplot2</code>에 의한 자료 시각화</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#ggplot2-시작하기"><i class="fa fa-check"></i><b>5.1</b> <code>ggplot2</code> 시작하기</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#시각적-요소와의-연결-mapping"><i class="fa fa-check"></i><b>5.2</b> 시각적 요소와의 연결: Mapping</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#그룹별-그래프-작성-facet"><i class="fa fa-check"></i><b>5.3</b> 그룹별 그래프 작성: Facet</a></li>
<li class="chapter" data-level="5.4" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#section-geom"><i class="fa fa-check"></i><b>5.4</b> 기하 객체: Geometric object</a></li>
<li class="chapter" data-level="5.5" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#통계적-변환-statistical-transformation"><i class="fa fa-check"></i><b>5.5</b> 통계적 변환: Statistical transformation</a></li>
<li class="chapter" data-level="5.6" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#위치-조정-position-adjustments"><i class="fa fa-check"></i><b>5.6</b> 위치 조정: Position adjustments</a></li>
<li class="chapter" data-level="5.7" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#좌표계-coordinate-system"><i class="fa fa-check"></i><b>5.7</b> 좌표계: Coordinate system</a></li>
<li class="chapter" data-level="5.8" data-path="chapter-ggplot2.html"><a href="chapter-ggplot2.html#연습문제-3"><i class="fa fa-check"></i><b>5.8</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch6.html"><a href="ch6.html"><i class="fa fa-check"></i><b>6</b> Tidyverse를 활용한 데이터 다루기</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch6.html"><a href="ch6.html#tidyr로-tidy-데이터-만들기"><i class="fa fa-check"></i><b>6.1</b> <code>tidyr</code>로 tidy 데이터 만들기</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ch6.html"><a href="ch6.html#데이터-피벗-pivot_longer와-pivot_wider"><i class="fa fa-check"></i><b>6.1.1</b> 데이터 피벗: <code>pivot_longer()</code>와 <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="ch6.html"><a href="ch6.html#문자형-열의-결합과-분리-separate와-unite"><i class="fa fa-check"></i><b>6.1.2</b> 문자형 열의 결합과 분리: <code>separate()</code>와 <code>unite()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ch6.html"><a href="ch6.html#dplyr에-의한-데이터-결합"><i class="fa fa-check"></i><b>6.2</b> <code>dplyr</code>에 의한 데이터 결합</a></li>
<li class="chapter" data-level="6.3" data-path="ch6.html"><a href="ch6.html#stringr에-의한-문자-다루기"><i class="fa fa-check"></i><b>6.3</b> <code>stringr</code>에 의한 문자 다루기</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ch6.html"><a href="ch6.html#stringr의-함수"><i class="fa fa-check"></i><b>6.3.1</b> <code>stringr</code>의 함수</a></li>
<li class="chapter" data-level="6.3.2" data-path="ch6.html"><a href="ch6.html#정규-표현식과-stringr의-함수"><i class="fa fa-check"></i><b>6.3.2</b> 정규 표현식과 <code>stringr</code>의 함수</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ch6.html"><a href="ch6.html#연습문제-4"><i class="fa fa-check"></i><b>6.4</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-programming.html"><a href="chapter-programming.html"><i class="fa fa-check"></i><b>7</b> R에서의 프로그래밍</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-programming.html"><a href="chapter-programming.html#사용자-정의-함수"><i class="fa fa-check"></i><b>7.1</b> 사용자 정의 함수</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="chapter-programming.html"><a href="chapter-programming.html#함수의-정의"><i class="fa fa-check"></i><b>7.1.1</b> 함수의 정의</a></li>
<li class="chapter" data-level="7.1.2" data-path="chapter-programming.html"><a href="chapter-programming.html#변수"><i class="fa fa-check"></i><b>7.1.2</b> 변수</a></li>
<li class="chapter" data-level="7.1.3" data-path="chapter-programming.html"><a href="chapter-programming.html#변수-지정"><i class="fa fa-check"></i><b>7.1.3</b> 변수 지정</a></li>
<li class="chapter" data-level="7.1.4" data-path="chapter-programming.html"><a href="chapter-programming.html#결과의-출력"><i class="fa fa-check"></i><b>7.1.4</b> 결과의 출력</a></li>
<li class="chapter" data-level="7.1.5" data-path="chapter-programming.html"><a href="chapter-programming.html#유효-범위"><i class="fa fa-check"></i><b>7.1.5</b> 유효 범위</a></li>
<li class="chapter" data-level="7.1.6" data-path="chapter-programming.html"><a href="chapter-programming.html#데이터-프레임-함수"><i class="fa fa-check"></i><b>7.1.6</b> 데이터 프레임 함수</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chapter-programming.html"><a href="chapter-programming.html#조건-연산"><i class="fa fa-check"></i><b>7.2</b> 조건 연산</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="chapter-programming.html"><a href="chapter-programming.html#함수-if에-의한-조건-연산"><i class="fa fa-check"></i><b>7.2.1</b> 함수 <code>if()</code>에 의한 조건 연산</a></li>
<li class="chapter" data-level="7.2.2" data-path="chapter-programming.html"><a href="chapter-programming.html#함수-ifelse에-의한-조건-연산"><i class="fa fa-check"></i><b>7.2.2</b> 함수 <code>ifelse()</code>에 의한 조건 연산</a></li>
<li class="chapter" data-level="7.2.3" data-path="chapter-programming.html"><a href="chapter-programming.html#함수-switch에-의한-조건-연산"><i class="fa fa-check"></i><b>7.2.3</b> 함수 <code>switch()</code>에 의한 조건 연산</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="chapter-programming.html"><a href="chapter-programming.html#루프-연산"><i class="fa fa-check"></i><b>7.3</b> 루프 연산</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="chapter-programming.html"><a href="chapter-programming.html#for-루프"><i class="fa fa-check"></i><b>7.3.1</b> for 루프</a></li>
<li class="chapter" data-level="7.3.2" data-path="chapter-programming.html"><a href="chapter-programming.html#while-루프"><i class="fa fa-check"></i><b>7.3.2</b> while 루프</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="chapter-programming.html"><a href="chapter-programming.html#함수형-프로그래밍"><i class="fa fa-check"></i><b>7.4</b> 함수형 프로그래밍</a></li>
<li class="chapter" data-level="7.5" data-path="chapter-programming.html"><a href="chapter-programming.html#함수형-프로그래밍으로-행렬과-데이터-프레임-다루기"><i class="fa fa-check"></i><b>7.5</b> 함수형 프로그래밍으로 행렬과 데이터 프레임 다루기</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="chapter-programming.html"><a href="chapter-programming.html#행렬에-함수형-프로그래밍-적용하기"><i class="fa fa-check"></i><b>7.5.1</b> 행렬에 함수형 프로그래밍 적용하기</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapter-programming.html"><a href="chapter-programming.html#데이터-프레임에-함수형-프로그래밍-적용하기"><i class="fa fa-check"></i><b>7.5.2</b> 데이터 프레임에 함수형 프로그래밍 적용하기</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapter-programming.html"><a href="chapter-programming.html#purrr에-의한-프로그래밍"><i class="fa fa-check"></i><b>7.6</b> <code>purrr</code>에 의한 프로그래밍</a></li>
<li class="chapter" data-level="7.7" data-path="chapter-programming.html"><a href="chapter-programming.html#연습문제-5"><i class="fa fa-check"></i><b>7.7</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-distribution.html"><a href="chapter-distribution.html"><i class="fa fa-check"></i><b>8</b> 확률분포</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-distribution.html"><a href="chapter-distribution.html#r에서의-확률분포-이름"><i class="fa fa-check"></i><b>8.1</b> R에서의 확률분포 이름</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-distribution.html"><a href="chapter-distribution.html#연속형-확률분포"><i class="fa fa-check"></i><b>8.2</b> 연속형 확률분포</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="chapter-distribution.html"><a href="chapter-distribution.html#정규분포"><i class="fa fa-check"></i><b>8.2.1</b> 정규분포</a></li>
<li class="chapter" data-level="8.2.2" data-path="chapter-distribution.html"><a href="chapter-distribution.html#지수분포"><i class="fa fa-check"></i><b>8.2.2</b> 지수분포</a></li>
<li class="chapter" data-level="8.2.3" data-path="chapter-distribution.html"><a href="chapter-distribution.html#균등분포"><i class="fa fa-check"></i><b>8.2.3</b> 균등분포</a></li>
<li class="chapter" data-level="8.2.4" data-path="chapter-distribution.html"><a href="chapter-distribution.html#t-분포"><i class="fa fa-check"></i><b>8.2.4</b> t-분포</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="chapter-distribution.html"><a href="chapter-distribution.html#이산형-분포"><i class="fa fa-check"></i><b>8.3</b> 이산형 분포</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="chapter-distribution.html"><a href="chapter-distribution.html#베르누이-분포와-이항분포"><i class="fa fa-check"></i><b>8.3.1</b> 베르누이 분포와 이항분포</a></li>
<li class="chapter" data-level="8.3.2" data-path="chapter-distribution.html"><a href="chapter-distribution.html#포아송-분포"><i class="fa fa-check"></i><b>8.3.2</b> 포아송 분포</a></li>
<li class="chapter" data-level="8.3.3" data-path="chapter-distribution.html"><a href="chapter-distribution.html#초기하분포"><i class="fa fa-check"></i><b>8.3.3</b> 초기하분포</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chapter-distribution.html"><a href="chapter-distribution.html#모의실험"><i class="fa fa-check"></i><b>8.4</b> 모의실험</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-EDA.html"><a href="chapter-EDA.html"><i class="fa fa-check"></i><b>9</b> 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#일변량-범주형-자료-탐색"><i class="fa fa-check"></i><b>9.1</b> 일변량 범주형 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#막대그래프"><i class="fa fa-check"></i><b>9.1.1</b> 막대그래프</a></li>
<li class="chapter" data-level="9.1.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#파이그래프"><i class="fa fa-check"></i><b>9.1.2</b> 파이그래프</a></li>
<li class="chapter" data-level="9.1.3" data-path="chapter-EDA.html"><a href="chapter-EDA.html#cleveland의-점그래프"><i class="fa fa-check"></i><b>9.1.3</b> Cleveland의 점그래프</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#이변량-및-다변량-범주형-자료-탐색"><i class="fa fa-check"></i><b>9.2</b> 이변량 및 다변량 범주형 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#분할표-작성"><i class="fa fa-check"></i><b>9.2.1</b> 분할표 작성</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#이변량-및-다변량-범주형-자료를-위한-그래프"><i class="fa fa-check"></i><b>9.2.2</b> 이변량 및 다변량 범주형 자료를 위한 그래프</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapter-EDA.html"><a href="chapter-EDA.html#일변량-연속형-자료-탐색"><i class="fa fa-check"></i><b>9.3</b> 일변량 연속형 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#줄기-잎-그림"><i class="fa fa-check"></i><b>9.3.1</b> 줄기-잎 그림</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#section-boxplot"><i class="fa fa-check"></i><b>9.3.2</b> 상자그림</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapter-EDA.html"><a href="chapter-EDA.html#히스토그램"><i class="fa fa-check"></i><b>9.3.3</b> 히스토그램</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapter-EDA.html"><a href="chapter-EDA.html#section-prob-density"><i class="fa fa-check"></i><b>9.3.4</b> 확률밀도함수 그래프</a></li>
<li class="chapter" data-level="9.3.5" data-path="chapter-EDA.html"><a href="chapter-EDA.html#기타-유용한-그래프"><i class="fa fa-check"></i><b>9.3.5</b> 기타 유용한 그래프</a></li>
<li class="chapter" data-level="9.3.6" data-path="chapter-EDA.html"><a href="chapter-EDA.html#일변량-연속형-자료의-요약통계"><i class="fa fa-check"></i><b>9.3.6</b> 일변량 연속형 자료의 요약통계</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-EDA.html"><a href="chapter-EDA.html#이변량-연속형-자료-탐색"><i class="fa fa-check"></i><b>9.4</b> 이변량 연속형 자료 탐색</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter-EDA.html"><a href="chapter-EDA.html#연속형-변수의-분포를-비교하기-위한-그래프"><i class="fa fa-check"></i><b>9.4.1</b> 연속형 변수의 분포를 비교하기 위한 그래프</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapter-EDA.html"><a href="chapter-EDA.html#연속형-변수의-관계-탐색을-위한-그래프"><i class="fa fa-check"></i><b>9.4.2</b> 연속형 변수의 관계 탐색을 위한 그래프</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="chapter-EDA.html"><a href="chapter-EDA.html#연습문제-6"><i class="fa fa-check"></i><b>9.5</b> 연습문제</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html"><i class="fa fa-check"></i>부록</a>
<ul>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#r과-통계분석-연습문제-해답"><i class="fa fa-check"></i>‘R과 통계분석’ 연습문제 해답</a>
<ul>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장"><i class="fa fa-check"></i>2장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-1"><i class="fa fa-check"></i>3장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-2"><i class="fa fa-check"></i>4장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-3"><i class="fa fa-check"></i>5장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-4"><i class="fa fa-check"></i>6장</a></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#장-5"><i class="fa fa-check"></i>7장</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="부록.html"><a href="부록.html#참고문헌"><i class="fa fa-check"></i>참고문헌</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R과 통계분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch6" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6 장</span> Tidyverse를 활용한 데이터 다루기<a href="ch6.html#ch6" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>R의 모습은 tidyverse 이전과 이후로 완전히 구분된다고 할 수 있다. 데이터 다루기와 그래프 성능이 비교할 수 없을 만큼 향상되었고, 복잡한 분석 과정이 대폭 단순화되어 매우 효율적인 분석이 가능해졌다. 이러한 발전으로 인하여 Data science를 위한 최적의 프로그램으로 자리매김을 확고하게 했다고 할 수 있다. 이 장에서는 core tidyverse에 속한 패키지 중 자료의 형태를 통계분석이 가능하도록 다듬는 작업에 사용되는 <code>tidyr</code>, 문자 다루기에 유용한 <code>stringr</code>, 그리고 자료 결합에 유용한 <code>dplyr</code>에 속한 몇몇 함수들의 사용법을 살펴보겠다.</p>
<div id="tidyr로-tidy-데이터-만들기" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> <code>tidyr</code>로 tidy 데이터 만들기<a href="ch6.html#tidyr로-tidy-데이터-만들기" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tidy 데이터 세트는 하나의 열이 한 변수의 자료로만 이루어져 있고, 하나의 행은 한 관찰값의 자료로만 이루어져 있는 데이터 세트를 의미한다. Tidy 자료의 예로서 패키지 <code>tidyr</code>에 있는 데이터 프레임 <code>table1</code>을 살펴보자.</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="ch6.html#cb663-1" tabindex="-1"></a>table1</span>
<span id="cb663-2"><a href="ch6.html#cb663-2" tabindex="-1"></a><span class="do">## # A tibble: 6 × 4</span></span>
<span id="cb663-3"><a href="ch6.html#cb663-3" tabindex="-1"></a><span class="do">##   country      year  cases population</span></span>
<span id="cb663-4"><a href="ch6.html#cb663-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb663-5"><a href="ch6.html#cb663-5" tabindex="-1"></a><span class="do">## 1 Afghanistan  1999    745   19987071</span></span>
<span id="cb663-6"><a href="ch6.html#cb663-6" tabindex="-1"></a><span class="do">## 2 Afghanistan  2000   2666   20595360</span></span>
<span id="cb663-7"><a href="ch6.html#cb663-7" tabindex="-1"></a><span class="do">## 3 Brazil       1999  37737  172006362</span></span>
<span id="cb663-8"><a href="ch6.html#cb663-8" tabindex="-1"></a><span class="do">## 4 Brazil       2000  80488  174504898</span></span>
<span id="cb663-9"><a href="ch6.html#cb663-9" tabindex="-1"></a><span class="do">## 5 China        1999 212258 1272915272</span></span>
<span id="cb663-10"><a href="ch6.html#cb663-10" tabindex="-1"></a><span class="do">## 6 China        2000 213766 1280428583</span></span></code></pre></div>
<p>적절한 통계분석을 실시하기 위해 반드시 갖추어야 할 데이터 세트의 형태라고 할 수 있다. 하지만 실제 접하게 될 데이터 세트는 tidy 데이터가 아닌 경우가 상당히 많이 있으며, 이런 경우 데이터 세트를 통계분석이 가능한 형태로 변경하는데 많은 시간과 노력이 필요하게 된다.</p>
<p>패키지 tidyr은 통계분석이 불가능한 온갖 형태의 데이터 세트를 tidy 데이터 세트로 전환하는 작업을 수행하기 위한 패키지이다.</p>
<div id="데이터-피벗-pivot_longer와-pivot_wider" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> 데이터 피벗: <code>pivot_longer()</code>와 <code>pivot_wider()</code><a href="ch6.html#데이터-피벗-pivot_longer와-pivot_wider" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>통계분석이 불가능한 형태의 데이터 세트가 공통적으로 가지고 있는 주된 문제는 다음과 같다.</p>
<ul>
<li><p>한 변수의 자료가 여러 개의 열에 입력되어 있다.</p></li>
<li><p>한 관찰값의 자료가 여러 개의 행에 입력되어 있다.</p></li>
</ul>
<p>첫 번째 문제는 여러 열에 입력된 한 변수의 자료를 하나의 열로 모아야 해결된다. 따라서 원래 데이터 프레임보다 열의 개수가 줄어든 형태, 즉 더 길어진 형태의 데이터 프레임으로 변환시키는 작업이 되며, 함수 <code>pivot_longer()</code>로 하게 된다.</p>
<p>두 번째 문제는 하나의 열에 여러 변수의 자료가 입력된 형태가 되는 것이므로 열의 개수를 늘려서 각 변수를 따로따로 입력해야 한다. 따라서 원래 데이터 프레임보다 열의 개수가 늘어난 형태, 즉 더 넓어진 형태의 데이터 프레임으로 변환시키는 작업이 되며, 함수 <code>pivot_wider()</code>로 하게 된다.</p>
<p><strong>1. 함수 <code>pivot_longer()</code></strong></p>
<p>패키지 <code>tidyr</code>에 있는 데이터 프레임 <code>table4a</code>를 살펴보자. 숫자로 이름이 시작된 두 번째와 세 번째 변수의 이름은 backtick 기호로 감싸져 있다.</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="ch6.html#cb664-1" tabindex="-1"></a>table4a</span>
<span id="cb664-2"><a href="ch6.html#cb664-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 3</span></span>
<span id="cb664-3"><a href="ch6.html#cb664-3" tabindex="-1"></a><span class="do">##   country     `1999` `2000`</span></span>
<span id="cb664-4"><a href="ch6.html#cb664-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb664-5"><a href="ch6.html#cb664-5" tabindex="-1"></a><span class="do">## 1 Afghanistan    745   2666</span></span>
<span id="cb664-6"><a href="ch6.html#cb664-6" tabindex="-1"></a><span class="do">## 2 Brazil       37737  80488</span></span>
<span id="cb664-7"><a href="ch6.html#cb664-7" tabindex="-1"></a><span class="do">## 3 China       212258 213766</span></span></code></pre></div>
<p>데이터 프레임 <code>table4a</code>는 <code>table1</code>의 변수 <code>cases</code>가 두 개의 열에 흩어져 입력되어 있는 형태이다. 이것을 <code>table1</code>과 같은 tidy 데이터 형태로 변형하기 위해서는 열 이름인 <code>1999</code>와 <code>2000</code>이 변수 <code>year</code>의 자료가 되어야 하고, 두 열에 흩어진 자료는 변수 <code>cases</code>의 자료가 되어야 한다.</p>
<p>함수 <code>pivot_longer()</code>의 기본적인 사용법은 <code>pivot_longer(data, cols, names_to = “name”, values_to = “value”)</code>이다. <code>data</code>는 피벗 대상이 되는 데이터 프레임이고, <code>cols</code>에는 한 변수의 자료가 흩어져 입력된 열을 <code>&lt;tidy-select&gt;</code> 방식으로 선택하면 된다. 또한 <code>names_to</code>에는 선택된 열들의 이름이 자료로 입력될 새로운 열 이름을 지정하고, <code>values_to</code>에는 흩어진 자료들을 하나로 합쳐서 입력할 열 이름을 지정하는 것이다.</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="ch6.html#cb665-1" tabindex="-1"></a>table4a <span class="sc">|&gt;</span></span>
<span id="cb665-2"><a href="ch6.html#cb665-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>country, <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;cases&quot;</span>)</span>
<span id="cb665-3"><a href="ch6.html#cb665-3" tabindex="-1"></a><span class="do">## # A tibble: 6 × 3</span></span>
<span id="cb665-4"><a href="ch6.html#cb665-4" tabindex="-1"></a><span class="do">##   country     year   cases</span></span>
<span id="cb665-5"><a href="ch6.html#cb665-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;</span></span>
<span id="cb665-6"><a href="ch6.html#cb665-6" tabindex="-1"></a><span class="do">## 1 Afghanistan 1999     745</span></span>
<span id="cb665-7"><a href="ch6.html#cb665-7" tabindex="-1"></a><span class="do">## 2 Afghanistan 2000    2666</span></span>
<span id="cb665-8"><a href="ch6.html#cb665-8" tabindex="-1"></a><span class="do">## 3 Brazil      1999   37737</span></span>
<span id="cb665-9"><a href="ch6.html#cb665-9" tabindex="-1"></a><span class="do">## 4 Brazil      2000   80488</span></span>
<span id="cb665-10"><a href="ch6.html#cb665-10" tabindex="-1"></a><span class="do">## 5 China       1999  212258</span></span>
<span id="cb665-11"><a href="ch6.html#cb665-11" tabindex="-1"></a><span class="do">## 6 China       2000  213766</span></span></code></pre></div>
<p>다른 예제로 데이터 프레임 <code>df_1</code>에 어떤 제품의 3년간 분기별 판매량이 입력되어 있다고 하자.</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="ch6.html#cb666-1" tabindex="-1"></a>df_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Year =</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2017</span>, <span class="at">Q1 =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">22</span>),</span>
<span id="cb666-2"><a href="ch6.html#cb666-2" tabindex="-1"></a>               <span class="at">Q2 =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">23</span>), <span class="at">Q3 =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">27</span>, <span class="dv">24</span>),</span>
<span id="cb666-3"><a href="ch6.html#cb666-3" tabindex="-1"></a>               <span class="at">Q4 =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">23</span>, <span class="dv">20</span>))</span>
<span id="cb666-4"><a href="ch6.html#cb666-4" tabindex="-1"></a>df_1</span>
<span id="cb666-5"><a href="ch6.html#cb666-5" tabindex="-1"></a><span class="do">## # A tibble: 3 × 5</span></span>
<span id="cb666-6"><a href="ch6.html#cb666-6" tabindex="-1"></a><span class="do">##    Year    Q1    Q2    Q3    Q4</span></span>
<span id="cb666-7"><a href="ch6.html#cb666-7" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb666-8"><a href="ch6.html#cb666-8" tabindex="-1"></a><span class="do">## 1  2015    15    16    19    17</span></span>
<span id="cb666-9"><a href="ch6.html#cb666-9" tabindex="-1"></a><span class="do">## 2  2016    12    13    27    23</span></span>
<span id="cb666-10"><a href="ch6.html#cb666-10" tabindex="-1"></a><span class="do">## 3  2017    22    23    24    20</span></span></code></pre></div>
<p><code>df_1</code>은 시계열 자료를 표현할 때 일반적으로 사용되는 형태로 구성되어 있다. 그러나 판매량이라는 한 변수의 자료가 4개의 열에 흩어져 있어서 tidy 데이터의 형태는 아니며, 이것을 tidy 데이터로 변환하는 과정은 다음과 같다.</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="ch6.html#cb667-1" tabindex="-1"></a>df_1 <span class="sc">|&gt;</span></span>
<span id="cb667-2"><a href="ch6.html#cb667-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Year, <span class="at">names_to =</span> <span class="st">&quot;Qtr&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Sales&quot;</span>) </span>
<span id="cb667-3"><a href="ch6.html#cb667-3" tabindex="-1"></a><span class="do">## # A tibble: 12 × 3</span></span>
<span id="cb667-4"><a href="ch6.html#cb667-4" tabindex="-1"></a><span class="do">##     Year Qtr   Sales</span></span>
<span id="cb667-5"><a href="ch6.html#cb667-5" tabindex="-1"></a><span class="do">##    &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb667-6"><a href="ch6.html#cb667-6" tabindex="-1"></a><span class="do">##  1  2015 Q1       15</span></span>
<span id="cb667-7"><a href="ch6.html#cb667-7" tabindex="-1"></a><span class="do">##  2  2015 Q2       16</span></span>
<span id="cb667-8"><a href="ch6.html#cb667-8" tabindex="-1"></a><span class="do">##  3  2015 Q3       19</span></span>
<span id="cb667-9"><a href="ch6.html#cb667-9" tabindex="-1"></a><span class="do">##  4  2015 Q4       17</span></span>
<span id="cb667-10"><a href="ch6.html#cb667-10" tabindex="-1"></a><span class="do">##  5  2016 Q1       12</span></span>
<span id="cb667-11"><a href="ch6.html#cb667-11" tabindex="-1"></a><span class="do">##  6  2016 Q2       13</span></span>
<span id="cb667-12"><a href="ch6.html#cb667-12" tabindex="-1"></a><span class="do">##  7  2016 Q3       27</span></span>
<span id="cb667-13"><a href="ch6.html#cb667-13" tabindex="-1"></a><span class="do">##  8  2016 Q4       23</span></span>
<span id="cb667-14"><a href="ch6.html#cb667-14" tabindex="-1"></a><span class="do">##  9  2017 Q1       22</span></span>
<span id="cb667-15"><a href="ch6.html#cb667-15" tabindex="-1"></a><span class="do">## 10  2017 Q2       23</span></span>
<span id="cb667-16"><a href="ch6.html#cb667-16" tabindex="-1"></a><span class="do">## 11  2017 Q3       24</span></span>
<span id="cb667-17"><a href="ch6.html#cb667-17" tabindex="-1"></a><span class="do">## 12  2017 Q4       20</span></span></code></pre></div>
<ul>
<li>예제: <code>tidyr::billboard</code></li>
</ul>
<p>데이터 프레임 <code>tidyr::billboard</code>에는 2000년 Billboard Top 100에 오른 노래의 가수(<code>artist</code>)와 노래 제목(<code>track</code>), top 100 리스트에 들어간 날짜(<code>date.entered</code>), 그리고 리스트에 오른 이후의 매주 순위가 변수<code>wk1</code>부터 <code>wk76</code>까지 입력되어 있다. 해당 노래가 top 100 리스트에서 제외되면 <code>NA</code>가 입력되기 때문에, 변수 <code>wk1</code>부터 <code>wk76</code>에는 <code>NA</code>가 많이 입력되어 있다. 특히 <code>wk66</code>부터 <code>wk76</code>까지는 모든 자료가 <code>NA</code>로 입력되어서 변수 유형이 논리형으로 되어 있다.</p>
<p>우리가 원하는 첫 번째 분석은 매주 연속해서 top 100에 올라있던 노래만을 대상으로 리스트에 머물러 있던 최장 기간과 그 기간 중 최고 순위를 알아내는 것이다.</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="ch6.html#cb668-1" tabindex="-1"></a>billboard <span class="sc">|&gt;</span> </span>
<span id="cb668-2"><a href="ch6.html#cb668-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb668-3"><a href="ch6.html#cb668-3" tabindex="-1"></a><span class="do">## # A tibble: 317 × 79</span></span>
<span id="cb668-4"><a href="ch6.html#cb668-4" tabindex="-1"></a><span class="do">##   artist      track date.entered   wk1   wk2   wk3   wk4   wk5   wk6   wk7   wk8</span></span>
<span id="cb668-5"><a href="ch6.html#cb668-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;chr&gt; &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb668-6"><a href="ch6.html#cb668-6" tabindex="-1"></a><span class="do">## 1 2 Pac       Baby… 2000-02-26      87    82    72    77    87    94    99    NA</span></span>
<span id="cb668-7"><a href="ch6.html#cb668-7" tabindex="-1"></a><span class="do">## 2 2Ge+her     The … 2000-09-02      91    87    92    NA    NA    NA    NA    NA</span></span>
<span id="cb668-8"><a href="ch6.html#cb668-8" tabindex="-1"></a><span class="do">## 3 3 Doors Do… Kryp… 2000-04-08      81    70    68    67    66    57    54    53</span></span>
<span id="cb668-9"><a href="ch6.html#cb668-9" tabindex="-1"></a><span class="do">## 4 3 Doors Do… Loser 2000-10-21      76    76    72    69    67    65    55    59</span></span>
<span id="cb668-10"><a href="ch6.html#cb668-10" tabindex="-1"></a><span class="do">## 5 504 Boyz    Wobb… 2000-04-15      57    34    25    17    17    31    36    49</span></span>
<span id="cb668-11"><a href="ch6.html#cb668-11" tabindex="-1"></a><span class="do">## # ℹ 312 more rows</span></span>
<span id="cb668-12"><a href="ch6.html#cb668-12" tabindex="-1"></a><span class="do">## # ℹ 68 more variables: wk9 &lt;dbl&gt;, wk10 &lt;dbl&gt;, wk11 &lt;dbl&gt;, wk12 &lt;dbl&gt;,</span></span>
<span id="cb668-13"><a href="ch6.html#cb668-13" tabindex="-1"></a><span class="do">## #   wk13 &lt;dbl&gt;, wk14 &lt;dbl&gt;, wk15 &lt;dbl&gt;, wk16 &lt;dbl&gt;, wk17 &lt;dbl&gt;, wk18 &lt;dbl&gt;,</span></span>
<span id="cb668-14"><a href="ch6.html#cb668-14" tabindex="-1"></a><span class="do">## #   wk19 &lt;dbl&gt;, wk20 &lt;dbl&gt;, wk21 &lt;dbl&gt;, wk22 &lt;dbl&gt;, wk23 &lt;dbl&gt;, wk24 &lt;dbl&gt;,</span></span>
<span id="cb668-15"><a href="ch6.html#cb668-15" tabindex="-1"></a><span class="do">## #   wk25 &lt;dbl&gt;, wk26 &lt;dbl&gt;, wk27 &lt;dbl&gt;, wk28 &lt;dbl&gt;, wk29 &lt;dbl&gt;, wk30 &lt;dbl&gt;,</span></span>
<span id="cb668-16"><a href="ch6.html#cb668-16" tabindex="-1"></a><span class="do">## #   wk31 &lt;dbl&gt;, wk32 &lt;dbl&gt;, wk33 &lt;dbl&gt;, wk34 &lt;dbl&gt;, wk35 &lt;dbl&gt;, wk36 &lt;dbl&gt;,</span></span>
<span id="cb668-17"><a href="ch6.html#cb668-17" tabindex="-1"></a><span class="do">## #   wk37 &lt;dbl&gt;, wk38 &lt;dbl&gt;, wk39 &lt;dbl&gt;, wk40 &lt;dbl&gt;, wk41 &lt;dbl&gt;, wk42 &lt;dbl&gt;, …</span></span></code></pre></div>
<p>이런 구조의 데이터는 매우 흔하게 볼 수 있는 것이며, tidy 데이터 구조로 오해하기도 한다.
그러나 변수 <code>wk1</code>부터 <code>wk76</code>은 모두 노래의 ’순위’이기 때문에 하나의 열에 입력이 되어야 적절한 통계분석이 가능하게 된다.
따라서 열 <code>wk1</code>부터 <code>wk76</code>까지에 입력된 자료는 <code>rank</code>라는 이름의 열로 모으고, 열의 이름은 <code>week</code>라는 이름의 열에 입력해 보자. 이 변환 작업은 <code>cols</code>에 <code>wk1:wk76</code> 또는 <code>starts_with("wk")</code>를, <code>names_to</code>에 <code>"week"</code>를, 그리고 <code>values_to</code>에 <code>"rank"</code>를 각각 지정하면 된다.</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="ch6.html#cb669-1" tabindex="-1"></a>billboard <span class="sc">|&gt;</span> </span>
<span id="cb669-2"><a href="ch6.html#cb669-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb669-3"><a href="ch6.html#cb669-3" tabindex="-1"></a>    <span class="at">cols =</span> wk1<span class="sc">:</span>wk76,</span>
<span id="cb669-4"><a href="ch6.html#cb669-4" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb669-5"><a href="ch6.html#cb669-5" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;rank&quot;</span></span>
<span id="cb669-6"><a href="ch6.html#cb669-6" tabindex="-1"></a>    )</span>
<span id="cb669-7"><a href="ch6.html#cb669-7" tabindex="-1"></a><span class="do">## # A tibble: 24,092 × 5</span></span>
<span id="cb669-8"><a href="ch6.html#cb669-8" tabindex="-1"></a><span class="do">##    artist track                   date.entered week   rank</span></span>
<span id="cb669-9"><a href="ch6.html#cb669-9" tabindex="-1"></a><span class="do">##    &lt;chr&gt;  &lt;chr&gt;                   &lt;date&gt;       &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb669-10"><a href="ch6.html#cb669-10" tabindex="-1"></a><span class="do">##  1 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk1      87</span></span>
<span id="cb669-11"><a href="ch6.html#cb669-11" tabindex="-1"></a><span class="do">##  2 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk2      82</span></span>
<span id="cb669-12"><a href="ch6.html#cb669-12" tabindex="-1"></a><span class="do">##  3 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk3      72</span></span>
<span id="cb669-13"><a href="ch6.html#cb669-13" tabindex="-1"></a><span class="do">##  4 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk4      77</span></span>
<span id="cb669-14"><a href="ch6.html#cb669-14" tabindex="-1"></a><span class="do">##  5 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk5      87</span></span>
<span id="cb669-15"><a href="ch6.html#cb669-15" tabindex="-1"></a><span class="do">##  6 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk6      94</span></span>
<span id="cb669-16"><a href="ch6.html#cb669-16" tabindex="-1"></a><span class="do">##  7 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk7      99</span></span>
<span id="cb669-17"><a href="ch6.html#cb669-17" tabindex="-1"></a><span class="do">##  8 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk8      NA</span></span>
<span id="cb669-18"><a href="ch6.html#cb669-18" tabindex="-1"></a><span class="do">##  9 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk9      NA</span></span>
<span id="cb669-19"><a href="ch6.html#cb669-19" tabindex="-1"></a><span class="do">## 10 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk10     NA</span></span>
<span id="cb669-20"><a href="ch6.html#cb669-20" tabindex="-1"></a><span class="do">## # ℹ 24,082 more rows</span></span></code></pre></div>
<p>변수 <code>week</code>에는 문자형 자료가 입력되어 있는데, 정수형으로 전환되면 더 효과적인 분석이 가능할 것이다.
또한 변수 <code>rank</code>에는 많은 <code>NA</code>가 포함되어 있는데, <code>NA</code>가 입력된 행을 제거하는 것이 분석에 도움이 될 것이다.
이 작업은 함수 <code>pivot_longer()</code>의 추가 기능을 사용해서 진행하는 방법과 함수 <code>mutate()</code> 등을 이어서 사용해서 진행하는 방법을 생각해 볼 수 있다.</p>
<p>먼저 함수 <code>pivot_longer()</code>의 추가 기능을 사용해 보자.
변수 <code>week</code>를 정수형으로 전환하기 위해서는 문자열 <code>"wk"</code>를 제거하고, 변수의 유형을 정수형으로 바꾸면 되는데,
함수 <code>pivot_longer()</code>에 <code>names_prefix</code>와 <code>names_transform</code>을 추가하면 된다.
<code>names_prefix</code>에는 <code>names_to</code>에 입력된 열 이름에서 제거하려는 문자열을 정규표현식으로 지정하면 되는데, 첫 문자부터 제거하는 경우에만 적용이 된다. 이 경우에는 그냥 <code>"wk"</code>를 지정하면 된다.
<code>names_transform</code>은 열의 유형을 변경할 때 사용하는 것으로 <code>열이름 = 유형 변환 함수</code>가 입력된 리스트를 지정하면 된다.</p>
<p>또한 변수 <code>rank</code>에 <code>NA</code>가 입력된 행을 제거하는 것은 <code>values_drop_na</code>에 <code>TRUE</code>를 지정하면 <code>values_to</code>로 지정된 열에 <code>NA</code>가 입력되는 행은 자동으로 제거된다. 자료의 특성으로 <code>NA</code>가 많을 수밖에 없는 경우에는 필요한 옵션이 된다.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="ch6.html#cb670-1" tabindex="-1"></a>top_100 <span class="ot">&lt;-</span> billboard <span class="sc">|&gt;</span> </span>
<span id="cb670-2"><a href="ch6.html#cb670-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb670-3"><a href="ch6.html#cb670-3" tabindex="-1"></a>    <span class="at">cols =</span> wk1<span class="sc">:</span>wk76, </span>
<span id="cb670-4"><a href="ch6.html#cb670-4" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb670-5"><a href="ch6.html#cb670-5" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">&quot;wk&quot;</span>,</span>
<span id="cb670-6"><a href="ch6.html#cb670-6" tabindex="-1"></a>    <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">week =</span> as.integer),</span>
<span id="cb670-7"><a href="ch6.html#cb670-7" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;rank&quot;</span>,</span>
<span id="cb670-8"><a href="ch6.html#cb670-8" tabindex="-1"></a>    <span class="at">values_drop_na =</span> <span class="cn">TRUE</span></span>
<span id="cb670-9"><a href="ch6.html#cb670-9" tabindex="-1"></a>  )</span>
<span id="cb670-10"><a href="ch6.html#cb670-10" tabindex="-1"></a>top_100 <span class="sc">|&gt;</span> </span>
<span id="cb670-11"><a href="ch6.html#cb670-11" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb670-12"><a href="ch6.html#cb670-12" tabindex="-1"></a><span class="do">## # A tibble: 5,307 × 5</span></span>
<span id="cb670-13"><a href="ch6.html#cb670-13" tabindex="-1"></a><span class="do">##   artist track                   date.entered  week  rank</span></span>
<span id="cb670-14"><a href="ch6.html#cb670-14" tabindex="-1"></a><span class="do">##   &lt;chr&gt;  &lt;chr&gt;                   &lt;date&gt;       &lt;int&gt; &lt;dbl&gt;</span></span>
<span id="cb670-15"><a href="ch6.html#cb670-15" tabindex="-1"></a><span class="do">## 1 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       1    87</span></span>
<span id="cb670-16"><a href="ch6.html#cb670-16" tabindex="-1"></a><span class="do">## 2 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       2    82</span></span>
<span id="cb670-17"><a href="ch6.html#cb670-17" tabindex="-1"></a><span class="do">## 3 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       3    72</span></span>
<span id="cb670-18"><a href="ch6.html#cb670-18" tabindex="-1"></a><span class="do">## 4 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       4    77</span></span>
<span id="cb670-19"><a href="ch6.html#cb670-19" tabindex="-1"></a><span class="do">## 5 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       5    87</span></span>
<span id="cb670-20"><a href="ch6.html#cb670-20" tabindex="-1"></a><span class="do">## # ℹ 5,302 more rows</span></span></code></pre></div>
<p>이번에는 함수 <code>mutate()</code> 등을 이어서 사용하는 방법을 살펴보자.
변수 <code>week</code>의 자료에서 문자열 <code>"wk"</code>를 제거하고 변수의 유형을 정수형으로 바꾸는 작업은 <code>gsub()</code>와 <code>as.integer()</code>를 <code>mutate()</code>에서 사용하면 된다.</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="ch6.html#cb671-1" tabindex="-1"></a>billboard <span class="sc">|&gt;</span> </span>
<span id="cb671-2"><a href="ch6.html#cb671-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb671-3"><a href="ch6.html#cb671-3" tabindex="-1"></a>    <span class="at">cols =</span> wk1<span class="sc">:</span>wk76,</span>
<span id="cb671-4"><a href="ch6.html#cb671-4" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb671-5"><a href="ch6.html#cb671-5" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;rank&quot;</span></span>
<span id="cb671-6"><a href="ch6.html#cb671-6" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb671-7"><a href="ch6.html#cb671-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">gsub</span>(<span class="st">&quot;wk&quot;</span>, <span class="st">&quot;&quot;</span>, week)) <span class="sc">|&gt;</span> </span>
<span id="cb671-8"><a href="ch6.html#cb671-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">as.integer</span>(week))</span>
<span id="cb671-9"><a href="ch6.html#cb671-9" tabindex="-1"></a><span class="do">## # A tibble: 24,092 × 5</span></span>
<span id="cb671-10"><a href="ch6.html#cb671-10" tabindex="-1"></a><span class="do">##    artist track                   date.entered  week  rank</span></span>
<span id="cb671-11"><a href="ch6.html#cb671-11" tabindex="-1"></a><span class="do">##    &lt;chr&gt;  &lt;chr&gt;                   &lt;date&gt;       &lt;int&gt; &lt;dbl&gt;</span></span>
<span id="cb671-12"><a href="ch6.html#cb671-12" tabindex="-1"></a><span class="do">##  1 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       1    87</span></span>
<span id="cb671-13"><a href="ch6.html#cb671-13" tabindex="-1"></a><span class="do">##  2 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       2    82</span></span>
<span id="cb671-14"><a href="ch6.html#cb671-14" tabindex="-1"></a><span class="do">##  3 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       3    72</span></span>
<span id="cb671-15"><a href="ch6.html#cb671-15" tabindex="-1"></a><span class="do">##  4 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       4    77</span></span>
<span id="cb671-16"><a href="ch6.html#cb671-16" tabindex="-1"></a><span class="do">##  5 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       5    87</span></span>
<span id="cb671-17"><a href="ch6.html#cb671-17" tabindex="-1"></a><span class="do">##  6 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       6    94</span></span>
<span id="cb671-18"><a href="ch6.html#cb671-18" tabindex="-1"></a><span class="do">##  7 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       7    99</span></span>
<span id="cb671-19"><a href="ch6.html#cb671-19" tabindex="-1"></a><span class="do">##  8 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       8    NA</span></span>
<span id="cb671-20"><a href="ch6.html#cb671-20" tabindex="-1"></a><span class="do">##  9 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26       9    NA</span></span>
<span id="cb671-21"><a href="ch6.html#cb671-21" tabindex="-1"></a><span class="do">## 10 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26      10    NA</span></span>
<span id="cb671-22"><a href="ch6.html#cb671-22" tabindex="-1"></a><span class="do">## # ℹ 24,082 more rows</span></span></code></pre></div>
<p>숫자가 포함된 문자형 벡터에서 문자나 기호 등을 제거하고 숫자형 벡터로 전환하는 작업은 함수 <code>readr::parse_number()</code>로도 진행할 수 있다.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="ch6.html#cb672-1" tabindex="-1"></a><span class="fu">parse_number</span>(<span class="fu">c</span>(<span class="st">&quot;$1,000&quot;</span>, <span class="st">&quot;$12,345.50&quot;</span>))</span>
<span id="cb672-2"><a href="ch6.html#cb672-2" tabindex="-1"></a><span class="do">## [1]  1000.0 12345.5</span></span></code></pre></div>
<p>데이터 프레임에서 <code>NA</code>가 입력된 행을 제거하는 작업은 함수 <code>tidyr::drop_na()</code>로 진행할 수 있다.
변수를 지정하면 해당 변수에 <code>NA</code>가 있는 행을 제거하게 된다.
변수는 <code>&lt;tidy-select&gt;</code> 방식으로 지정할 수 있으며, 생략하면 모든 변수를 대상으로 <code>NA</code>가 있는지 여부를 확인하게 된다.</p>
<p>함수 <code>parse_number()</code>와 <code>drop_na()</code>를 사용해서 필요한 작업을 진행해 보자.</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="ch6.html#cb673-1" tabindex="-1"></a>billboard <span class="sc">|&gt;</span> </span>
<span id="cb673-2"><a href="ch6.html#cb673-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb673-3"><a href="ch6.html#cb673-3" tabindex="-1"></a>    <span class="at">cols =</span> wk1<span class="sc">:</span>wk76,</span>
<span id="cb673-4"><a href="ch6.html#cb673-4" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb673-5"><a href="ch6.html#cb673-5" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;rank&quot;</span></span>
<span id="cb673-6"><a href="ch6.html#cb673-6" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb673-7"><a href="ch6.html#cb673-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">parse_number</span>(week)) <span class="sc">|&gt;</span> </span>
<span id="cb673-8"><a href="ch6.html#cb673-8" tabindex="-1"></a>  <span class="fu">drop_na</span>(rank)</span>
<span id="cb673-9"><a href="ch6.html#cb673-9" tabindex="-1"></a><span class="do">## # A tibble: 5,307 × 5</span></span>
<span id="cb673-10"><a href="ch6.html#cb673-10" tabindex="-1"></a><span class="do">##    artist  track                   date.entered  week  rank</span></span>
<span id="cb673-11"><a href="ch6.html#cb673-11" tabindex="-1"></a><span class="do">##    &lt;chr&gt;   &lt;chr&gt;                   &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb673-12"><a href="ch6.html#cb673-12" tabindex="-1"></a><span class="do">##  1 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       1    87</span></span>
<span id="cb673-13"><a href="ch6.html#cb673-13" tabindex="-1"></a><span class="do">##  2 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       2    82</span></span>
<span id="cb673-14"><a href="ch6.html#cb673-14" tabindex="-1"></a><span class="do">##  3 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       3    72</span></span>
<span id="cb673-15"><a href="ch6.html#cb673-15" tabindex="-1"></a><span class="do">##  4 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       4    77</span></span>
<span id="cb673-16"><a href="ch6.html#cb673-16" tabindex="-1"></a><span class="do">##  5 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       5    87</span></span>
<span id="cb673-17"><a href="ch6.html#cb673-17" tabindex="-1"></a><span class="do">##  6 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       6    94</span></span>
<span id="cb673-18"><a href="ch6.html#cb673-18" tabindex="-1"></a><span class="do">##  7 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       7    99</span></span>
<span id="cb673-19"><a href="ch6.html#cb673-19" tabindex="-1"></a><span class="do">##  8 2Ge+her The Hardest Part Of ... 2000-09-02       1    91</span></span>
<span id="cb673-20"><a href="ch6.html#cb673-20" tabindex="-1"></a><span class="do">##  9 2Ge+her The Hardest Part Of ... 2000-09-02       2    87</span></span>
<span id="cb673-21"><a href="ch6.html#cb673-21" tabindex="-1"></a><span class="do">## 10 2Ge+her The Hardest Part Of ... 2000-09-02       3    92</span></span>
<span id="cb673-22"><a href="ch6.html#cb673-22" tabindex="-1"></a><span class="do">## # ℹ 5,297 more rows</span></span></code></pre></div>
<p>이제 데이터 프레임 <code>top_100</code>을 대상으로 원하는 분석을 할 수 있게 되었다. 매주 연속해서 top 100에 올라있던 노래만을 대상으로 리스트에 머물러 있던 최장 기간과 그 기간 중 최고 순위는 다음과 같이 알아볼 수 있다.</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="ch6.html#cb674-1" tabindex="-1"></a>top_100 <span class="sc">|&gt;</span> </span>
<span id="cb674-2"><a href="ch6.html#cb674-2" tabindex="-1"></a>  <span class="fu">group_by</span>(artist, track) <span class="sc">|&gt;</span> </span>
<span id="cb674-3"><a href="ch6.html#cb674-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">==</span> <span class="fu">max</span>(week)) <span class="sc">|&gt;</span> </span>
<span id="cb674-4"><a href="ch6.html#cb674-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">period =</span> <span class="fu">max</span>(week), <span class="at">top_rank =</span> <span class="fu">min</span>(rank)) <span class="sc">|&gt;</span> </span>
<span id="cb674-5"><a href="ch6.html#cb674-5" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb674-6"><a href="ch6.html#cb674-6" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(period)) <span class="sc">|&gt;</span> </span>
<span id="cb674-7"><a href="ch6.html#cb674-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb674-8"><a href="ch6.html#cb674-8" tabindex="-1"></a><span class="do">## # A tibble: 302 × 4</span></span>
<span id="cb674-9"><a href="ch6.html#cb674-9" tabindex="-1"></a><span class="do">##   artist           track               period top_rank</span></span>
<span id="cb674-10"><a href="ch6.html#cb674-10" tabindex="-1"></a><span class="do">##   &lt;chr&gt;            &lt;chr&gt;                &lt;int&gt;    &lt;dbl&gt;</span></span>
<span id="cb674-11"><a href="ch6.html#cb674-11" tabindex="-1"></a><span class="do">## 1 3 Doors Down     Kryptonite              53        3</span></span>
<span id="cb674-12"><a href="ch6.html#cb674-12" tabindex="-1"></a><span class="do">## 2 Hill, Faith      Breathe                 53        2</span></span>
<span id="cb674-13"><a href="ch6.html#cb674-13" tabindex="-1"></a><span class="do">## 3 Creed            With Arms Wide Open     47        1</span></span>
<span id="cb674-14"><a href="ch6.html#cb674-14" tabindex="-1"></a><span class="do">## 4 Joe              I Wanna Know            44        4</span></span>
<span id="cb674-15"><a href="ch6.html#cb674-15" tabindex="-1"></a><span class="do">## 5 Vertical Horizon Everything You Want     41        1</span></span>
<span id="cb674-16"><a href="ch6.html#cb674-16" tabindex="-1"></a><span class="do">## # ℹ 297 more rows</span></span></code></pre></div>
<p>두 번째 분석으로써 연속해서 1위를 유지했던 노래 중 가장 오랫동안 정상을 유지했던 2곡을 알아보자.</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="ch6.html#cb675-1" tabindex="-1"></a>top_100 <span class="sc">|&gt;</span> </span>
<span id="cb675-2"><a href="ch6.html#cb675-2" tabindex="-1"></a>    <span class="fu">filter</span>(rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb675-3"><a href="ch6.html#cb675-3" tabindex="-1"></a>    <span class="fu">group_by</span>(artist, track) <span class="sc">|&gt;</span></span>
<span id="cb675-4"><a href="ch6.html#cb675-4" tabindex="-1"></a>    <span class="fu">filter</span>((<span class="fu">max</span>(week) <span class="sc">-</span> <span class="fu">min</span>(week) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">==</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb675-5"><a href="ch6.html#cb675-5" tabindex="-1"></a>    <span class="fu">count</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb675-6"><a href="ch6.html#cb675-6" tabindex="-1"></a>    <span class="fu">print</span>(<span class="at">n=</span><span class="dv">2</span>)</span>
<span id="cb675-7"><a href="ch6.html#cb675-7" tabindex="-1"></a><span class="do">## # A tibble: 16 × 3</span></span>
<span id="cb675-8"><a href="ch6.html#cb675-8" tabindex="-1"></a><span class="do">## # Groups:   artist, track [16]</span></span>
<span id="cb675-9"><a href="ch6.html#cb675-9" tabindex="-1"></a><span class="do">##   artist          track                       n</span></span>
<span id="cb675-10"><a href="ch6.html#cb675-10" tabindex="-1"></a><span class="do">##   &lt;chr&gt;           &lt;chr&gt;                   &lt;int&gt;</span></span>
<span id="cb675-11"><a href="ch6.html#cb675-11" tabindex="-1"></a><span class="do">## 1 Destiny&#39;s Child Independent Women Pa...    11</span></span>
<span id="cb675-12"><a href="ch6.html#cb675-12" tabindex="-1"></a><span class="do">## 2 Santana         Maria, Maria               10</span></span>
<span id="cb675-13"><a href="ch6.html#cb675-13" tabindex="-1"></a><span class="do">## # ℹ 14 more rows</span></span></code></pre></div>
<ul>
<li>예제: <code>tidyr::who2</code></li>
</ul>
<p>데이터 프레임 <code>who2</code>의 내용을 확인해 보자.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="ch6.html#cb676-1" tabindex="-1"></a>who2</span>
<span id="cb676-2"><a href="ch6.html#cb676-2" tabindex="-1"></a><span class="do">## # A tibble: 7,240 × 58</span></span>
<span id="cb676-3"><a href="ch6.html#cb676-3" tabindex="-1"></a><span class="do">##    country      year sp_m_014 sp_m_1524 sp_m_2534 sp_m_3544 sp_m_4554 sp_m_5564</span></span>
<span id="cb676-4"><a href="ch6.html#cb676-4" tabindex="-1"></a><span class="do">##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb676-5"><a href="ch6.html#cb676-5" tabindex="-1"></a><span class="do">##  1 Afghanistan  1980       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-6"><a href="ch6.html#cb676-6" tabindex="-1"></a><span class="do">##  2 Afghanistan  1981       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-7"><a href="ch6.html#cb676-7" tabindex="-1"></a><span class="do">##  3 Afghanistan  1982       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-8"><a href="ch6.html#cb676-8" tabindex="-1"></a><span class="do">##  4 Afghanistan  1983       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-9"><a href="ch6.html#cb676-9" tabindex="-1"></a><span class="do">##  5 Afghanistan  1984       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-10"><a href="ch6.html#cb676-10" tabindex="-1"></a><span class="do">##  6 Afghanistan  1985       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-11"><a href="ch6.html#cb676-11" tabindex="-1"></a><span class="do">##  7 Afghanistan  1986       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-12"><a href="ch6.html#cb676-12" tabindex="-1"></a><span class="do">##  8 Afghanistan  1987       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-13"><a href="ch6.html#cb676-13" tabindex="-1"></a><span class="do">##  9 Afghanistan  1988       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-14"><a href="ch6.html#cb676-14" tabindex="-1"></a><span class="do">## 10 Afghanistan  1989       NA        NA        NA        NA        NA        NA</span></span>
<span id="cb676-15"><a href="ch6.html#cb676-15" tabindex="-1"></a><span class="do">## # ℹ 7,230 more rows</span></span>
<span id="cb676-16"><a href="ch6.html#cb676-16" tabindex="-1"></a><span class="do">## # ℹ 50 more variables: sp_m_65 &lt;dbl&gt;, sp_f_014 &lt;dbl&gt;, sp_f_1524 &lt;dbl&gt;,</span></span>
<span id="cb676-17"><a href="ch6.html#cb676-17" tabindex="-1"></a><span class="do">## #   sp_f_2534 &lt;dbl&gt;, sp_f_3544 &lt;dbl&gt;, sp_f_4554 &lt;dbl&gt;, sp_f_5564 &lt;dbl&gt;,</span></span>
<span id="cb676-18"><a href="ch6.html#cb676-18" tabindex="-1"></a><span class="do">## #   sp_f_65 &lt;dbl&gt;, sn_m_014 &lt;dbl&gt;, sn_m_1524 &lt;dbl&gt;, sn_m_2534 &lt;dbl&gt;,</span></span>
<span id="cb676-19"><a href="ch6.html#cb676-19" tabindex="-1"></a><span class="do">## #   sn_m_3544 &lt;dbl&gt;, sn_m_4554 &lt;dbl&gt;, sn_m_5564 &lt;dbl&gt;, sn_m_65 &lt;dbl&gt;,</span></span>
<span id="cb676-20"><a href="ch6.html#cb676-20" tabindex="-1"></a><span class="do">## #   sn_f_014 &lt;dbl&gt;, sn_f_1524 &lt;dbl&gt;, sn_f_2534 &lt;dbl&gt;, sn_f_3544 &lt;dbl&gt;,</span></span>
<span id="cb676-21"><a href="ch6.html#cb676-21" tabindex="-1"></a><span class="do">## #   sn_f_4554 &lt;dbl&gt;, sn_f_5564 &lt;dbl&gt;, sn_f_65 &lt;dbl&gt;, ep_m_014 &lt;dbl&gt;, …</span></span></code></pre></div>
<p>이 데이터는 1908년부터 2013년까지 219개 나라를 대상으로 결핵에 걸린 환자에 대한 것이다.
변수 <code>country</code>와 <code>year</code>에는 조사한 나라 이름과 조사 연도가 입력되어 있다.
나머지 변수는 세 가지 정보가 밑줄로 구분되어 변수 이름을 구성하고 있다.
첫 번째 부분은 폐결핵 진단 방법을 나타내는 것으로서 “rel”, “sn”, “sp”, “ep” 중 하나이고,
두 번째 부분은 성별을 “f” 혹은 “m”으로 나타내고 있고,
세 번째 부분은 나이 그룹으로서 “014”는 0 ~ 14세, “1524”는 15 ~ 24세 등을 나타내고 있다.</p>
<p>따라서 변수 <code>sp_m_014</code>를 포함한 56개 변수를 하나의 변수로 통합하지 말고, 세 변수로 나누어 통합하는 것이 필요한 데이터가 된다.
통합 대상 변수를 세 변수로 나누어 통합하는 방법은 <code>names_to</code>에 길이가 3인 문자형 벡터로 변수 이름을 지정하고,
<code>names_sep</code>에 통합 대상 변수 이름을 구분하는 구분자를 지정하면 된다.</p>
<p>또한 결핵 환자 수가 입력되는 변수 <code>count</code>에 <code>NA</code>가 입력된 행은 모두 삭제하도록 하자.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="ch6.html#cb677-1" tabindex="-1"></a>who2 <span class="sc">|&gt;</span> </span>
<span id="cb677-2"><a href="ch6.html#cb677-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb677-3"><a href="ch6.html#cb677-3" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">!</span>(country<span class="sc">:</span>year),</span>
<span id="cb677-4"><a href="ch6.html#cb677-4" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;diagnosis&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;age&quot;</span>),</span>
<span id="cb677-5"><a href="ch6.html#cb677-5" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>,</span>
<span id="cb677-6"><a href="ch6.html#cb677-6" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span></span>
<span id="cb677-7"><a href="ch6.html#cb677-7" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb677-8"><a href="ch6.html#cb677-8" tabindex="-1"></a>  <span class="fu">drop_na</span>(count)</span>
<span id="cb677-9"><a href="ch6.html#cb677-9" tabindex="-1"></a><span class="do">## # A tibble: 76,046 × 6</span></span>
<span id="cb677-10"><a href="ch6.html#cb677-10" tabindex="-1"></a><span class="do">##    country      year diagnosis gender age   count</span></span>
<span id="cb677-11"><a href="ch6.html#cb677-11" tabindex="-1"></a><span class="do">##    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb677-12"><a href="ch6.html#cb677-12" tabindex="-1"></a><span class="do">##  1 Afghanistan  1997 sp        m      014       0</span></span>
<span id="cb677-13"><a href="ch6.html#cb677-13" tabindex="-1"></a><span class="do">##  2 Afghanistan  1997 sp        m      1524     10</span></span>
<span id="cb677-14"><a href="ch6.html#cb677-14" tabindex="-1"></a><span class="do">##  3 Afghanistan  1997 sp        m      2534      6</span></span>
<span id="cb677-15"><a href="ch6.html#cb677-15" tabindex="-1"></a><span class="do">##  4 Afghanistan  1997 sp        m      3544      3</span></span>
<span id="cb677-16"><a href="ch6.html#cb677-16" tabindex="-1"></a><span class="do">##  5 Afghanistan  1997 sp        m      4554      5</span></span>
<span id="cb677-17"><a href="ch6.html#cb677-17" tabindex="-1"></a><span class="do">##  6 Afghanistan  1997 sp        m      5564      2</span></span>
<span id="cb677-18"><a href="ch6.html#cb677-18" tabindex="-1"></a><span class="do">##  7 Afghanistan  1997 sp        m      65        0</span></span>
<span id="cb677-19"><a href="ch6.html#cb677-19" tabindex="-1"></a><span class="do">##  8 Afghanistan  1997 sp        f      014       5</span></span>
<span id="cb677-20"><a href="ch6.html#cb677-20" tabindex="-1"></a><span class="do">##  9 Afghanistan  1997 sp        f      1524     38</span></span>
<span id="cb677-21"><a href="ch6.html#cb677-21" tabindex="-1"></a><span class="do">## 10 Afghanistan  1997 sp        f      2534     36</span></span>
<span id="cb677-22"><a href="ch6.html#cb677-22" tabindex="-1"></a><span class="do">## # ℹ 76,036 more rows</span></span></code></pre></div>
<p><strong>2. 함수 <code>pivot_wider()</code></strong></p>
<p>패키지 <code>tidyr</code>에 있는 데이터 프레임 <code>table2</code>를 살펴보자.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="ch6.html#cb678-1" tabindex="-1"></a>table2</span>
<span id="cb678-2"><a href="ch6.html#cb678-2" tabindex="-1"></a><span class="do">## # A tibble: 12 × 4</span></span>
<span id="cb678-3"><a href="ch6.html#cb678-3" tabindex="-1"></a><span class="do">##    country      year type            count</span></span>
<span id="cb678-4"><a href="ch6.html#cb678-4" tabindex="-1"></a><span class="do">##    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span id="cb678-5"><a href="ch6.html#cb678-5" tabindex="-1"></a><span class="do">##  1 Afghanistan  1999 cases             745</span></span>
<span id="cb678-6"><a href="ch6.html#cb678-6" tabindex="-1"></a><span class="do">##  2 Afghanistan  1999 population   19987071</span></span>
<span id="cb678-7"><a href="ch6.html#cb678-7" tabindex="-1"></a><span class="do">##  3 Afghanistan  2000 cases            2666</span></span>
<span id="cb678-8"><a href="ch6.html#cb678-8" tabindex="-1"></a><span class="do">##  4 Afghanistan  2000 population   20595360</span></span>
<span id="cb678-9"><a href="ch6.html#cb678-9" tabindex="-1"></a><span class="do">##  5 Brazil       1999 cases           37737</span></span>
<span id="cb678-10"><a href="ch6.html#cb678-10" tabindex="-1"></a><span class="do">##  6 Brazil       1999 population  172006362</span></span>
<span id="cb678-11"><a href="ch6.html#cb678-11" tabindex="-1"></a><span class="do">##  7 Brazil       2000 cases           80488</span></span>
<span id="cb678-12"><a href="ch6.html#cb678-12" tabindex="-1"></a><span class="do">##  8 Brazil       2000 population  174504898</span></span>
<span id="cb678-13"><a href="ch6.html#cb678-13" tabindex="-1"></a><span class="do">##  9 China        1999 cases          212258</span></span>
<span id="cb678-14"><a href="ch6.html#cb678-14" tabindex="-1"></a><span class="do">## 10 China        1999 population 1272915272</span></span>
<span id="cb678-15"><a href="ch6.html#cb678-15" tabindex="-1"></a><span class="do">## 11 China        2000 cases          213766</span></span>
<span id="cb678-16"><a href="ch6.html#cb678-16" tabindex="-1"></a><span class="do">## 12 China        2000 population 1280428583</span></span></code></pre></div>
<p><code>table2</code>는 개별 국가에 대한 연간 자료인데, 이것이 두 개의 행에 나뉘어 입력되어 있다. 따라서 하나의 열(<code>type</code>)에 두 변수(<code>cases</code>와 <code>population</code>)의 자료가 입력되어 있는 것이다. 이렇게 하나의 열에 입력된 여러 변수의 자료를 분산시키는 작업은 함수 <code>pivot_wider()</code>로 할 수 있다.</p>
<p>기본적인 사용법은 <code>pivot_wider(data, names_from = name, values_from = value)</code>이다. <code>data</code>는 피벗 대상이 되는 데이터 프레임이고, <code>names_from</code>과<code>values_from</code>에는 새롭게 추가되는 열들의 이름이 입력되어 있는 열과 자료가 입력되어 있는 열을 각각 지정하는 것이다.</p>
<p><code>table2</code>의 경우에는 <code>type</code>에 열들의 이름이 입력되어 있고, 자료는 <code>count</code>에 입력되어 있기 때문에, <code>names_from</code>에는 <code>type</code>을, <code>values_from</code>에는 <code>count</code>를 각각 지정하면 된다.</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="ch6.html#cb679-1" tabindex="-1"></a>table2 <span class="sc">|&gt;</span></span>
<span id="cb679-2"><a href="ch6.html#cb679-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> count)</span>
<span id="cb679-3"><a href="ch6.html#cb679-3" tabindex="-1"></a><span class="do">## # A tibble: 6 × 4</span></span>
<span id="cb679-4"><a href="ch6.html#cb679-4" tabindex="-1"></a><span class="do">##   country      year  cases population</span></span>
<span id="cb679-5"><a href="ch6.html#cb679-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb679-6"><a href="ch6.html#cb679-6" tabindex="-1"></a><span class="do">## 1 Afghanistan  1999    745   19987071</span></span>
<span id="cb679-7"><a href="ch6.html#cb679-7" tabindex="-1"></a><span class="do">## 2 Afghanistan  2000   2666   20595360</span></span>
<span id="cb679-8"><a href="ch6.html#cb679-8" tabindex="-1"></a><span class="do">## 3 Brazil       1999  37737  172006362</span></span>
<span id="cb679-9"><a href="ch6.html#cb679-9" tabindex="-1"></a><span class="do">## 4 Brazil       2000  80488  174504898</span></span>
<span id="cb679-10"><a href="ch6.html#cb679-10" tabindex="-1"></a><span class="do">## 5 China        1999 212258 1272915272</span></span>
<span id="cb679-11"><a href="ch6.html#cb679-11" tabindex="-1"></a><span class="do">## 6 China        2000 213766 1280428583</span></span></code></pre></div>
<p>다른 예제로 세 명의 신장과 체중을 입력한 데이터 프레임 <code>df_2</code>를 만들어 보자.</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="ch6.html#cb680-1" tabindex="-1"></a>df_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Name =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Kim&quot;</span>,<span class="st">&quot;Park&quot;</span>,<span class="st">&quot;Lee&quot;</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb680-2"><a href="ch6.html#cb680-2" tabindex="-1"></a>               <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Height&quot;</span>,<span class="st">&quot;Weight&quot;</span>), <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb680-3"><a href="ch6.html#cb680-3" tabindex="-1"></a>               <span class="at">measure =</span> <span class="fu">c</span>(<span class="dv">170</span>, <span class="dv">75</span>, <span class="dv">165</span>, <span class="dv">63</span>, <span class="dv">175</span>, <span class="dv">85</span>)</span>
<span id="cb680-4"><a href="ch6.html#cb680-4" tabindex="-1"></a>               )</span>
<span id="cb680-5"><a href="ch6.html#cb680-5" tabindex="-1"></a>df_2</span>
<span id="cb680-6"><a href="ch6.html#cb680-6" tabindex="-1"></a><span class="do">## # A tibble: 6 × 3</span></span>
<span id="cb680-7"><a href="ch6.html#cb680-7" tabindex="-1"></a><span class="do">##   Name  type   measure</span></span>
<span id="cb680-8"><a href="ch6.html#cb680-8" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span id="cb680-9"><a href="ch6.html#cb680-9" tabindex="-1"></a><span class="do">## 1 Kim   Height     170</span></span>
<span id="cb680-10"><a href="ch6.html#cb680-10" tabindex="-1"></a><span class="do">## 2 Kim   Weight      75</span></span>
<span id="cb680-11"><a href="ch6.html#cb680-11" tabindex="-1"></a><span class="do">## 3 Park  Height     165</span></span>
<span id="cb680-12"><a href="ch6.html#cb680-12" tabindex="-1"></a><span class="do">## 4 Park  Weight      63</span></span>
<span id="cb680-13"><a href="ch6.html#cb680-13" tabindex="-1"></a><span class="do">## 5 Lee   Height     175</span></span>
<span id="cb680-14"><a href="ch6.html#cb680-14" tabindex="-1"></a><span class="do">## 6 Lee   Weight      85</span></span></code></pre></div>
<p><code>df_2</code>는 세 명의 신장과 체중에 대한 자료이다. 같은 행에 입력되어야 할 한 사람의 자료가 두 행에 나뉘어져 입력되어서, 한 열에 두 변수의 자료가 입력되었다. <code>df_2</code>를 tidy 데이터로 변환하는 과정은 다음과 같다.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="ch6.html#cb681-1" tabindex="-1"></a>df_2 <span class="sc">|&gt;</span></span>
<span id="cb681-2"><a href="ch6.html#cb681-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> measure)</span>
<span id="cb681-3"><a href="ch6.html#cb681-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 3</span></span>
<span id="cb681-4"><a href="ch6.html#cb681-4" tabindex="-1"></a><span class="do">##   Name  Height Weight</span></span>
<span id="cb681-5"><a href="ch6.html#cb681-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb681-6"><a href="ch6.html#cb681-6" tabindex="-1"></a><span class="do">## 1 Kim      170     75</span></span>
<span id="cb681-7"><a href="ch6.html#cb681-7" tabindex="-1"></a><span class="do">## 2 Park     165     63</span></span>
<span id="cb681-8"><a href="ch6.html#cb681-8" tabindex="-1"></a><span class="do">## 3 Lee      175     85</span></span></code></pre></div>
<ul>
<li>예제: <code>tidyr::fish_encounters</code></li>
</ul>
<p>이 데이터 프레임은 태그를 부착한 19마리 물고기(<code>fish</code>)가 어떤 강을 따라 이동하는 동안 특정 지점(<code>station</code>)에서 움직임이 관측됐는지 여부(<code>seen</code>)를 기록한 자료이다. 움직임이 관측된 <code>station</code>만 자료에 나타나 있어서 변수 <code>seen</code>은 모든 행에서 1을 값으로 갖고 있다.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="ch6.html#cb682-1" tabindex="-1"></a>fish_encounters <span class="sc">|&gt;</span> </span>
<span id="cb682-2"><a href="ch6.html#cb682-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb682-3"><a href="ch6.html#cb682-3" tabindex="-1"></a><span class="do">## # A tibble: 114 × 3</span></span>
<span id="cb682-4"><a href="ch6.html#cb682-4" tabindex="-1"></a><span class="do">##   fish  station  seen</span></span>
<span id="cb682-5"><a href="ch6.html#cb682-5" tabindex="-1"></a><span class="do">##   &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;</span></span>
<span id="cb682-6"><a href="ch6.html#cb682-6" tabindex="-1"></a><span class="do">## 1 4842  Release     1</span></span>
<span id="cb682-7"><a href="ch6.html#cb682-7" tabindex="-1"></a><span class="do">## 2 4842  I80_1       1</span></span>
<span id="cb682-8"><a href="ch6.html#cb682-8" tabindex="-1"></a><span class="do">## 3 4842  Lisbon      1</span></span>
<span id="cb682-9"><a href="ch6.html#cb682-9" tabindex="-1"></a><span class="do">## 4 4842  Rstr        1</span></span>
<span id="cb682-10"><a href="ch6.html#cb682-10" tabindex="-1"></a><span class="do">## 5 4842  Base_TD     1</span></span>
<span id="cb682-11"><a href="ch6.html#cb682-11" tabindex="-1"></a><span class="do">## # ℹ 109 more rows</span></span></code></pre></div>
<p>물고기의 움직임이 관측되지 않은 지점에 대한 자료도 중요한 정보를 담고 있다고 할 수 있는데, 지금의 구조에서는 그 정보를 얻을 수 없게 되어 있다. 물고기마다 모든 지점에서의 움직임 관측 여부를 표현하기 위해서는 변수 <code>station</code>에 입력된 각 지점이 변수로 전환되어야 한다.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="ch6.html#cb683-1" tabindex="-1"></a>fish_encounters <span class="sc">|&gt;</span> </span>
<span id="cb683-2"><a href="ch6.html#cb683-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> station, </span>
<span id="cb683-3"><a href="ch6.html#cb683-3" tabindex="-1"></a>              <span class="at">values_from =</span> seen</span>
<span id="cb683-4"><a href="ch6.html#cb683-4" tabindex="-1"></a>              ) <span class="sc">|&gt;</span> </span>
<span id="cb683-5"><a href="ch6.html#cb683-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb683-6"><a href="ch6.html#cb683-6" tabindex="-1"></a><span class="do">## # A tibble: 19 × 12</span></span>
<span id="cb683-7"><a href="ch6.html#cb683-7" tabindex="-1"></a><span class="do">##   fish  Release I80_1 Lisbon  Rstr Base_TD   BCE   BCW  BCE2  BCW2   MAE   MAW</span></span>
<span id="cb683-8"><a href="ch6.html#cb683-8" tabindex="-1"></a><span class="do">##   &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb683-9"><a href="ch6.html#cb683-9" tabindex="-1"></a><span class="do">## 1 4842        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb683-10"><a href="ch6.html#cb683-10" tabindex="-1"></a><span class="do">## 2 4843        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb683-11"><a href="ch6.html#cb683-11" tabindex="-1"></a><span class="do">## 3 4844        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb683-12"><a href="ch6.html#cb683-12" tabindex="-1"></a><span class="do">## 4 4845        1     1      1     1       1    NA    NA    NA    NA    NA    NA</span></span>
<span id="cb683-13"><a href="ch6.html#cb683-13" tabindex="-1"></a><span class="do">## 5 4847        1     1      1    NA      NA    NA    NA    NA    NA    NA    NA</span></span>
<span id="cb683-14"><a href="ch6.html#cb683-14" tabindex="-1"></a><span class="do">## # ℹ 14 more rows</span></span></code></pre></div>
<p>움직임이 관측되지 않은 지점에 대해서는 입력된 자료가 없기 때문에 해당 위치에 <code>NA</code>가 표시되었다.
하지만 관측이 안된 것은 변수 <code>seen</code>의 값이 <code>0</code>이 되는 것이므로 <code>NA</code>를 <code>0</code>으로 바꾸는 것이 더 좋을 것이다.
이렇게 열을 확장하는 과정에서 발생할 수 있는 <code>NA</code> 대신 다른 값을 입력해야 할 때에는 옵션 <code>values_fill</code>에 대신 입력하려는 값을 지정하면 된다.</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="ch6.html#cb684-1" tabindex="-1"></a>fish_encounters <span class="sc">|&gt;</span> </span>
<span id="cb684-2"><a href="ch6.html#cb684-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> station, </span>
<span id="cb684-3"><a href="ch6.html#cb684-3" tabindex="-1"></a>              <span class="at">values_from =</span> seen,</span>
<span id="cb684-4"><a href="ch6.html#cb684-4" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span></span>
<span id="cb684-5"><a href="ch6.html#cb684-5" tabindex="-1"></a>              ) <span class="sc">|&gt;</span> </span>
<span id="cb684-6"><a href="ch6.html#cb684-6" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb684-7"><a href="ch6.html#cb684-7" tabindex="-1"></a><span class="do">## # A tibble: 19 × 12</span></span>
<span id="cb684-8"><a href="ch6.html#cb684-8" tabindex="-1"></a><span class="do">##   fish  Release I80_1 Lisbon  Rstr Base_TD   BCE   BCW  BCE2  BCW2   MAE   MAW</span></span>
<span id="cb684-9"><a href="ch6.html#cb684-9" tabindex="-1"></a><span class="do">##   &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb684-10"><a href="ch6.html#cb684-10" tabindex="-1"></a><span class="do">## 1 4842        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb684-11"><a href="ch6.html#cb684-11" tabindex="-1"></a><span class="do">## 2 4843        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb684-12"><a href="ch6.html#cb684-12" tabindex="-1"></a><span class="do">## 3 4844        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb684-13"><a href="ch6.html#cb684-13" tabindex="-1"></a><span class="do">## 4 4845        1     1      1     1       1     0     0     0     0     0     0</span></span>
<span id="cb684-14"><a href="ch6.html#cb684-14" tabindex="-1"></a><span class="do">## 5 4847        1     1      1     0       0     0     0     0     0     0     0</span></span>
<span id="cb684-15"><a href="ch6.html#cb684-15" tabindex="-1"></a><span class="do">## # ℹ 14 more rows</span></span></code></pre></div>
<p>관측이 되지 않은 지점에서 변수 <code>seen</code>에 <code>0</code>을 대신 입력하는 다른 방법은 함수 <code>tidyr::replace_na()</code>를 사용하는 것이다.
함수 <code>replace_na()</code>는 다음과 같이 벡터에 있는 <code>NA</code>를 다른 값으로 변환하는 기능이 있다.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="ch6.html#cb685-1" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">replace_na</span>(<span class="dv">0</span>)</span>
<span id="cb685-2"><a href="ch6.html#cb685-2" tabindex="-1"></a><span class="do">## [1] 1 2 3 0 5</span></span></code></pre></div>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="ch6.html#cb686-1" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="cn">NA</span>) <span class="sc">|&gt;</span> <span class="fu">replace_na</span>(<span class="st">&quot;Unknown&quot;</span>)</span>
<span id="cb686-2"><a href="ch6.html#cb686-2" tabindex="-1"></a><span class="do">## [1] &quot;1&quot;       &quot;2&quot;       &quot;Unknown&quot;</span></span></code></pre></div>
<p>데이터 프레임 <code>fish_encounters</code>를 <code>pivot_wider()</code>로 확장한 후에 변수 <code>fish</code>를 제외한 모든 변수의 <code>NA</code>를 <code>0</code>으로 대체해 보자.</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="ch6.html#cb687-1" tabindex="-1"></a>fish_encounters <span class="sc">|&gt;</span> </span>
<span id="cb687-2"><a href="ch6.html#cb687-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> station, </span>
<span id="cb687-3"><a href="ch6.html#cb687-3" tabindex="-1"></a>              <span class="at">values_from =</span> seen</span>
<span id="cb687-4"><a href="ch6.html#cb687-4" tabindex="-1"></a>              ) <span class="sc">|&gt;</span> </span>
<span id="cb687-5"><a href="ch6.html#cb687-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">!</span>fish, <span class="sc">~</span> <span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb687-6"><a href="ch6.html#cb687-6" tabindex="-1"></a><span class="do">## # A tibble: 19 × 12</span></span>
<span id="cb687-7"><a href="ch6.html#cb687-7" tabindex="-1"></a><span class="do">##    fish  Release I80_1 Lisbon  Rstr Base_TD   BCE   BCW  BCE2  BCW2   MAE   MAW</span></span>
<span id="cb687-8"><a href="ch6.html#cb687-8" tabindex="-1"></a><span class="do">##    &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb687-9"><a href="ch6.html#cb687-9" tabindex="-1"></a><span class="do">##  1 4842        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb687-10"><a href="ch6.html#cb687-10" tabindex="-1"></a><span class="do">##  2 4843        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb687-11"><a href="ch6.html#cb687-11" tabindex="-1"></a><span class="do">##  3 4844        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb687-12"><a href="ch6.html#cb687-12" tabindex="-1"></a><span class="do">##  4 4845        1     1      1     1       1     0     0     0     0     0     0</span></span>
<span id="cb687-13"><a href="ch6.html#cb687-13" tabindex="-1"></a><span class="do">##  5 4847        1     1      1     0       0     0     0     0     0     0     0</span></span>
<span id="cb687-14"><a href="ch6.html#cb687-14" tabindex="-1"></a><span class="do">##  6 4848        1     1      1     1       0     0     0     0     0     0     0</span></span>
<span id="cb687-15"><a href="ch6.html#cb687-15" tabindex="-1"></a><span class="do">##  7 4849        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span id="cb687-16"><a href="ch6.html#cb687-16" tabindex="-1"></a><span class="do">##  8 4850        1     1      0     1       1     1     1     0     0     0     0</span></span>
<span id="cb687-17"><a href="ch6.html#cb687-17" tabindex="-1"></a><span class="do">##  9 4851        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span id="cb687-18"><a href="ch6.html#cb687-18" tabindex="-1"></a><span class="do">## 10 4854        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span id="cb687-19"><a href="ch6.html#cb687-19" tabindex="-1"></a><span class="do">## 11 4855        1     1      1     1       1     0     0     0     0     0     0</span></span>
<span id="cb687-20"><a href="ch6.html#cb687-20" tabindex="-1"></a><span class="do">## 12 4857        1     1      1     1       1     1     1     1     1     0     0</span></span>
<span id="cb687-21"><a href="ch6.html#cb687-21" tabindex="-1"></a><span class="do">## 13 4858        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb687-22"><a href="ch6.html#cb687-22" tabindex="-1"></a><span class="do">## 14 4859        1     1      1     1       1     0     0     0     0     0     0</span></span>
<span id="cb687-23"><a href="ch6.html#cb687-23" tabindex="-1"></a><span class="do">## 15 4861        1     1      1     1       1     1     1     1     1     1     1</span></span>
<span id="cb687-24"><a href="ch6.html#cb687-24" tabindex="-1"></a><span class="do">## 16 4862        1     1      1     1       1     1     1     1     1     0     0</span></span>
<span id="cb687-25"><a href="ch6.html#cb687-25" tabindex="-1"></a><span class="do">## 17 4863        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span id="cb687-26"><a href="ch6.html#cb687-26" tabindex="-1"></a><span class="do">## 18 4864        1     1      0     0       0     0     0     0     0     0     0</span></span>
<span id="cb687-27"><a href="ch6.html#cb687-27" tabindex="-1"></a><span class="do">## 19 4865        1     1      1     0       0     0     0     0     0     0     0</span></span></code></pre></div>
</div>
<div id="문자형-열의-결합과-분리-separate와-unite" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> 문자형 열의 결합과 분리: <code>separate()</code>와 <code>unite()</code><a href="ch6.html#문자형-열의-결합과-분리-separate와-unite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>하나의 문자형 열에 입력된 자료를 몇 개의 열로 분산시키거나, 또는 몇 개의 열에 입력되어 있는 자료를 하나의 열로 합치는 것은 빈번히 이루어지는 필수적인 작업은 아니지만, 나름의 의미가 있는 필요한 작업이다.</p>
<p><strong>1. 함수 <code>separate()</code></strong></p>
<p>패키지 <code>tidyr</code>에 있는 데이터 프레임 <code>table3</code>를 살펴보자.</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="ch6.html#cb688-1" tabindex="-1"></a>table3</span>
<span id="cb688-2"><a href="ch6.html#cb688-2" tabindex="-1"></a><span class="do">## # A tibble: 6 × 3</span></span>
<span id="cb688-3"><a href="ch6.html#cb688-3" tabindex="-1"></a><span class="do">##   country      year rate             </span></span>
<span id="cb688-4"><a href="ch6.html#cb688-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            </span></span>
<span id="cb688-5"><a href="ch6.html#cb688-5" tabindex="-1"></a><span class="do">## 1 Afghanistan  1999 745/19987071     </span></span>
<span id="cb688-6"><a href="ch6.html#cb688-6" tabindex="-1"></a><span class="do">## 2 Afghanistan  2000 2666/20595360    </span></span>
<span id="cb688-7"><a href="ch6.html#cb688-7" tabindex="-1"></a><span class="do">## 3 Brazil       1999 37737/172006362  </span></span>
<span id="cb688-8"><a href="ch6.html#cb688-8" tabindex="-1"></a><span class="do">## 4 Brazil       2000 80488/174504898  </span></span>
<span id="cb688-9"><a href="ch6.html#cb688-9" tabindex="-1"></a><span class="do">## 5 China        1999 212258/1272915272</span></span>
<span id="cb688-10"><a href="ch6.html#cb688-10" tabindex="-1"></a><span class="do">## 6 China        2000 213766/1280428583</span></span></code></pre></div>
<p><code>table3</code>는 <code>table1</code>의 변수 <code>cases</code>와 <code>population</code>의 자료가 <code>rate</code> 열에 함께 입력되어 있다.
이와 같은 경우에는 문자형 변수 <code>rate</code>를 두 변수로 분리해야 하는데, 문자형 열 분리에 사용할 수 있는 함수에는 <code>separate()</code>가 있고, 새롭게 추가된 함수로서 <code>separate_wider_delim()</code>과 <code>separate_wider_position()</code>이 있다.</p>
<p>먼저 함수 <code>separate()</code>로 자료를 분리하여 두 열에 나누어 입력하는 작업을 진행해 보자.
기본적인 사용법은 <code>separate(data, col, into)</code>이다. <code>data</code>는 형태를 변형할 데이터 프레임이고, 자료가 함께 입력되어 있는 열은 <code>col</code>에 지정하며, 자료를 분리하여 따로 입력할 열 이름을 <code>into</code>에 지정한다.</p>
<p><code>table3</code>의 경우에는 <code>rate</code>가 분리 대상이 되는 열이므로 <code>col</code>에 지정하고, 분리된 자료를 입력할 열의 이름인 <code>cases</code>와 <code>population</code>을 <code>into</code>에 지정하면 된다.</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="ch6.html#cb689-1" tabindex="-1"></a>table3 <span class="sc">|&gt;</span></span>
<span id="cb689-2"><a href="ch6.html#cb689-2" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>))</span>
<span id="cb689-3"><a href="ch6.html#cb689-3" tabindex="-1"></a><span class="do">## # A tibble: 6 × 4</span></span>
<span id="cb689-4"><a href="ch6.html#cb689-4" tabindex="-1"></a><span class="do">##   country      year cases  population</span></span>
<span id="cb689-5"><a href="ch6.html#cb689-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     </span></span>
<span id="cb689-6"><a href="ch6.html#cb689-6" tabindex="-1"></a><span class="do">## 1 Afghanistan  1999 745    19987071  </span></span>
<span id="cb689-7"><a href="ch6.html#cb689-7" tabindex="-1"></a><span class="do">## 2 Afghanistan  2000 2666   20595360  </span></span>
<span id="cb689-8"><a href="ch6.html#cb689-8" tabindex="-1"></a><span class="do">## 3 Brazil       1999 37737  172006362 </span></span>
<span id="cb689-9"><a href="ch6.html#cb689-9" tabindex="-1"></a><span class="do">## 4 Brazil       2000 80488  174504898 </span></span>
<span id="cb689-10"><a href="ch6.html#cb689-10" tabindex="-1"></a><span class="do">## 5 China        1999 212258 1272915272</span></span>
<span id="cb689-11"><a href="ch6.html#cb689-11" tabindex="-1"></a><span class="do">## 6 China        2000 213766 1280428583</span></span></code></pre></div>
<p>새롭게 생성된 두 변수 <code>cases</code>와 <code>population</code>의 자료 유형을 살펴보면 자료는 정수이지만, 유형은 문자라는 것을 알 수 있다. 이것은 분리 전 <code>rate</code> 열의 유형이 문자이기 때문인데, 분리 후 자료의 유형을 정수로 바꾸기 위해서는 <code>convert=TRUE</code>를 추가로 입력해야 한다.</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="ch6.html#cb690-1" tabindex="-1"></a>table3 <span class="sc">|&gt;</span></span>
<span id="cb690-2"><a href="ch6.html#cb690-2" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>,<span class="st">&quot;population&quot;</span>), </span>
<span id="cb690-3"><a href="ch6.html#cb690-3" tabindex="-1"></a>           <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb690-4"><a href="ch6.html#cb690-4" tabindex="-1"></a><span class="do">## # A tibble: 6 × 4</span></span>
<span id="cb690-5"><a href="ch6.html#cb690-5" tabindex="-1"></a><span class="do">##   country      year  cases population</span></span>
<span id="cb690-6"><a href="ch6.html#cb690-6" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt;</span></span>
<span id="cb690-7"><a href="ch6.html#cb690-7" tabindex="-1"></a><span class="do">## 1 Afghanistan  1999    745   19987071</span></span>
<span id="cb690-8"><a href="ch6.html#cb690-8" tabindex="-1"></a><span class="do">## 2 Afghanistan  2000   2666   20595360</span></span>
<span id="cb690-9"><a href="ch6.html#cb690-9" tabindex="-1"></a><span class="do">## 3 Brazil       1999  37737  172006362</span></span>
<span id="cb690-10"><a href="ch6.html#cb690-10" tabindex="-1"></a><span class="do">## 4 Brazil       2000  80488  174504898</span></span>
<span id="cb690-11"><a href="ch6.html#cb690-11" tabindex="-1"></a><span class="do">## 5 China        1999 212258 1272915272</span></span>
<span id="cb690-12"><a href="ch6.html#cb690-12" tabindex="-1"></a><span class="do">## 6 China        2000 213766 1280428583</span></span></code></pre></div>
<p>이번에는 함수 <code>separate_wider_delim()</code>으로 열을 분리해 보자.
기본적인 사용법은 <code>separate_wider_delim(data, cols, delim, names)</code>인데, <code>cols</code>에는 분리가 될 열을 <code>&lt;tidy-select&gt;</code> 방식으로 지정하고, <code>delim</code>에는 분리 구분자를 지정하며, <code>names</code>에는 열이 분리되고 새로 생성되는 변수 이름을 지정한다.
이제 데이터 프레임 <code>table3</code>를 분리하고 변수 유형을 전환해 보자.</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="ch6.html#cb691-1" tabindex="-1"></a>table3 <span class="sc">|&gt;</span> </span>
<span id="cb691-2"><a href="ch6.html#cb691-2" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> rate, <span class="at">delim =</span> <span class="st">&quot;/&quot;</span>,</span>
<span id="cb691-3"><a href="ch6.html#cb691-3" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb691-4"><a href="ch6.html#cb691-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(cases<span class="sc">:</span>population, parse_number))</span>
<span id="cb691-5"><a href="ch6.html#cb691-5" tabindex="-1"></a><span class="do">## # A tibble: 6 × 4</span></span>
<span id="cb691-6"><a href="ch6.html#cb691-6" tabindex="-1"></a><span class="do">##   country      year  cases population</span></span>
<span id="cb691-7"><a href="ch6.html#cb691-7" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb691-8"><a href="ch6.html#cb691-8" tabindex="-1"></a><span class="do">## 1 Afghanistan  1999    745   19987071</span></span>
<span id="cb691-9"><a href="ch6.html#cb691-9" tabindex="-1"></a><span class="do">## 2 Afghanistan  2000   2666   20595360</span></span>
<span id="cb691-10"><a href="ch6.html#cb691-10" tabindex="-1"></a><span class="do">## 3 Brazil       1999  37737  172006362</span></span>
<span id="cb691-11"><a href="ch6.html#cb691-11" tabindex="-1"></a><span class="do">## 4 Brazil       2000  80488  174504898</span></span>
<span id="cb691-12"><a href="ch6.html#cb691-12" tabindex="-1"></a><span class="do">## 5 China        1999 212258 1272915272</span></span>
<span id="cb691-13"><a href="ch6.html#cb691-13" tabindex="-1"></a><span class="do">## 6 China        2000 213766 1280428583</span></span></code></pre></div>
<p>함수 <code>separate()</code>가 하나의 열에 함께 입력된 자료를 분리하는 디폴트 방식은 <code>col</code>에 지정된 열의 자료 중 숫자나 문자가 아닌 기호가 있으면 그것을 기준으로 분리하는 것이다. <code>table3</code>의 경우에는 <code>rate</code> 열의 두 자료를 빗금을 기준으로 구분하였다.
만일 특정 문자 또는 기호를 구분자로 사용하고자 한다면 <code>sep</code>에 지정하면 된다. 예제 자료로 다음의 <code>df_3</code>를 만들어 보자.</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="ch6.html#cb692-1" tabindex="-1"></a>df_3 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(<span class="sc">~</span>Date, <span class="sc">~</span>Sales,</span>
<span id="cb692-2"><a href="ch6.html#cb692-2" tabindex="-1"></a>                <span class="st">&quot;2015-Qtr.1&quot;</span>, <span class="dv">15</span>,</span>
<span id="cb692-3"><a href="ch6.html#cb692-3" tabindex="-1"></a>                <span class="st">&quot;2015-Qtr.2&quot;</span>, <span class="dv">16</span>,</span>
<span id="cb692-4"><a href="ch6.html#cb692-4" tabindex="-1"></a>                <span class="st">&quot;2015-Qtr.3&quot;</span>, <span class="dv">19</span>,</span>
<span id="cb692-5"><a href="ch6.html#cb692-5" tabindex="-1"></a>                <span class="st">&quot;2015-Qtr.4&quot;</span>, <span class="dv">17</span>)</span>
<span id="cb692-6"><a href="ch6.html#cb692-6" tabindex="-1"></a>df_3</span>
<span id="cb692-7"><a href="ch6.html#cb692-7" tabindex="-1"></a><span class="do">## # A tibble: 4 × 2</span></span>
<span id="cb692-8"><a href="ch6.html#cb692-8" tabindex="-1"></a><span class="do">##   Date       Sales</span></span>
<span id="cb692-9"><a href="ch6.html#cb692-9" tabindex="-1"></a><span class="do">##   &lt;chr&gt;      &lt;dbl&gt;</span></span>
<span id="cb692-10"><a href="ch6.html#cb692-10" tabindex="-1"></a><span class="do">## 1 2015-Qtr.1    15</span></span>
<span id="cb692-11"><a href="ch6.html#cb692-11" tabindex="-1"></a><span class="do">## 2 2015-Qtr.2    16</span></span>
<span id="cb692-12"><a href="ch6.html#cb692-12" tabindex="-1"></a><span class="do">## 3 2015-Qtr.3    19</span></span>
<span id="cb692-13"><a href="ch6.html#cb692-13" tabindex="-1"></a><span class="do">## 4 2015-Qtr.4    17</span></span></code></pre></div>
<p><code>Date</code> 열에는 년도와 분기가 대시(<code>-</code>)로 구분되어 있으며, 분기 자료에 점(<code>.</code>)이 포함되어 있다.
함수 <code>separate()</code>를 사용해서 <code>Date</code>의 자료를 년도와 분기로 분리한다면, 옵션 <code>sep</code>를 사용해서 대시(<code>-</code>)를 구분자로 지정해야 한다.
만일 <code>sep</code>를 따로 지정하지 않으면 대시와 점이 모두 분리 기준이 되어서 세 개의 열로 분리된다.</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="ch6.html#cb693-1" tabindex="-1"></a>df_3 <span class="sc">|&gt;</span></span>
<span id="cb693-2"><a href="ch6.html#cb693-2" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> Date, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;Qtr&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>,</span>
<span id="cb693-3"><a href="ch6.html#cb693-3" tabindex="-1"></a>           <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb693-4"><a href="ch6.html#cb693-4" tabindex="-1"></a><span class="do">## # A tibble: 4 × 3</span></span>
<span id="cb693-5"><a href="ch6.html#cb693-5" tabindex="-1"></a><span class="do">##    year Qtr   Sales</span></span>
<span id="cb693-6"><a href="ch6.html#cb693-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb693-7"><a href="ch6.html#cb693-7" tabindex="-1"></a><span class="do">## 1  2015 Qtr.1    15</span></span>
<span id="cb693-8"><a href="ch6.html#cb693-8" tabindex="-1"></a><span class="do">## 2  2015 Qtr.2    16</span></span>
<span id="cb693-9"><a href="ch6.html#cb693-9" tabindex="-1"></a><span class="do">## 3  2015 Qtr.3    19</span></span>
<span id="cb693-10"><a href="ch6.html#cb693-10" tabindex="-1"></a><span class="do">## 4  2015 Qtr.4    17</span></span></code></pre></div>
<p>함수 <code>separate_wider_delim()</code>는 다음과 같이 사용하면 된다.</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="ch6.html#cb694-1" tabindex="-1"></a>df_3 <span class="sc">|&gt;</span> </span>
<span id="cb694-2"><a href="ch6.html#cb694-2" tabindex="-1"></a>    <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> Date, <span class="at">delim =</span> <span class="st">&quot;-&quot;</span>,</span>
<span id="cb694-3"><a href="ch6.html#cb694-3" tabindex="-1"></a>                         <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;Qtr&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb694-4"><a href="ch6.html#cb694-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(year))</span>
<span id="cb694-5"><a href="ch6.html#cb694-5" tabindex="-1"></a><span class="do">## # A tibble: 4 × 3</span></span>
<span id="cb694-6"><a href="ch6.html#cb694-6" tabindex="-1"></a><span class="do">##    year Qtr   Sales</span></span>
<span id="cb694-7"><a href="ch6.html#cb694-7" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb694-8"><a href="ch6.html#cb694-8" tabindex="-1"></a><span class="do">## 1  2015 Qtr.1    15</span></span>
<span id="cb694-9"><a href="ch6.html#cb694-9" tabindex="-1"></a><span class="do">## 2  2015 Qtr.2    16</span></span>
<span id="cb694-10"><a href="ch6.html#cb694-10" tabindex="-1"></a><span class="do">## 3  2015 Qtr.3    19</span></span>
<span id="cb694-11"><a href="ch6.html#cb694-11" tabindex="-1"></a><span class="do">## 4  2015 Qtr.4    17</span></span></code></pre></div>
<p>자료 분리의 기준을 특정 기호로 지정하기는 어렵지만, 위치로는 지정할 수 있는 경우가 있다.
예제 자료로 다음의 <code>df_4</code>를 만들어 보자.</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="ch6.html#cb695-1" tabindex="-1"></a>df_4 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(<span class="sc">~</span>Date, <span class="sc">~</span>Sales,</span>
<span id="cb695-2"><a href="ch6.html#cb695-2" tabindex="-1"></a>                <span class="st">&quot;2015Q1&quot;</span>, <span class="dv">15</span>,</span>
<span id="cb695-3"><a href="ch6.html#cb695-3" tabindex="-1"></a>                <span class="st">&quot;2015Q2&quot;</span>, <span class="dv">16</span>,</span>
<span id="cb695-4"><a href="ch6.html#cb695-4" tabindex="-1"></a>                <span class="st">&quot;2015Q3&quot;</span>, <span class="dv">19</span>,</span>
<span id="cb695-5"><a href="ch6.html#cb695-5" tabindex="-1"></a>                <span class="st">&quot;2015Q4&quot;</span>, <span class="dv">17</span>)</span>
<span id="cb695-6"><a href="ch6.html#cb695-6" tabindex="-1"></a>df_4</span>
<span id="cb695-7"><a href="ch6.html#cb695-7" tabindex="-1"></a><span class="do">## # A tibble: 4 × 2</span></span>
<span id="cb695-8"><a href="ch6.html#cb695-8" tabindex="-1"></a><span class="do">##   Date   Sales</span></span>
<span id="cb695-9"><a href="ch6.html#cb695-9" tabindex="-1"></a><span class="do">##   &lt;chr&gt;  &lt;dbl&gt;</span></span>
<span id="cb695-10"><a href="ch6.html#cb695-10" tabindex="-1"></a><span class="do">## 1 2015Q1    15</span></span>
<span id="cb695-11"><a href="ch6.html#cb695-11" tabindex="-1"></a><span class="do">## 2 2015Q2    16</span></span>
<span id="cb695-12"><a href="ch6.html#cb695-12" tabindex="-1"></a><span class="do">## 3 2015Q3    19</span></span>
<span id="cb695-13"><a href="ch6.html#cb695-13" tabindex="-1"></a><span class="do">## 4 2015Q4    17</span></span></code></pre></div>
<p>원하는 결과는 다음과 같다.</p>
<pre><code>## # A tibble: 4 × 3
##    year Qtr   Sales
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
## 1  2015 Q1       15
## 2  2015 Q2       16
## 3  2015 Q3       19
## 4  2015 Q4       17</code></pre>
<p>함수 <code>separate()</code>의 경우에는 <code>sep</code>에 정수를 지정하면 분리위치를 나타내는 것이 된다.
양의 정수는 자료의 왼쪽 끝을 기준으로 하는 위치로서 왼쪽 끝이 1이 된다.
음의 정수는 자료의 오른쪽 끝을 기준으로 하는 위치로서 오른쪽 끝이 -1이 된다.</p>
<p><code>Date</code> 열의 자료를 년도와 분기로 구분해 보자. 분리 기준 위치는 왼쪽 끝부터는 4번째 자리이고 오른쪽 끝부터는 2번째 자리가 된다. 따라서 <code>sep</code>에 4 또는 -2를 지정하면 된다.</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="ch6.html#cb697-1" tabindex="-1"></a>df_4 <span class="sc">|&gt;</span></span>
<span id="cb697-2"><a href="ch6.html#cb697-2" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> Date, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>,<span class="st">&quot;Qtr&quot;</span>), <span class="at">sep =</span> <span class="dv">4</span>,</span>
<span id="cb697-3"><a href="ch6.html#cb697-3" tabindex="-1"></a>           <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb697-4"><a href="ch6.html#cb697-4" tabindex="-1"></a><span class="do">## # A tibble: 4 × 3</span></span>
<span id="cb697-5"><a href="ch6.html#cb697-5" tabindex="-1"></a><span class="do">##    year Qtr   Sales</span></span>
<span id="cb697-6"><a href="ch6.html#cb697-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb697-7"><a href="ch6.html#cb697-7" tabindex="-1"></a><span class="do">## 1  2015 Q1       15</span></span>
<span id="cb697-8"><a href="ch6.html#cb697-8" tabindex="-1"></a><span class="do">## 2  2015 Q2       16</span></span>
<span id="cb697-9"><a href="ch6.html#cb697-9" tabindex="-1"></a><span class="do">## 3  2015 Q3       19</span></span>
<span id="cb697-10"><a href="ch6.html#cb697-10" tabindex="-1"></a><span class="do">## 4  2015 Q4       17</span></span></code></pre></div>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="ch6.html#cb698-1" tabindex="-1"></a>df_4 <span class="sc">|&gt;</span></span>
<span id="cb698-2"><a href="ch6.html#cb698-2" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> Date, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>,<span class="st">&quot;Qtr&quot;</span>), <span class="at">sep =</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb698-3"><a href="ch6.html#cb698-3" tabindex="-1"></a>           <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb698-4"><a href="ch6.html#cb698-4" tabindex="-1"></a><span class="do">## # A tibble: 4 × 3</span></span>
<span id="cb698-5"><a href="ch6.html#cb698-5" tabindex="-1"></a><span class="do">##    year Qtr   Sales</span></span>
<span id="cb698-6"><a href="ch6.html#cb698-6" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb698-7"><a href="ch6.html#cb698-7" tabindex="-1"></a><span class="do">## 1  2015 Q1       15</span></span>
<span id="cb698-8"><a href="ch6.html#cb698-8" tabindex="-1"></a><span class="do">## 2  2015 Q2       16</span></span>
<span id="cb698-9"><a href="ch6.html#cb698-9" tabindex="-1"></a><span class="do">## 3  2015 Q3       19</span></span>
<span id="cb698-10"><a href="ch6.html#cb698-10" tabindex="-1"></a><span class="do">## 4  2015 Q4       17</span></span></code></pre></div>
<p>위치로 분리하는 경우에는 함수 <code>separate_wider_position()</code>을 사용할 수 있다.
기본적인 사용법은 <code>separate_wider_position(data, cols, widths)</code>으로서, <code>widths</code>에는 라벨이 있는 숫자형 벡터를 지정하는 것인데, 라벨은 분리되어 새로 만들어지는 변수의 이름을, 숫자는 각 변수의 폭을 지정하면 된다.</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="ch6.html#cb699-1" tabindex="-1"></a>df_4 <span class="sc">|&gt;</span> </span>
<span id="cb699-2"><a href="ch6.html#cb699-2" tabindex="-1"></a>    <span class="fu">separate_wider_position</span>(<span class="at">cols =</span> Date,</span>
<span id="cb699-3"><a href="ch6.html#cb699-3" tabindex="-1"></a>                            <span class="at">widths =</span> <span class="fu">c</span>(<span class="at">year =</span> <span class="dv">4</span>, <span class="at">Qtr =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb699-4"><a href="ch6.html#cb699-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(year))</span>
<span id="cb699-5"><a href="ch6.html#cb699-5" tabindex="-1"></a><span class="do">## # A tibble: 4 × 3</span></span>
<span id="cb699-6"><a href="ch6.html#cb699-6" tabindex="-1"></a><span class="do">##    year Qtr   Sales</span></span>
<span id="cb699-7"><a href="ch6.html#cb699-7" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb699-8"><a href="ch6.html#cb699-8" tabindex="-1"></a><span class="do">## 1  2015 Q1       15</span></span>
<span id="cb699-9"><a href="ch6.html#cb699-9" tabindex="-1"></a><span class="do">## 2  2015 Q2       16</span></span>
<span id="cb699-10"><a href="ch6.html#cb699-10" tabindex="-1"></a><span class="do">## 3  2015 Q3       19</span></span>
<span id="cb699-11"><a href="ch6.html#cb699-11" tabindex="-1"></a><span class="do">## 4  2015 Q4       17</span></span></code></pre></div>
<p><strong>2. 함수 <code>unite()</code></strong></p>
<p>패키지 <code>tidyr</code>의 데이터 프레임 <code>table5</code>를 살펴보자. 년도가 <code>century</code> 열과 <code>year</code> 열로 분리되어 있는데, 이것을 하나로 합쳐보자.</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="ch6.html#cb700-1" tabindex="-1"></a>table5</span>
<span id="cb700-2"><a href="ch6.html#cb700-2" tabindex="-1"></a><span class="do">## # A tibble: 6 × 4</span></span>
<span id="cb700-3"><a href="ch6.html#cb700-3" tabindex="-1"></a><span class="do">##   country     century year  rate             </span></span>
<span id="cb700-4"><a href="ch6.html#cb700-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            </span></span>
<span id="cb700-5"><a href="ch6.html#cb700-5" tabindex="-1"></a><span class="do">## 1 Afghanistan 19      99    745/19987071     </span></span>
<span id="cb700-6"><a href="ch6.html#cb700-6" tabindex="-1"></a><span class="do">## 2 Afghanistan 20      00    2666/20595360    </span></span>
<span id="cb700-7"><a href="ch6.html#cb700-7" tabindex="-1"></a><span class="do">## 3 Brazil      19      99    37737/172006362  </span></span>
<span id="cb700-8"><a href="ch6.html#cb700-8" tabindex="-1"></a><span class="do">## 4 Brazil      20      00    80488/174504898  </span></span>
<span id="cb700-9"><a href="ch6.html#cb700-9" tabindex="-1"></a><span class="do">## 5 China       19      99    212258/1272915272</span></span>
<span id="cb700-10"><a href="ch6.html#cb700-10" tabindex="-1"></a><span class="do">## 6 China       20      00    213766/1280428583</span></span></code></pre></div>
<p>함수 <code>unite()</code>는 여러 열의 자료를 하나의 열로 합쳐야 할 때 사용되며, 기본적인 사용 법은 <code>unite(data, col, ..., sep="_")</code>이다. <code>col</code>에는 합쳐서 새롭게 생성될 열의 이름을 지정하고, 이어서 합쳐질 열을 나열하면 된다. 열의 나열은 <code>&lt;tidy-select&gt;</code> 방식을 사용할 수 있다.</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="ch6.html#cb701-1" tabindex="-1"></a>table5 <span class="sc">|&gt;</span></span>
<span id="cb701-2"><a href="ch6.html#cb701-2" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="at">col =</span> year, century, year)</span>
<span id="cb701-3"><a href="ch6.html#cb701-3" tabindex="-1"></a><span class="do">## # A tibble: 6 × 3</span></span>
<span id="cb701-4"><a href="ch6.html#cb701-4" tabindex="-1"></a><span class="do">##   country     year  rate             </span></span>
<span id="cb701-5"><a href="ch6.html#cb701-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            </span></span>
<span id="cb701-6"><a href="ch6.html#cb701-6" tabindex="-1"></a><span class="do">## 1 Afghanistan 19_99 745/19987071     </span></span>
<span id="cb701-7"><a href="ch6.html#cb701-7" tabindex="-1"></a><span class="do">## 2 Afghanistan 20_00 2666/20595360    </span></span>
<span id="cb701-8"><a href="ch6.html#cb701-8" tabindex="-1"></a><span class="do">## 3 Brazil      19_99 37737/172006362  </span></span>
<span id="cb701-9"><a href="ch6.html#cb701-9" tabindex="-1"></a><span class="do">## 4 Brazil      20_00 80488/174504898  </span></span>
<span id="cb701-10"><a href="ch6.html#cb701-10" tabindex="-1"></a><span class="do">## 5 China       19_99 212258/1272915272</span></span>
<span id="cb701-11"><a href="ch6.html#cb701-11" tabindex="-1"></a><span class="do">## 6 China       20_00 213766/1280428583</span></span></code></pre></div>
<p>하나의 열에 합쳐진 여러 열의 자료는 밑줄로 구분되는 것이 디폴트인데, 이것을 제거하려면 <code>sep = ""</code>을 입력하면 된다.</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="ch6.html#cb702-1" tabindex="-1"></a>table5 <span class="sc">|&gt;</span></span>
<span id="cb702-2"><a href="ch6.html#cb702-2" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="at">col =</span> year, century, year, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb702-3"><a href="ch6.html#cb702-3" tabindex="-1"></a><span class="do">## # A tibble: 6 × 3</span></span>
<span id="cb702-4"><a href="ch6.html#cb702-4" tabindex="-1"></a><span class="do">##   country     year  rate             </span></span>
<span id="cb702-5"><a href="ch6.html#cb702-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            </span></span>
<span id="cb702-6"><a href="ch6.html#cb702-6" tabindex="-1"></a><span class="do">## 1 Afghanistan 1999  745/19987071     </span></span>
<span id="cb702-7"><a href="ch6.html#cb702-7" tabindex="-1"></a><span class="do">## 2 Afghanistan 2000  2666/20595360    </span></span>
<span id="cb702-8"><a href="ch6.html#cb702-8" tabindex="-1"></a><span class="do">## 3 Brazil      1999  37737/172006362  </span></span>
<span id="cb702-9"><a href="ch6.html#cb702-9" tabindex="-1"></a><span class="do">## 4 Brazil      2000  80488/174504898  </span></span>
<span id="cb702-10"><a href="ch6.html#cb702-10" tabindex="-1"></a><span class="do">## 5 China       1999  212258/1272915272</span></span>
<span id="cb702-11"><a href="ch6.html#cb702-11" tabindex="-1"></a><span class="do">## 6 China       2000  213766/1280428583</span></span></code></pre></div>
<p>변수 <code>year</code>에 입력된 자료가 정수이지만 유형은 문자이고, <code>rate</code> 열에는 두 변수의 자료가 함께 입력되어 있다. 변수 <code>year</code>의 유형을 정수로 변환하고, 이어서 <code>rate</code> 열의 자료를 분리하여 tidy 데이터로 변환시켜 보자.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="ch6.html#cb703-1" tabindex="-1"></a>table5 <span class="sc">|&gt;</span> </span>
<span id="cb703-2"><a href="ch6.html#cb703-2" tabindex="-1"></a>    <span class="fu">unite</span>(<span class="at">col =</span> year, century, year, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb703-3"><a href="ch6.html#cb703-3" tabindex="-1"></a>    <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> rate, <span class="at">delim =</span> <span class="st">&quot;/&quot;</span>,</span>
<span id="cb703-4"><a href="ch6.html#cb703-4" tabindex="-1"></a>                         <span class="at">names =</span>  <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>,<span class="st">&quot;population&quot;</span>)</span>
<span id="cb703-5"><a href="ch6.html#cb703-5" tabindex="-1"></a>                         ) <span class="sc">|&gt;</span>   </span>
<span id="cb703-6"><a href="ch6.html#cb703-6" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">!</span>country, parse_number))</span>
<span id="cb703-7"><a href="ch6.html#cb703-7" tabindex="-1"></a><span class="do">## # A tibble: 6 × 4</span></span>
<span id="cb703-8"><a href="ch6.html#cb703-8" tabindex="-1"></a><span class="do">##   country      year  cases population</span></span>
<span id="cb703-9"><a href="ch6.html#cb703-9" tabindex="-1"></a><span class="do">##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb703-10"><a href="ch6.html#cb703-10" tabindex="-1"></a><span class="do">## 1 Afghanistan  1999    745   19987071</span></span>
<span id="cb703-11"><a href="ch6.html#cb703-11" tabindex="-1"></a><span class="do">## 2 Afghanistan  2000   2666   20595360</span></span>
<span id="cb703-12"><a href="ch6.html#cb703-12" tabindex="-1"></a><span class="do">## 3 Brazil       1999  37737  172006362</span></span>
<span id="cb703-13"><a href="ch6.html#cb703-13" tabindex="-1"></a><span class="do">## 4 Brazil       2000  80488  174504898</span></span>
<span id="cb703-14"><a href="ch6.html#cb703-14" tabindex="-1"></a><span class="do">## 5 China        1999 212258 1272915272</span></span>
<span id="cb703-15"><a href="ch6.html#cb703-15" tabindex="-1"></a><span class="do">## 6 China        2000 213766 1280428583</span></span></code></pre></div>
</div>
</div>
<div id="dplyr에-의한-데이터-결합" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> <code>dplyr</code>에 의한 데이터 결합<a href="ch6.html#dplyr에-의한-데이터-결합" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>몇 개의 파일로 분산 정리되어 있는 데이터를 하나의 데이터 프레임으로 통합하는 것은 본격적인 통계분석을 실시하기 전에 반드시 마무리해야 되는 작업이다. 이러한 데이터 프레임의 통합 작업은 base R 함수인 <code>merge()</code>로도 할 수 있으나, 더 개선된 기능을 갖고 있는 함수가 패키지 <code>dplyr</code>에 있다.</p>
<p><strong>1. Mutating joins</strong></p>
<p>두 데이터 프레임을 대상으로 기준 열(key)을 이용한 수평적 결합으로 변수를 확대하는 방식의 결합 방법을 의미한다.
결합으로 새로 추가되는 변수는 결합되는 데이터 프레임의 마지막 변수가 된다.
기준 열을 이용한 두 데이터 프레임의 수평적 결합이란 key 변수의 값이 같은 행을 결합하는 것을 의미하는 것이며, 원하는 결합 방식에 따라 다른 함수를 사용해야 한다.
예를 들어 데이터 프레임 <code>df1</code>과 <code>df2</code>를 결합한다고 할 때, 통합된 데이터 프레임이 어떤 행(관찰값)을 유지하게 할 것인가에 따라 다음 4가지 함수 중 하나를 사용하면 된다.</p>
<ul>
<li><p>함수 <code>inner_join(df1, df2)</code>: <code>df1</code>과 <code>df2</code>에 공통적으로 존재하는 행만 유지</p></li>
<li><p>함수 <code>left_join(df1, df2)</code>: <code>df1</code>에 있는 모든 행 유지</p></li>
<li><p>함수 <code>right_join(df1, df2)</code>: <code>df2</code>에 있는 모든 행 유지</p></li>
<li><p>함수 <code>full_join(df1, df2)</code>: <code>df1</code>과 <code>df2</code>에 있는 모든 행 유지</p></li>
</ul>
<p>패키지 <code>dplyr</code>에 있는 데이터 프레임 <code>band_members</code>와 <code>band_instruments</code>를 살펴보자. 두 데이터 프레임에는 Beatles와 Rolling Stones 그룹 멤버 중 몇 명의 이름과 그들이 그룹에서 연주하는 악기가 정리되어 있다.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="ch6.html#cb704-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb704-2"><a href="ch6.html#cb704-2" tabindex="-1"></a>band_members</span>
<span id="cb704-3"><a href="ch6.html#cb704-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb704-4"><a href="ch6.html#cb704-4" tabindex="-1"></a><span class="do">##   name  band   </span></span>
<span id="cb704-5"><a href="ch6.html#cb704-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;  </span></span>
<span id="cb704-6"><a href="ch6.html#cb704-6" tabindex="-1"></a><span class="do">## 1 Mick  Stones </span></span>
<span id="cb704-7"><a href="ch6.html#cb704-7" tabindex="-1"></a><span class="do">## 2 John  Beatles</span></span>
<span id="cb704-8"><a href="ch6.html#cb704-8" tabindex="-1"></a><span class="do">## 3 Paul  Beatles</span></span></code></pre></div>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="ch6.html#cb705-1" tabindex="-1"></a>band_instruments</span>
<span id="cb705-2"><a href="ch6.html#cb705-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb705-3"><a href="ch6.html#cb705-3" tabindex="-1"></a><span class="do">##   name  plays </span></span>
<span id="cb705-4"><a href="ch6.html#cb705-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt; </span></span>
<span id="cb705-5"><a href="ch6.html#cb705-5" tabindex="-1"></a><span class="do">## 1 John  guitar</span></span>
<span id="cb705-6"><a href="ch6.html#cb705-6" tabindex="-1"></a><span class="do">## 2 Paul  bass  </span></span>
<span id="cb705-7"><a href="ch6.html#cb705-7" tabindex="-1"></a><span class="do">## 3 Keith guitar</span></span></code></pre></div>
<p>Key 변수는 옵션 <code>by</code>에 지정하면 된다. 위의 예에서 두 데이터 프레임에 공통적으로 들어있는 변수 <code>name</code>을 key 변수로 지정하면 되는데, <code>by = "name"</code>과 같이 변수 이름이 있는 문자형 벡터를 지정하거나,
함수 <code>join_by()</code>를 사용하여 <code>by = join_by(name)</code>과 같이 지정하면 된다.
옵션 <code>by</code>가 생략되면 두 데이터 프레임에 공통적으로 있는 이름이 같은 변수가 key가 되며, 이름이 같은 변수가 없으면 통합이 이루어지지 않는다.</p>
<p>결합 대상이 되는 두 데이터 프레임에서 사용할 key 변수의 이름이 서로 다른 경우가 있다.
예를 들어, 첫 번째 데이터 프레임의 변수 <code>x</code>와 두 번째 데이터 프레임의 변수 <code>y</code>를 key 변수로 지정하는 경우에 사용할 수 있는 첫 번째 방법은 <code>by = c("x" = "y")</code>와 같이 지정하는 것이다.
두 번째 방법은 함수 <code>join_by()</code>를 사용해서 <code>by = join_by(x == y)</code>와 같이 지정하는 것이다.
함수 <code>join_by()</code>에서는 변수 이름에 인용부호를 사용하지 않으며, 비교연산자인 <code>==</code>이 사용하는 것이 다른 점이다.
이와 같이 이름이 다른 두 변수가 key 변수로 지정되어 결합이 이루어지는 경우에 결합된 데이터 프레임의 key 변수 이름은 첫 번째 데이터 프레임의 key 변수인 <code>x</code>가 된다.</p>
<p>이제 데이터 프레임 <code>band_members</code>와 <code>band_instruments</code>를 함수 <code>inner_join()</code>로 결합한 결과를 살펴보자.
Key 변수는 <code>name</code>이 된다.
먼저 문자형 벡터로 key 변수를 지정해 보자.</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="ch6.html#cb706-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb706-2"><a href="ch6.html#cb706-2" tabindex="-1"></a>  <span class="fu">inner_join</span>(band_instruments, <span class="at">by =</span> <span class="st">&quot;name&quot;</span>)</span>
<span id="cb706-3"><a href="ch6.html#cb706-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 3</span></span>
<span id="cb706-4"><a href="ch6.html#cb706-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb706-5"><a href="ch6.html#cb706-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb706-6"><a href="ch6.html#cb706-6" tabindex="-1"></a><span class="do">## 1 John  Beatles guitar</span></span>
<span id="cb706-7"><a href="ch6.html#cb706-7" tabindex="-1"></a><span class="do">## 2 Paul  Beatles bass</span></span></code></pre></div>
<p>함수 <code>join_by()</code>로 key 변수를 지정해 보자.</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="ch6.html#cb707-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb707-2"><a href="ch6.html#cb707-2" tabindex="-1"></a>  <span class="fu">inner_join</span>(band_instruments, <span class="at">by =</span> <span class="fu">join_by</span>(name))</span>
<span id="cb707-3"><a href="ch6.html#cb707-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 3</span></span>
<span id="cb707-4"><a href="ch6.html#cb707-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb707-5"><a href="ch6.html#cb707-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb707-6"><a href="ch6.html#cb707-6" tabindex="-1"></a><span class="do">## 1 John  Beatles guitar</span></span>
<span id="cb707-7"><a href="ch6.html#cb707-7" tabindex="-1"></a><span class="do">## 2 Paul  Beatles bass</span></span></code></pre></div>
<p>두 데이터 프레임에 key 변수인 <code>name</code>이 공통적으로 있기 때문에 <code>by</code>를 생략해도 정상적인 결합이 이루어지지만, 결합 절차에 대한 메시지가 출력된다.</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="ch6.html#cb708-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb708-2"><a href="ch6.html#cb708-2" tabindex="-1"></a>  <span class="fu">inner_join</span>(band_instruments)</span>
<span id="cb708-3"><a href="ch6.html#cb708-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 3</span></span>
<span id="cb708-4"><a href="ch6.html#cb708-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb708-5"><a href="ch6.html#cb708-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb708-6"><a href="ch6.html#cb708-6" tabindex="-1"></a><span class="do">## 1 John  Beatles guitar</span></span>
<span id="cb708-7"><a href="ch6.html#cb708-7" tabindex="-1"></a><span class="do">## 2 Paul  Beatles bass</span></span></code></pre></div>
<p>통합 결과로 변수는 3개가 되었고, 관찰값은 두 데이터 프레임에 공통적으로 포함된 2개만 유지가 되었다.
이와 같이 공통적으로 포함된 관찰값만 유지하는 결합 방법은 너무 많은 데이터를 잃어버릴 수 있는 것이어서 매우 신중하게 사용해야 하는 방법이 된다.</p>
<p>다음은 함수 <code>left_join()</code>에 의한 결과를 살펴보자.
key 변수 지정은 함수 <code>join_by()</code>을 사용하겠다.</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="ch6.html#cb709-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb709-2"><a href="ch6.html#cb709-2" tabindex="-1"></a>  <span class="fu">left_join</span>(band_instruments, <span class="at">by =</span> <span class="fu">join_by</span>(name))</span>
<span id="cb709-3"><a href="ch6.html#cb709-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 3</span></span>
<span id="cb709-4"><a href="ch6.html#cb709-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb709-5"><a href="ch6.html#cb709-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb709-6"><a href="ch6.html#cb709-6" tabindex="-1"></a><span class="do">## 1 Mick  Stones  &lt;NA&gt;  </span></span>
<span id="cb709-7"><a href="ch6.html#cb709-7" tabindex="-1"></a><span class="do">## 2 John  Beatles guitar</span></span>
<span id="cb709-8"><a href="ch6.html#cb709-8" tabindex="-1"></a><span class="do">## 3 Paul  Beatles bass</span></span></code></pre></div>
<p><code>band_members</code>에 있는 관찰값은 모두 유지가 된 상태에서 <code>band_instruments</code>에 있는 변수 <code>plays</code>가 새로운 변수로 추가되었다. 만일 첫 번째 데이터 프레임이 주로 분석에 사용되는 데이터 프레임이고, 두 번째 데이터 프레임에 있는 변수를 첫 번째 데이터 프레임에 추가하는 작업을 하고자 한다면 적절하게 사용될 수 있는 함수이다.</p>
<p>함수 <code>right_join()</code>은 두 번째 데이터 프레임이 주로 분석에 사용되는 데이터 프레임이고 첫 번째 데이터 프레임에 있는 변수를 추가하고자 할 때 사용할 수 있는 함수이다.</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="ch6.html#cb710-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb710-2"><a href="ch6.html#cb710-2" tabindex="-1"></a>  <span class="fu">right_join</span>(band_instruments, <span class="at">by =</span> <span class="fu">join_by</span>(name))</span>
<span id="cb710-3"><a href="ch6.html#cb710-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 3</span></span>
<span id="cb710-4"><a href="ch6.html#cb710-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb710-5"><a href="ch6.html#cb710-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb710-6"><a href="ch6.html#cb710-6" tabindex="-1"></a><span class="do">## 1 John  Beatles guitar</span></span>
<span id="cb710-7"><a href="ch6.html#cb710-7" tabindex="-1"></a><span class="do">## 2 Paul  Beatles bass  </span></span>
<span id="cb710-8"><a href="ch6.html#cb710-8" tabindex="-1"></a><span class="do">## 3 Keith &lt;NA&gt;    guitar</span></span></code></pre></div>
<p>두 번째 데이터 프레임인 <code>band_instuments</code>에 있는 관찰값은 모두 유지가 되었고, 첫번째 데이터 프레임인 <code>band_members</code>에 없는 마지막 관찰값의 경우에는 추가된 변수 <code>band</code>에 <code>NA</code>가 할당되었다.</p>
<p>이번에는 함수 <code>full_join()</code>에 의한 결과를 살펴보자.</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="ch6.html#cb711-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb711-2"><a href="ch6.html#cb711-2" tabindex="-1"></a>  <span class="fu">full_join</span>(band_instruments, <span class="at">by =</span> <span class="fu">join_by</span>(name))</span>
<span id="cb711-3"><a href="ch6.html#cb711-3" tabindex="-1"></a><span class="do">## # A tibble: 4 × 3</span></span>
<span id="cb711-4"><a href="ch6.html#cb711-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb711-5"><a href="ch6.html#cb711-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb711-6"><a href="ch6.html#cb711-6" tabindex="-1"></a><span class="do">## 1 Mick  Stones  &lt;NA&gt;  </span></span>
<span id="cb711-7"><a href="ch6.html#cb711-7" tabindex="-1"></a><span class="do">## 2 John  Beatles guitar</span></span>
<span id="cb711-8"><a href="ch6.html#cb711-8" tabindex="-1"></a><span class="do">## 3 Paul  Beatles bass  </span></span>
<span id="cb711-9"><a href="ch6.html#cb711-9" tabindex="-1"></a><span class="do">## 4 Keith &lt;NA&gt;    guitar</span></span></code></pre></div>
<p>두 데이터 프레임에 있는 모든 관찰값이 유지되었다. 만일 행(관찰값)과 열(변수)을 모두 확장하는 방향으로 두 데이터 프레임을 결합을 하고자 한다면 가장 적절하게 사용할 수 있는 함수이다.</p>
<p>이번에는 데이터 프레임 <code>band_members</code>와 <code>band_instruments2</code>를 결합해 보자.</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="ch6.html#cb712-1" tabindex="-1"></a>band_members</span>
<span id="cb712-2"><a href="ch6.html#cb712-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb712-3"><a href="ch6.html#cb712-3" tabindex="-1"></a><span class="do">##   name  band   </span></span>
<span id="cb712-4"><a href="ch6.html#cb712-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;  </span></span>
<span id="cb712-5"><a href="ch6.html#cb712-5" tabindex="-1"></a><span class="do">## 1 Mick  Stones </span></span>
<span id="cb712-6"><a href="ch6.html#cb712-6" tabindex="-1"></a><span class="do">## 2 John  Beatles</span></span>
<span id="cb712-7"><a href="ch6.html#cb712-7" tabindex="-1"></a><span class="do">## 3 Paul  Beatles</span></span></code></pre></div>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="ch6.html#cb713-1" tabindex="-1"></a>band_instruments2</span>
<span id="cb713-2"><a href="ch6.html#cb713-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb713-3"><a href="ch6.html#cb713-3" tabindex="-1"></a><span class="do">##   artist plays </span></span>
<span id="cb713-4"><a href="ch6.html#cb713-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt;  &lt;chr&gt; </span></span>
<span id="cb713-5"><a href="ch6.html#cb713-5" tabindex="-1"></a><span class="do">## 1 John   guitar</span></span>
<span id="cb713-6"><a href="ch6.html#cb713-6" tabindex="-1"></a><span class="do">## 2 Paul   bass  </span></span>
<span id="cb713-7"><a href="ch6.html#cb713-7" tabindex="-1"></a><span class="do">## 3 Keith  guitar</span></span></code></pre></div>
<p><code>band_members</code>의 <code>name</code>과 <code>band_instruments2</code>의 <code>artist</code>를 key 변수로 사용해야 하는 경우가 된다.
함수 <code>left_join()</code>의 결과를 살펴보자.</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="ch6.html#cb714-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb714-2"><a href="ch6.html#cb714-2" tabindex="-1"></a>  <span class="fu">left_join</span>(band_instruments2, <span class="at">by =</span> <span class="fu">join_by</span>(name <span class="sc">==</span> artist))</span>
<span id="cb714-3"><a href="ch6.html#cb714-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 3</span></span>
<span id="cb714-4"><a href="ch6.html#cb714-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb714-5"><a href="ch6.html#cb714-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb714-6"><a href="ch6.html#cb714-6" tabindex="-1"></a><span class="do">## 1 Mick  Stones  &lt;NA&gt;  </span></span>
<span id="cb714-7"><a href="ch6.html#cb714-7" tabindex="-1"></a><span class="do">## 2 John  Beatles guitar</span></span>
<span id="cb714-8"><a href="ch6.html#cb714-8" tabindex="-1"></a><span class="do">## 3 Paul  Beatles bass</span></span></code></pre></div>
<p>다른 함수의 실행 결과도 살펴보자.</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="ch6.html#cb715-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb715-2"><a href="ch6.html#cb715-2" tabindex="-1"></a>  <span class="fu">inner_join</span>(band_instruments2, <span class="at">by =</span> <span class="fu">join_by</span>(name <span class="sc">==</span> artist))</span>
<span id="cb715-3"><a href="ch6.html#cb715-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 3</span></span>
<span id="cb715-4"><a href="ch6.html#cb715-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb715-5"><a href="ch6.html#cb715-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb715-6"><a href="ch6.html#cb715-6" tabindex="-1"></a><span class="do">## 1 John  Beatles guitar</span></span>
<span id="cb715-7"><a href="ch6.html#cb715-7" tabindex="-1"></a><span class="do">## 2 Paul  Beatles bass</span></span></code></pre></div>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="ch6.html#cb716-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb716-2"><a href="ch6.html#cb716-2" tabindex="-1"></a>  <span class="fu">right_join</span>(band_instruments2, <span class="at">by =</span> <span class="fu">join_by</span>(name <span class="sc">==</span> artist))</span>
<span id="cb716-3"><a href="ch6.html#cb716-3" tabindex="-1"></a><span class="do">## # A tibble: 3 × 3</span></span>
<span id="cb716-4"><a href="ch6.html#cb716-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb716-5"><a href="ch6.html#cb716-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb716-6"><a href="ch6.html#cb716-6" tabindex="-1"></a><span class="do">## 1 John  Beatles guitar</span></span>
<span id="cb716-7"><a href="ch6.html#cb716-7" tabindex="-1"></a><span class="do">## 2 Paul  Beatles bass  </span></span>
<span id="cb716-8"><a href="ch6.html#cb716-8" tabindex="-1"></a><span class="do">## 3 Keith &lt;NA&gt;    guitar</span></span></code></pre></div>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="ch6.html#cb717-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb717-2"><a href="ch6.html#cb717-2" tabindex="-1"></a>  <span class="fu">full_join</span>(band_instruments2, <span class="at">by =</span> <span class="fu">join_by</span>(name <span class="sc">==</span> artist))</span>
<span id="cb717-3"><a href="ch6.html#cb717-3" tabindex="-1"></a><span class="do">## # A tibble: 4 × 3</span></span>
<span id="cb717-4"><a href="ch6.html#cb717-4" tabindex="-1"></a><span class="do">##   name  band    plays </span></span>
<span id="cb717-5"><a href="ch6.html#cb717-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span id="cb717-6"><a href="ch6.html#cb717-6" tabindex="-1"></a><span class="do">## 1 Mick  Stones  &lt;NA&gt;  </span></span>
<span id="cb717-7"><a href="ch6.html#cb717-7" tabindex="-1"></a><span class="do">## 2 John  Beatles guitar</span></span>
<span id="cb717-8"><a href="ch6.html#cb717-8" tabindex="-1"></a><span class="do">## 3 Paul  Beatles bass  </span></span>
<span id="cb717-9"><a href="ch6.html#cb717-9" tabindex="-1"></a><span class="do">## 4 Keith &lt;NA&gt;    guitar</span></span></code></pre></div>
<p><strong>2. Filtering joins</strong></p>
<p>많은 경우 데이터 프레임의 결합은 행 또는 열을 확대하는 방향으로 이루어진다. 하지만 어떤 경우에는 다른 데이터 프레임과 공통적으로 갖고 있는 행(관찰값)만을 유지하거나 공통적으로 갖고 있는 행을 삭제해야 할 때가 있다. 이러한 결합을 위해 사용할 수 있는 함수가 다음과 같다.</p>
<ul>
<li><p>함수 <code>semi_join(df1, df2)</code>: <code>df1</code>의 행 중에 <code>df2</code>에 있는 모든 행 유지</p></li>
<li><p>함수 <code>anti_join(df1, df2)</code>: <code>df1</code>의 행 중에 <code>df2</code>에 있는 모든 행 삭제</p></li>
</ul>
<p>예를 들어 <code>band_members</code>와 <code>band_instruments</code>를 대상으로 두 함수를 적용해 보자.
Key 변수의 지정은 Mutating joins의 경우와 동일하게 함수 <code>join_by()</code>를 사용하면 된다.</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="ch6.html#cb718-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb718-2"><a href="ch6.html#cb718-2" tabindex="-1"></a>  <span class="fu">semi_join</span>(band_instruments, <span class="at">by =</span> <span class="fu">join_by</span>(name))</span>
<span id="cb718-3"><a href="ch6.html#cb718-3" tabindex="-1"></a><span class="do">## # A tibble: 2 × 2</span></span>
<span id="cb718-4"><a href="ch6.html#cb718-4" tabindex="-1"></a><span class="do">##   name  band   </span></span>
<span id="cb718-5"><a href="ch6.html#cb718-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt;  </span></span>
<span id="cb718-6"><a href="ch6.html#cb718-6" tabindex="-1"></a><span class="do">## 1 John  Beatles</span></span>
<span id="cb718-7"><a href="ch6.html#cb718-7" tabindex="-1"></a><span class="do">## 2 Paul  Beatles</span></span></code></pre></div>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="ch6.html#cb719-1" tabindex="-1"></a>band_members <span class="sc">|&gt;</span> </span>
<span id="cb719-2"><a href="ch6.html#cb719-2" tabindex="-1"></a>  <span class="fu">anti_join</span>(band_instruments, <span class="at">by =</span> <span class="fu">join_by</span>(name))</span>
<span id="cb719-3"><a href="ch6.html#cb719-3" tabindex="-1"></a><span class="do">## # A tibble: 1 × 2</span></span>
<span id="cb719-4"><a href="ch6.html#cb719-4" tabindex="-1"></a><span class="do">##   name  band  </span></span>
<span id="cb719-5"><a href="ch6.html#cb719-5" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt; </span></span>
<span id="cb719-6"><a href="ch6.html#cb719-6" tabindex="-1"></a><span class="do">## 1 Mick  Stones</span></span></code></pre></div>
<p>함수 <code>semi_join()</code>에 의한 결합은 <code>band_members</code>의 행 중에 <code>band_instruments</code>에도 있는 두 행만을 유지한 결과를 보여주고 있으며, 함수 <code>anti_join()</code>은 <code>band_instruments</code>에 없는 하나의 행만을 선택했음을 보여주고 있다.</p>
<p><strong>3. 단순 수평 결합 및 수직 결합</strong></p>
<p>결합되는 데이터 프레임들이 행의 개수가 같고 각 행의 자료가 동일한 대상인 경우에는 데이터 프레임을 옆으로 붙여서 변수를 확대할 수 있다. 이 경우에 사용할 수 있는 함수가 <code>bind_cols()</code>이다. 대응되는 base R 함수는 <code>cbind()</code>이다.</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="ch6.html#cb720-1" tabindex="-1"></a>df_x <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x1 =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">x2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb720-2"><a href="ch6.html#cb720-2" tabindex="-1"></a>df_y <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y1 =</span> LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">y2 =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb720-3"><a href="ch6.html#cb720-3" tabindex="-1"></a>df_z <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x1 =</span> LETTERS[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">x2 =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span></code></pre></div>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="ch6.html#cb721-1" tabindex="-1"></a>df_x</span>
<span id="cb721-2"><a href="ch6.html#cb721-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb721-3"><a href="ch6.html#cb721-3" tabindex="-1"></a><span class="do">##   x1       x2</span></span>
<span id="cb721-4"><a href="ch6.html#cb721-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb721-5"><a href="ch6.html#cb721-5" tabindex="-1"></a><span class="do">## 1 a         1</span></span>
<span id="cb721-6"><a href="ch6.html#cb721-6" tabindex="-1"></a><span class="do">## 2 b         2</span></span>
<span id="cb721-7"><a href="ch6.html#cb721-7" tabindex="-1"></a><span class="do">## 3 c         3</span></span></code></pre></div>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="ch6.html#cb722-1" tabindex="-1"></a>df_y</span>
<span id="cb722-2"><a href="ch6.html#cb722-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb722-3"><a href="ch6.html#cb722-3" tabindex="-1"></a><span class="do">##   y1       y2</span></span>
<span id="cb722-4"><a href="ch6.html#cb722-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb722-5"><a href="ch6.html#cb722-5" tabindex="-1"></a><span class="do">## 1 D         4</span></span>
<span id="cb722-6"><a href="ch6.html#cb722-6" tabindex="-1"></a><span class="do">## 2 E         5</span></span>
<span id="cb722-7"><a href="ch6.html#cb722-7" tabindex="-1"></a><span class="do">## 3 F         6</span></span></code></pre></div>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="ch6.html#cb723-1" tabindex="-1"></a><span class="fu">bind_cols</span>(df_x, df_y)</span>
<span id="cb723-2"><a href="ch6.html#cb723-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 4</span></span>
<span id="cb723-3"><a href="ch6.html#cb723-3" tabindex="-1"></a><span class="do">##   x1       x2 y1       y2</span></span>
<span id="cb723-4"><a href="ch6.html#cb723-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb723-5"><a href="ch6.html#cb723-5" tabindex="-1"></a><span class="do">## 1 a         1 D         4</span></span>
<span id="cb723-6"><a href="ch6.html#cb723-6" tabindex="-1"></a><span class="do">## 2 b         2 E         5</span></span>
<span id="cb723-7"><a href="ch6.html#cb723-7" tabindex="-1"></a><span class="do">## 3 c         3 F         6</span></span></code></pre></div>
<p>결합되는 데이터 프레임들의 열의 개수 및 이름이 같은 경우에는 위아래로 붙여서 케이스를 확대하는 방향으로 결합할 수 있다. 이런 경우에 사용할 수 있는 함수가 <code>bind_rows()</code>이다. 옵션 <code>.id</code>에 열 이름을 지정하면 각 행이 어떤 데이터 프레임에서 온 것인지를 구분해 주는 열이 첫 번째 열로 추가된다.</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="ch6.html#cb724-1" tabindex="-1"></a>df_x</span>
<span id="cb724-2"><a href="ch6.html#cb724-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb724-3"><a href="ch6.html#cb724-3" tabindex="-1"></a><span class="do">##   x1       x2</span></span>
<span id="cb724-4"><a href="ch6.html#cb724-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb724-5"><a href="ch6.html#cb724-5" tabindex="-1"></a><span class="do">## 1 a         1</span></span>
<span id="cb724-6"><a href="ch6.html#cb724-6" tabindex="-1"></a><span class="do">## 2 b         2</span></span>
<span id="cb724-7"><a href="ch6.html#cb724-7" tabindex="-1"></a><span class="do">## 3 c         3</span></span></code></pre></div>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="ch6.html#cb725-1" tabindex="-1"></a>df_z</span>
<span id="cb725-2"><a href="ch6.html#cb725-2" tabindex="-1"></a><span class="do">## # A tibble: 3 × 2</span></span>
<span id="cb725-3"><a href="ch6.html#cb725-3" tabindex="-1"></a><span class="do">##   x1       x2</span></span>
<span id="cb725-4"><a href="ch6.html#cb725-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb725-5"><a href="ch6.html#cb725-5" tabindex="-1"></a><span class="do">## 1 D         4</span></span>
<span id="cb725-6"><a href="ch6.html#cb725-6" tabindex="-1"></a><span class="do">## 2 E         5</span></span>
<span id="cb725-7"><a href="ch6.html#cb725-7" tabindex="-1"></a><span class="do">## 3 F         6</span></span></code></pre></div>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="ch6.html#cb726-1" tabindex="-1"></a><span class="fu">bind_rows</span>(df_x, df_z, <span class="at">.id =</span> <span class="st">&quot;df&quot;</span>)</span>
<span id="cb726-2"><a href="ch6.html#cb726-2" tabindex="-1"></a><span class="do">## # A tibble: 6 × 3</span></span>
<span id="cb726-3"><a href="ch6.html#cb726-3" tabindex="-1"></a><span class="do">##   df    x1       x2</span></span>
<span id="cb726-4"><a href="ch6.html#cb726-4" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb726-5"><a href="ch6.html#cb726-5" tabindex="-1"></a><span class="do">## 1 1     a         1</span></span>
<span id="cb726-6"><a href="ch6.html#cb726-6" tabindex="-1"></a><span class="do">## 2 1     b         2</span></span>
<span id="cb726-7"><a href="ch6.html#cb726-7" tabindex="-1"></a><span class="do">## 3 1     c         3</span></span>
<span id="cb726-8"><a href="ch6.html#cb726-8" tabindex="-1"></a><span class="do">## 4 2     D         4</span></span>
<span id="cb726-9"><a href="ch6.html#cb726-9" tabindex="-1"></a><span class="do">## 5 2     E         5</span></span>
<span id="cb726-10"><a href="ch6.html#cb726-10" tabindex="-1"></a><span class="do">## 6 2     F         6</span></span></code></pre></div>
</div>
<div id="stringr에-의한-문자-다루기" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> <code>stringr</code>에 의한 문자 다루기<a href="ch6.html#stringr에-의한-문자-다루기" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Base R에도 함수 <code>nchar()</code>나 <code>paste()</code> 등과 같이 문자열을 다루는 함수들이 있다. 유용하게 사용되는 함수들이지만 함수 이름에 일관성이 없어서 기억하기 쉽지 않다는 문제가 있다. 이에 반하여 패키지 <code>stringr</code>의 함수들은 모두 <code>str_</code>로 시작되며, 비교적 어렵지 않게 의미를 파악할 수 있는 이름을 갖고 있어서, 주어진 상황에 필요한 함수가 무엇인지 상대적으로 기억하기 쉽다는 장점이 있다.</p>
<div id="stringr의-함수" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> <code>stringr</code>의 함수<a href="ch6.html#stringr의-함수" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_length()</code> : 문자열의 문자 개수 세기</strong></p>
<p>문자열을 구성하는 문자의 개수를 세는 함수이며, base R에서 대응되는 함수는 <code>nchar()</code>이다.</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="ch6.html#cb727-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb727-2"><a href="ch6.html#cb727-2" tabindex="-1"></a><span class="fu">str_length</span>(<span class="fu">c</span>(<span class="st">&quot;Park&quot;</span>,<span class="st">&quot;Lee&quot;</span>,<span class="st">&quot;Oh&quot;</span>, <span class="cn">NA</span>))</span>
<span id="cb727-3"><a href="ch6.html#cb727-3" tabindex="-1"></a><span class="do">## [1]  4  3  2 NA</span></span></code></pre></div>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="ch6.html#cb728-1" tabindex="-1"></a><span class="fu">str_length</span>(<span class="st">&quot;응용통계학과&quot;</span>)</span>
<span id="cb728-2"><a href="ch6.html#cb728-2" tabindex="-1"></a><span class="do">## [1] 6</span></span></code></pre></div>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_c()</code>: 문자열의 결합</strong></p>
<p>문자열 및 문자형 벡터의 결합에 사용되는 함수이며, base R에서 대응되는 함수는 <code>paste0()</code>이다.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="ch6.html#cb729-1" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&quot;Stat&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb729-2"><a href="ch6.html#cb729-2" tabindex="-1"></a><span class="do">## [1] &quot;Stat1&quot; &quot;Stat2&quot; &quot;Stat3&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="ch6.html#cb730-1" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&quot;Stat&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)</span>
<span id="cb730-2"><a href="ch6.html#cb730-2" tabindex="-1"></a><span class="do">## [1] &quot;Stat-1&quot; &quot;Stat-2&quot; &quot;Stat-3&quot;</span></span></code></pre></div>
<p>옵션 <code>collapse</code>를 사용하면 문자형 벡터를 구성하는 문자열을 하나로 묶는 작업을 할 수 있다.</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="ch6.html#cb731-1" tabindex="-1"></a><span class="fu">str_c</span>(letters, <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb731-2"><a href="ch6.html#cb731-2" tabindex="-1"></a><span class="do">## [1] &quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="ch6.html#cb732-1" tabindex="-1"></a><span class="fu">str_c</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">collapse =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb732-2"><a href="ch6.html#cb732-2" tabindex="-1"></a><span class="do">## [1] &quot;aA,bB,cC,dD,eE&quot;</span></span></code></pre></div>
<p>문자형 벡터에 <code>NA</code>가 있는 경우에는 다른 문자형 벡터와의 결합 결과도 당연히 <code>NA</code>가 된다.</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="ch6.html#cb733-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Stat&quot;</span>, <span class="st">&quot;Math&quot;</span>, <span class="cn">NA</span>)</span>
<span id="cb733-2"><a href="ch6.html#cb733-2" tabindex="-1"></a><span class="fu">str_c</span>(x, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb733-3"><a href="ch6.html#cb733-3" tabindex="-1"></a><span class="do">## [1] &quot;Stat/1&quot; &quot;Math/2&quot; NA</span></span></code></pre></div>
<p>만일 결측값 <code>NA</code>를 문자열 <code>"NA"</code>로 표시하고자 한다면 함수 <code>str_replace_na()</code>를 사용하면 된다.</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="ch6.html#cb734-1" tabindex="-1"></a>(y <span class="ot">&lt;-</span> <span class="fu">str_replace_na</span>(x))</span>
<span id="cb734-2"><a href="ch6.html#cb734-2" tabindex="-1"></a><span class="do">## [1] &quot;Stat&quot; &quot;Math&quot; &quot;NA&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="ch6.html#cb735-1" tabindex="-1"></a><span class="fu">str_c</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb735-2"><a href="ch6.html#cb735-2" tabindex="-1"></a><span class="do">## [1] &quot;Stat/1&quot; &quot;Math/2&quot; &quot;NA/3&quot;</span></span></code></pre></div>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_dup()</code>: 문자열의 반복</strong></p>
<p>주어진 문자열을 반복시켜서 새로운 문자열을 만들 때 편리하게 사용할 수 있는 함수이다. 반복 대상이 되는 문자열 혹은 문자형 벡터를 입력하고 반복시킬 횟수를 <code>times</code>에 지정하면 된다.</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="ch6.html#cb736-1" tabindex="-1"></a><span class="fu">str_dup</span>(<span class="st">&quot;a&quot;</span>, <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb736-2"><a href="ch6.html#cb736-2" tabindex="-1"></a><span class="do">## [1] &quot;aaa&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="ch6.html#cb737-1" tabindex="-1"></a><span class="fu">str_dup</span>(<span class="st">&quot;a&quot;</span>, <span class="at">times =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb737-2"><a href="ch6.html#cb737-2" tabindex="-1"></a><span class="do">## [1] &quot;a&quot;    &quot;aa&quot;   &quot;aaa&quot;  &quot;aaaa&quot;</span></span></code></pre></div>
<p>반복 대상이 벡터인 경우에는 <code>times</code>에 스칼라 혹은 반복 대상이 되는 벡터와 같은 길이의 숫자형 벡터를 지정해야 한다.</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="ch6.html#cb738-1" tabindex="-1"></a><span class="fu">str_dup</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb738-2"><a href="ch6.html#cb738-2" tabindex="-1"></a><span class="do">## [1] &quot;aaa&quot; &quot;bbb&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="ch6.html#cb739-1" tabindex="-1"></a><span class="fu">str_dup</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb739-2"><a href="ch6.html#cb739-2" tabindex="-1"></a><span class="do">## [1] &quot;aa&quot;  &quot;bbb&quot;</span></span></code></pre></div>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_sub()</code>: 문자열에서 일부분 선택</strong></p>
<p>주어진 문자열에서 일부분을 추출하거나 혹은 선택한 일부분을 교체하는 작업을 하는 함수이며, 대응되는 R base 함수는 <code>substr()</code>이다. 추출 대상이 되는 문자열을 입력하고 <code>start</code>와 <code>end</code>에 시작점과 끝점의 위치를 나타내는 정수를 지정하면 된다. 양의 정수는 문자열의 왼쪽 끝에서부터의 위치를 나타내고, 음의 정수는 문자열의 오른쪽 끝에서부터의 위치를 나타낸다. 디폴트 값은 <code>start=1L</code>, <code>end=-1L</code>로써, 입력된 문자열 전체가 그대로 출력된다.</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="ch6.html#cb740-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>, <span class="st">&quot;Pear&quot;</span>)</span>
<span id="cb740-2"><a href="ch6.html#cb740-2" tabindex="-1"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">2</span>)</span>
<span id="cb740-3"><a href="ch6.html#cb740-3" tabindex="-1"></a><span class="do">## [1] &quot;Ap&quot; &quot;Ba&quot; &quot;Pe&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="ch6.html#cb741-1" tabindex="-1"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">end =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb741-2"><a href="ch6.html#cb741-2" tabindex="-1"></a><span class="do">## [1] &quot;le&quot; &quot;na&quot; &quot;ar&quot;</span></span></code></pre></div>
<p>문자열에서 선택한 일부분을 교체하는 작업은 <code>str_sub() &lt;-</code>의 형식으로 이루어진다. 예를 들어 문자형 벡터 <code>y</code>의 첫 글자를 모두 대문자로 교체해 보자. 영문자를 소문자로 교체하는 작업은 함수 <code>str_to_lower()</code>로 할 수 있고, 대문자로 교체하는 작업은 함수 <code>str_to_upper()</code>로 할 수 있다.</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="ch6.html#cb742-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;pear&quot;</span>)</span>
<span id="cb742-2"><a href="ch6.html#cb742-2" tabindex="-1"></a><span class="fu">str_sub</span>(y, <span class="dv">1</span>, <span class="dv">1</span>) <span class="ot">&lt;-</span> <span class="fu">str_to_upper</span>(<span class="fu">str_sub</span>(y, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb742-3"><a href="ch6.html#cb742-3" tabindex="-1"></a>y</span>
<span id="cb742-4"><a href="ch6.html#cb742-4" tabindex="-1"></a><span class="do">## [1] &quot;Apple&quot;  &quot;Banana&quot; &quot;Pear&quot;</span></span></code></pre></div>
<p>이번에는 다음에 주어진 벡터 <code>w</code>의 첫 글자를 제외한 나머지 모든 글자를 소문자로 교체해 보자.</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="ch6.html#cb743-1" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;APPLE&quot;</span>, <span class="st">&quot;BANANA&quot;</span>, <span class="st">&quot;PEAR&quot;</span>)</span>
<span id="cb743-2"><a href="ch6.html#cb743-2" tabindex="-1"></a><span class="fu">str_sub</span>(w, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="ot">&lt;-</span> <span class="fu">str_to_lower</span>(<span class="fu">str_sub</span>(w, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb743-3"><a href="ch6.html#cb743-3" tabindex="-1"></a>w</span>
<span id="cb743-4"><a href="ch6.html#cb743-4" tabindex="-1"></a><span class="do">## [1] &quot;Apple&quot;  &quot;Banana&quot; &quot;Pear&quot;</span></span></code></pre></div>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_split()</code>: 문자열의 분할</strong></p>
<p>하나의 문자열을 여러 개로 분할하는 작업을 하는 함수이며, 대응되는 base R 함수는 <code>strsplit()</code>이다. 분할 대상이 되는 문자열을 입력하고 이어서 분할 기준이 되는 패턴을 입력하면 된다. 옵션 <code>simplify</code>에 <code>TRUE</code>를 지정하면 결과가 행렬로 출력되며, 디폴트인 <code>FALSE</code>가 지정되면 리스트로 출력된다.</p>
<p>다음의 벡터 <code>x</code>의 문자열을 콤마를 기준으로 분리해 보자.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="ch6.html#cb744-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;New York, NY&quot;</span>, <span class="st">&quot;Ann Arbor, MI&quot;</span>, <span class="st">&quot;Chicago, IL&quot;</span>)</span>
<span id="cb744-2"><a href="ch6.html#cb744-2" tabindex="-1"></a><span class="fu">str_split</span>(x, <span class="st">&quot;,&quot;</span>)</span>
<span id="cb744-3"><a href="ch6.html#cb744-3" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb744-4"><a href="ch6.html#cb744-4" tabindex="-1"></a><span class="do">## [1] &quot;New York&quot; &quot; NY&quot;     </span></span>
<span id="cb744-5"><a href="ch6.html#cb744-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb744-6"><a href="ch6.html#cb744-6" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb744-7"><a href="ch6.html#cb744-7" tabindex="-1"></a><span class="do">## [1] &quot;Ann Arbor&quot; &quot; MI&quot;      </span></span>
<span id="cb744-8"><a href="ch6.html#cb744-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb744-9"><a href="ch6.html#cb744-9" tabindex="-1"></a><span class="do">## [[3]]</span></span>
<span id="cb744-10"><a href="ch6.html#cb744-10" tabindex="-1"></a><span class="do">## [1] &quot;Chicago&quot; &quot; IL&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="ch6.html#cb745-1" tabindex="-1"></a><span class="fu">str_split</span>(x, <span class="st">&quot;,&quot;</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb745-2"><a href="ch6.html#cb745-2" tabindex="-1"></a><span class="do">##      [,1]        [,2] </span></span>
<span id="cb745-3"><a href="ch6.html#cb745-3" tabindex="-1"></a><span class="do">## [1,] &quot;New York&quot;  &quot; NY&quot;</span></span>
<span id="cb745-4"><a href="ch6.html#cb745-4" tabindex="-1"></a><span class="do">## [2,] &quot;Ann Arbor&quot; &quot; MI&quot;</span></span>
<span id="cb745-5"><a href="ch6.html#cb745-5" tabindex="-1"></a><span class="do">## [3,] &quot;Chicago&quot;   &quot; IL&quot;</span></span></code></pre></div>
<p>빈칸을 기준으로 문자열을 분리하는 것도 가능하다. 다음의 벡터 <code>y</code>의 문자열을 빈칸을 기준으로 분리해 보자.</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="ch6.html#cb746-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red apple&quot;</span>, <span class="st">&quot;yellow banana&quot;</span>)</span>
<span id="cb746-2"><a href="ch6.html#cb746-2" tabindex="-1"></a><span class="fu">str_split</span>(y, <span class="st">&quot; &quot;</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb746-3"><a href="ch6.html#cb746-3" tabindex="-1"></a><span class="do">##      [,1]     [,2]    </span></span>
<span id="cb746-4"><a href="ch6.html#cb746-4" tabindex="-1"></a><span class="do">## [1,] &quot;red&quot;    &quot;apple&quot; </span></span>
<span id="cb746-5"><a href="ch6.html#cb746-5" tabindex="-1"></a><span class="do">## [2,] &quot;yellow&quot; &quot;banana&quot;</span></span></code></pre></div>
<p>벡터 ’y’의 두 문자열은 하나의 빈칸으로 구분되어 있기 때문에 함수 <code>str_split()</code>에 입력되는 패턴은 정확히 하나의 빈칸이 인용 부호로 감싸져 있어야 한다. 만일 두 칸 이상의 빈칸을 패턴으로 입력하면 문자열의 분리는 이루어지지 않는다.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="ch6.html#cb747-1" tabindex="-1"></a><span class="fu">str_split</span>(y, <span class="st">&quot;   &quot;</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb747-2"><a href="ch6.html#cb747-2" tabindex="-1"></a><span class="do">##      [,1]           </span></span>
<span id="cb747-3"><a href="ch6.html#cb747-3" tabindex="-1"></a><span class="do">## [1,] &quot;red apple&quot;    </span></span>
<span id="cb747-4"><a href="ch6.html#cb747-4" tabindex="-1"></a><span class="do">## [2,] &quot;yellow banana&quot;</span></span></code></pre></div>
<p>주어진 문자열을 개별 문자로 분리하고자 한다면 인용 부호 사이에 빈칸을 없애고 입력하면 된다.</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="ch6.html#cb748-1" tabindex="-1"></a><span class="fu">str_split</span>(y, <span class="st">&quot;&quot;</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb748-2"><a href="ch6.html#cb748-2" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]</span></span>
<span id="cb748-3"><a href="ch6.html#cb748-3" tabindex="-1"></a><span class="do">## [1,] &quot;r&quot;  &quot;e&quot;  &quot;d&quot;  &quot; &quot;  &quot;a&quot;  &quot;p&quot;  &quot;p&quot;  &quot;l&quot;  &quot;e&quot;  &quot;&quot;    &quot;&quot;    &quot;&quot;    &quot;&quot;   </span></span>
<span id="cb748-4"><a href="ch6.html#cb748-4" tabindex="-1"></a><span class="do">## [2,] &quot;y&quot;  &quot;e&quot;  &quot;l&quot;  &quot;l&quot;  &quot;o&quot;  &quot;w&quot;  &quot; &quot;  &quot;b&quot;  &quot;a&quot;  &quot;n&quot;   &quot;a&quot;   &quot;n&quot;   &quot;a&quot;</span></span></code></pre></div>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_replace()</code>와 <code>str_replace_all()</code>: 문자열의 치환</strong></p>
<p>문자열의 일부분을 치환하는 작업을 하는 함수이며, 대응되는 base R 함수로는 <code>sub()</code>와 <code>gsub()</code>이다. 두 함수의 기본적인 사용법은 동일하다. 먼저 문자열 혹은 문자형 벡터를 입력하고 이어서 치환 대상이 되는 패턴을 입력한 후 새롭게 바꾸려는 문자열을 그 다음에 입력하면 된다. 두 함수의 차이는 <code>str_replace()</code>가 지정된 패턴과 첫 번째 매치가 되는 문자열만을 치환하는 데 반하여 <code>str_replace_all()</code>은 패턴과 매치가 되는 모든 문자열을 치환한다는 점이다.</p>
<p>다음의 벡터 <code>x</code>에서 소문자 a를 찾아서 대문자 A로 바꾸는 작업을 두 함수로 각각 시행해 보자.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="ch6.html#cb749-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">&quot;banana&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb749-2"><a href="ch6.html#cb749-2" tabindex="-1"></a><span class="fu">str_replace</span>(x, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;A&quot;</span>)</span>
<span id="cb749-3"><a href="ch6.html#cb749-3" tabindex="-1"></a><span class="do">## [1] &quot;bAnana1&quot; &quot;bAnana2&quot; &quot;bAnana3&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="ch6.html#cb750-1" tabindex="-1"></a><span class="fu">str_replace_all</span>(x, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;A&quot;</span>)</span>
<span id="cb750-2"><a href="ch6.html#cb750-2" tabindex="-1"></a><span class="do">## [1] &quot;bAnAnA1&quot; &quot;bAnAnA2&quot; &quot;bAnAnA3&quot;</span></span></code></pre></div>
<p>함수 <code>str_replace_all()</code>의 경우에는 문자형 벡터의 각 문자열마다 각기 다른 내용의 치환을 실시할 수 있다. 이 경우에는 치환 대상이 되는 패턴과 새롭게 바꾸려는 문자열을 각각 등호로 연결을 해야 한다.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="ch6.html#cb751-1" tabindex="-1"></a>(x <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">&quot;banana&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb751-2"><a href="ch6.html#cb751-2" tabindex="-1"></a><span class="do">## [1] &quot;banana1&quot; &quot;banana2&quot; &quot;banana3&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="ch6.html#cb752-1" tabindex="-1"></a><span class="fu">str_replace_all</span>(x, <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot; one&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot; two&quot;</span>, <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot; three&quot;</span>))</span>
<span id="cb752-2"><a href="ch6.html#cb752-2" tabindex="-1"></a><span class="do">## [1] &quot;banana one&quot;   &quot;banana two&quot;   &quot;banana three&quot;</span></span></code></pre></div>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_remove()</code>와 <code>str_remove_all()</code>: 문자열의 제거</strong></p>
<p>문자열 중 특정 문자를 제거하는 작업을 하는 함수이다.
문자열 제거는 함수 <code>str_replace()</code>와 <code>str_replace_all()</code>로 가능하지만, <code>str_remove()</code>와 <code>str_remove_all()</code>를 사용하는 것이 더 간편한 방법이 된다.</p>
<p>다음의 벡터 <code>x</code>에서 소문자 a를 제거해보자.</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="ch6.html#cb753-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">str_dup</span>(<span class="st">&quot;a&quot;</span>, <span class="at">times =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb753-2"><a href="ch6.html#cb753-2" tabindex="-1"></a>  <span class="fu">str_c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb753-3"><a href="ch6.html#cb753-3" tabindex="-1"></a>x</span>
<span id="cb753-4"><a href="ch6.html#cb753-4" tabindex="-1"></a><span class="do">## [1] &quot;a1&quot;    &quot;aa2&quot;   &quot;aaa3&quot;  &quot;aaaa4&quot;</span></span></code></pre></div>
<p>함수 <code>str_remove()</code>는 첫 번째 <code>a</code>만 제거하고, <code>str_remove_all()</code>은 모든 <code>a</code>를 제거한다.</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="ch6.html#cb754-1" tabindex="-1"></a><span class="fu">str_remove</span>(x, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb754-2"><a href="ch6.html#cb754-2" tabindex="-1"></a><span class="do">## [1] &quot;1&quot;    &quot;a2&quot;   &quot;aa3&quot;  &quot;aaa4&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="ch6.html#cb755-1" tabindex="-1"></a><span class="fu">str_remove_all</span>(x, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb755-2"><a href="ch6.html#cb755-2" tabindex="-1"></a><span class="do">## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;</span></span></code></pre></div>
<p>함수 <code>str_replace()</code>와 <code>str_replace_all()</code>를 사용하는 방법은 다음과 같다.</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="ch6.html#cb756-1" tabindex="-1"></a><span class="fu">str_replace</span>(x, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb756-2"><a href="ch6.html#cb756-2" tabindex="-1"></a><span class="do">## [1] &quot;1&quot;    &quot;a2&quot;   &quot;aa3&quot;  &quot;aaa4&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="ch6.html#cb757-1" tabindex="-1"></a><span class="fu">str_replace_all</span>(x, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb757-2"><a href="ch6.html#cb757-2" tabindex="-1"></a><span class="do">## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;</span></span></code></pre></div>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_detect( )</code>, <code>str_count()</code>: 매치되는 패턴의 존재 여부 확인 및 개수 계산</strong></p>
<p>주어진 문자열에서 매치되는 패턴의 존재 여부를 확인하는 작업과 매치되는 패턴의 개수를 세는 작업은 주어진 문자열의 특성을 파악하는데 큰 도움이 될 수 있다. 예를 들어 주어진 문장에 특정 단어의 포함 여부 및 포함 횟수를 파악함으로써 그 문장의 대략적인 의미를 미루어 짐작할 수 있을 것이다.</p>
<p>함수 <code>str_count()</code>의 사용법은 문자열을 먼저 입력하고 이어서 패턴을 입력하면 된다. 벡터 <code>x</code>를 구성하고 있는 각 문자열에 소문자 <code>"p"</code>의 존재 여부 확인 및 매치되는 패턴의 개수는 다음과 같이 확인할 수 있다.</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="ch6.html#cb758-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;pear&quot;</span>)</span>
<span id="cb758-2"><a href="ch6.html#cb758-2" tabindex="-1"></a><span class="fu">str_detect</span>(x, <span class="st">&quot;p&quot;</span>)</span>
<span id="cb758-3"><a href="ch6.html#cb758-3" tabindex="-1"></a><span class="do">## [1]  TRUE FALSE  TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="ch6.html#cb759-1" tabindex="-1"></a><span class="fu">str_count</span>(x, <span class="st">&quot;p&quot;</span>)</span>
<span id="cb759-2"><a href="ch6.html#cb759-2" tabindex="-1"></a><span class="do">## [1] 2 0 1</span></span></code></pre></div>
<p>패키지 <code>stringr</code>에 있는 <code>words</code>는 980개의 단어로 구성된 문자형 벡터로, 처음 5개 단어는 다음과 같다.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="ch6.html#cb760-1" tabindex="-1"></a><span class="fu">length</span>(words)</span>
<span id="cb760-2"><a href="ch6.html#cb760-2" tabindex="-1"></a><span class="do">## [1] 980</span></span></code></pre></div>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="ch6.html#cb761-1" tabindex="-1"></a>words[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb761-2"><a href="ch6.html#cb761-2" tabindex="-1"></a><span class="do">## [1] &quot;a&quot;        &quot;able&quot;     &quot;about&quot;    &quot;absolute&quot; &quot;accept&quot;</span></span></code></pre></div>
<p>벡터 <code>words</code>의 980개 단어에 사용된 모음 중 가장 빈번하게 사용된 모음이 어떤 것인지 함수 <code>str_count()</code>로 다음과 같이 확인할 수 있다. 모음 <code>"e"</code>가 686번 사용되어 가장 빈번하게 사용되었음을 알 수 있다.</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="ch6.html#cb762-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">str_count</span>(words, <span class="st">&quot;a&quot;</span>))</span>
<span id="cb762-2"><a href="ch6.html#cb762-2" tabindex="-1"></a><span class="do">## [1] 385</span></span></code></pre></div>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="ch6.html#cb763-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">str_count</span>(words, <span class="st">&quot;e&quot;</span>))</span>
<span id="cb763-2"><a href="ch6.html#cb763-2" tabindex="-1"></a><span class="do">## [1] 686</span></span></code></pre></div>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="ch6.html#cb764-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">str_count</span>(words, <span class="st">&quot;i&quot;</span>))</span>
<span id="cb764-2"><a href="ch6.html#cb764-2" tabindex="-1"></a><span class="do">## [1] 319</span></span></code></pre></div>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="ch6.html#cb765-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">str_count</span>(words, <span class="st">&quot;o&quot;</span>))</span>
<span id="cb765-2"><a href="ch6.html#cb765-2" tabindex="-1"></a><span class="do">## [1] 373</span></span></code></pre></div>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="ch6.html#cb766-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">str_count</span>(words, <span class="st">&quot;u&quot;</span>))</span>
<span id="cb766-2"><a href="ch6.html#cb766-2" tabindex="-1"></a><span class="do">## [1] 189</span></span></code></pre></div>
<p>모음 <code>"e"</code>가 포함된 단어의 개수는 다음과 같이 확인할 수 있다.</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="ch6.html#cb767-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">str_detect</span>(words, <span class="st">&quot;e&quot;</span>))</span>
<span id="cb767-2"><a href="ch6.html#cb767-2" tabindex="-1"></a><span class="do">## [1] 536</span></span></code></pre></div>
<p>데이터 프레임 <code>babynames::babynames</code>에는 연도별로 많이 사용되는 신생아 이름과 동일 이름의 신생아 수, 그리고 해당 연도를 기준으로 동일 이름의 신생아 비율이 입력되어 있다.</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="ch6.html#cb768-1" tabindex="-1"></a><span class="fu">library</span>(babynames)</span>
<span id="cb768-2"><a href="ch6.html#cb768-2" tabindex="-1"></a>babynames</span>
<span id="cb768-3"><a href="ch6.html#cb768-3" tabindex="-1"></a><span class="do">## # A tibble: 1,924,665 × 5</span></span>
<span id="cb768-4"><a href="ch6.html#cb768-4" tabindex="-1"></a><span class="do">##     year sex   name          n   prop</span></span>
<span id="cb768-5"><a href="ch6.html#cb768-5" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;</span></span>
<span id="cb768-6"><a href="ch6.html#cb768-6" tabindex="-1"></a><span class="do">##  1  1880 F     Mary       7065 0.0724</span></span>
<span id="cb768-7"><a href="ch6.html#cb768-7" tabindex="-1"></a><span class="do">##  2  1880 F     Anna       2604 0.0267</span></span>
<span id="cb768-8"><a href="ch6.html#cb768-8" tabindex="-1"></a><span class="do">##  3  1880 F     Emma       2003 0.0205</span></span>
<span id="cb768-9"><a href="ch6.html#cb768-9" tabindex="-1"></a><span class="do">##  4  1880 F     Elizabeth  1939 0.0199</span></span>
<span id="cb768-10"><a href="ch6.html#cb768-10" tabindex="-1"></a><span class="do">##  5  1880 F     Minnie     1746 0.0179</span></span>
<span id="cb768-11"><a href="ch6.html#cb768-11" tabindex="-1"></a><span class="do">##  6  1880 F     Margaret   1578 0.0162</span></span>
<span id="cb768-12"><a href="ch6.html#cb768-12" tabindex="-1"></a><span class="do">##  7  1880 F     Ida        1472 0.0151</span></span>
<span id="cb768-13"><a href="ch6.html#cb768-13" tabindex="-1"></a><span class="do">##  8  1880 F     Alice      1414 0.0145</span></span>
<span id="cb768-14"><a href="ch6.html#cb768-14" tabindex="-1"></a><span class="do">##  9  1880 F     Bertha     1320 0.0135</span></span>
<span id="cb768-15"><a href="ch6.html#cb768-15" tabindex="-1"></a><span class="do">## 10  1880 F     Sarah      1288 0.0132</span></span>
<span id="cb768-16"><a href="ch6.html#cb768-16" tabindex="-1"></a><span class="do">## # ℹ 1,924,655 more rows</span></span></code></pre></div>
<p>신생아 이름 중 소문자 “x”가 들어있는 이름을 선택해 보자.</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="ch6.html#cb769-1" tabindex="-1"></a>babynames <span class="sc">|&gt;</span> </span>
<span id="cb769-2"><a href="ch6.html#cb769-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(name, <span class="st">&quot;x&quot;</span>))</span>
<span id="cb769-3"><a href="ch6.html#cb769-3" tabindex="-1"></a><span class="do">## # A tibble: 16,317 × 5</span></span>
<span id="cb769-4"><a href="ch6.html#cb769-4" tabindex="-1"></a><span class="do">##     year sex   name          n      prop</span></span>
<span id="cb769-5"><a href="ch6.html#cb769-5" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;     &lt;dbl&gt;</span></span>
<span id="cb769-6"><a href="ch6.html#cb769-6" tabindex="-1"></a><span class="do">##  1  1880 F     Roxie        62 0.000635 </span></span>
<span id="cb769-7"><a href="ch6.html#cb769-7" tabindex="-1"></a><span class="do">##  2  1880 F     Dixie        15 0.000154 </span></span>
<span id="cb769-8"><a href="ch6.html#cb769-8" tabindex="-1"></a><span class="do">##  3  1880 F     Roxanna       9 0.0000922</span></span>
<span id="cb769-9"><a href="ch6.html#cb769-9" tabindex="-1"></a><span class="do">##  4  1880 F     Texas         5 0.0000512</span></span>
<span id="cb769-10"><a href="ch6.html#cb769-10" tabindex="-1"></a><span class="do">##  5  1880 M     Alexander   211 0.00178  </span></span>
<span id="cb769-11"><a href="ch6.html#cb769-11" tabindex="-1"></a><span class="do">##  6  1880 M     Alex        147 0.00124  </span></span>
<span id="cb769-12"><a href="ch6.html#cb769-12" tabindex="-1"></a><span class="do">##  7  1880 M     Felix        92 0.000777 </span></span>
<span id="cb769-13"><a href="ch6.html#cb769-13" tabindex="-1"></a><span class="do">##  8  1880 M     Max          52 0.000439 </span></span>
<span id="cb769-14"><a href="ch6.html#cb769-14" tabindex="-1"></a><span class="do">##  9  1880 M     Axel         16 0.000135 </span></span>
<span id="cb769-15"><a href="ch6.html#cb769-15" tabindex="-1"></a><span class="do">## 10  1880 M     Rex          13 0.000110 </span></span>
<span id="cb769-16"><a href="ch6.html#cb769-16" tabindex="-1"></a><span class="do">## # ℹ 16,307 more rows</span></span></code></pre></div>
<p>소문자 “x”가 들어있는 이름 중 가장 많이 사용되는 이름을 찾기 위해서는 함수 <code>count()</code>에서 변수 <code>n</code>을 가중값으로 사용해야 한다.</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="ch6.html#cb770-1" tabindex="-1"></a>babynames <span class="sc">|&gt;</span> </span>
<span id="cb770-2"><a href="ch6.html#cb770-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(name, <span class="st">&quot;x&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb770-3"><a href="ch6.html#cb770-3" tabindex="-1"></a>  <span class="fu">count</span>(name, <span class="at">wt =</span> n, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb770-4"><a href="ch6.html#cb770-4" tabindex="-1"></a><span class="do">## # A tibble: 974 × 2</span></span>
<span id="cb770-5"><a href="ch6.html#cb770-5" tabindex="-1"></a><span class="do">##    name            n</span></span>
<span id="cb770-6"><a href="ch6.html#cb770-6" tabindex="-1"></a><span class="do">##    &lt;chr&gt;       &lt;int&gt;</span></span>
<span id="cb770-7"><a href="ch6.html#cb770-7" tabindex="-1"></a><span class="do">##  1 Alexander  665492</span></span>
<span id="cb770-8"><a href="ch6.html#cb770-8" tabindex="-1"></a><span class="do">##  2 Alexis     399551</span></span>
<span id="cb770-9"><a href="ch6.html#cb770-9" tabindex="-1"></a><span class="do">##  3 Alex       278705</span></span>
<span id="cb770-10"><a href="ch6.html#cb770-10" tabindex="-1"></a><span class="do">##  4 Alexandra  232223</span></span>
<span id="cb770-11"><a href="ch6.html#cb770-11" tabindex="-1"></a><span class="do">##  5 Max        148787</span></span>
<span id="cb770-12"><a href="ch6.html#cb770-12" tabindex="-1"></a><span class="do">##  6 Alexa      123032</span></span>
<span id="cb770-13"><a href="ch6.html#cb770-13" tabindex="-1"></a><span class="do">##  7 Maxine     112261</span></span>
<span id="cb770-14"><a href="ch6.html#cb770-14" tabindex="-1"></a><span class="do">##  8 Alexandria  97679</span></span>
<span id="cb770-15"><a href="ch6.html#cb770-15" tabindex="-1"></a><span class="do">##  9 Maxwell     90486</span></span>
<span id="cb770-16"><a href="ch6.html#cb770-16" tabindex="-1"></a><span class="do">## 10 Jaxon       71234</span></span>
<span id="cb770-17"><a href="ch6.html#cb770-17" tabindex="-1"></a><span class="do">## # ℹ 964 more rows</span></span></code></pre></div>
<p>이번에는 소문자 “x”가 들어있는 이름의 연도별 비율을 구해보자.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="ch6.html#cb771-1" tabindex="-1"></a>babynames <span class="sc">|&gt;</span> </span>
<span id="cb771-2"><a href="ch6.html#cb771-2" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb771-3"><a href="ch6.html#cb771-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">prop_x =</span> <span class="fu">mean</span>(<span class="fu">str_detect</span>(name, <span class="st">&quot;x&quot;</span>)))</span>
<span id="cb771-4"><a href="ch6.html#cb771-4" tabindex="-1"></a><span class="do">## # A tibble: 138 × 2</span></span>
<span id="cb771-5"><a href="ch6.html#cb771-5" tabindex="-1"></a><span class="do">##     year  prop_x</span></span>
<span id="cb771-6"><a href="ch6.html#cb771-6" tabindex="-1"></a><span class="do">##    &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb771-7"><a href="ch6.html#cb771-7" tabindex="-1"></a><span class="do">##  1  1880 0.0065 </span></span>
<span id="cb771-8"><a href="ch6.html#cb771-8" tabindex="-1"></a><span class="do">##  2  1881 0.00879</span></span>
<span id="cb771-9"><a href="ch6.html#cb771-9" tabindex="-1"></a><span class="do">##  3  1882 0.00940</span></span>
<span id="cb771-10"><a href="ch6.html#cb771-10" tabindex="-1"></a><span class="do">##  4  1883 0.00768</span></span>
<span id="cb771-11"><a href="ch6.html#cb771-11" tabindex="-1"></a><span class="do">##  5  1884 0.00827</span></span>
<span id="cb771-12"><a href="ch6.html#cb771-12" tabindex="-1"></a><span class="do">##  6  1885 0.00872</span></span>
<span id="cb771-13"><a href="ch6.html#cb771-13" tabindex="-1"></a><span class="do">##  7  1886 0.00878</span></span>
<span id="cb771-14"><a href="ch6.html#cb771-14" tabindex="-1"></a><span class="do">##  8  1887 0.00801</span></span>
<span id="cb771-15"><a href="ch6.html#cb771-15" tabindex="-1"></a><span class="do">##  9  1888 0.00905</span></span>
<span id="cb771-16"><a href="ch6.html#cb771-16" tabindex="-1"></a><span class="do">## 10  1889 0.00888</span></span>
<span id="cb771-17"><a href="ch6.html#cb771-17" tabindex="-1"></a><span class="do">## # ℹ 128 more rows</span></span></code></pre></div>
<p>이 경우에는 비율을 그대로 출력하는 것보다 그래프로 표현하는 것이 더 효과적인 방식이라 할 수 있다.</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="ch6.html#cb772-1" tabindex="-1"></a>babynames <span class="sc">|&gt;</span> </span>
<span id="cb772-2"><a href="ch6.html#cb772-2" tabindex="-1"></a>    <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb772-3"><a href="ch6.html#cb772-3" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">prop_x =</span> <span class="fu">mean</span>(<span class="fu">str_detect</span>(name, <span class="st">&quot;x&quot;</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb772-4"><a href="ch6.html#cb772-4" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> prop_x)) <span class="sc">+</span></span>
<span id="cb772-5"><a href="ch6.html#cb772-5" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-711-1.png" width="576" /></p>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_subset()</code>: 매치되는 패턴이 포함된 문자열 추출</strong></p>
<p>매치되는 패턴의 개수를 세는 것도 중요한 작업이지만 패턴이 포함된 문자열 자체를 추출하는 것 또한 매우 의미 있는 작업이다. 함수 <code>str_subset()</code>은 주어진 문자열 중에 지정한 패턴이 포함되어 있는 문자열 자체를 추출할 수 있는데, 예를 들어 문자형 벡터 <code>words</code>에서 소문자 <code>"x"</code>가 포함된 단어는 다음과 같이 찾을 수 있다.</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="ch6.html#cb773-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb773-2"><a href="ch6.html#cb773-2" tabindex="-1"></a><span class="do">##  [1] &quot;box&quot;        &quot;exact&quot;      &quot;example&quot;    &quot;except&quot;     &quot;excuse&quot;    </span></span>
<span id="cb773-3"><a href="ch6.html#cb773-3" tabindex="-1"></a><span class="do">##  [6] &quot;exercise&quot;   &quot;exist&quot;      &quot;expect&quot;     &quot;expense&quot;    &quot;experience&quot;</span></span>
<span id="cb773-4"><a href="ch6.html#cb773-4" tabindex="-1"></a><span class="do">## [11] &quot;explain&quot;    &quot;express&quot;    &quot;extra&quot;      &quot;next&quot;       &quot;sex&quot;       </span></span>
<span id="cb773-5"><a href="ch6.html#cb773-5" tabindex="-1"></a><span class="do">## [16] &quot;six&quot;        &quot;tax&quot;</span></span></code></pre></div>
<p><strong><span class="math inline">\(\bullet\)</span> <code>str_extract()</code>와 <code>str_extract_all()</code>: 매치되는 패턴 추출</strong></p>
<p>매치되는 패턴이 포함된 문자열 전체를 추출해내는 것도 의미가 있지만, 각 문자열에서 매치되는 패턴만을 추출하는 것도 상당히 의미가 있다. 함수 <code>str_extract()</code>는 각 문자열에서 첫 번째로 매치되는 패턴을 추출하여 벡터로 출력한다. 반면에 함수 <code>str_extract_all()</code>은 매치되는 모든 패턴을 추출하여 리스트로 출력하며, 만일 옵션 <code>simplify=TRUE</code>를 추가하면 결과를 문자형 행렬로 출력한다.</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="ch6.html#cb774-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ab&quot;</span>, <span class="st">&quot;acb&quot;</span>, <span class="st">&quot;acab&quot;</span>, <span class="st">&quot;abcab&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="ch6.html#cb775-1" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;ab&quot;</span>)</span>
<span id="cb775-2"><a href="ch6.html#cb775-2" tabindex="-1"></a><span class="do">## [1] &quot;ab&quot; NA   &quot;ab&quot; &quot;ab&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="ch6.html#cb776-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;ab&quot;</span>)</span>
<span id="cb776-2"><a href="ch6.html#cb776-2" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb776-3"><a href="ch6.html#cb776-3" tabindex="-1"></a><span class="do">## [1] &quot;ab&quot;</span></span>
<span id="cb776-4"><a href="ch6.html#cb776-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb776-5"><a href="ch6.html#cb776-5" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb776-6"><a href="ch6.html#cb776-6" tabindex="-1"></a><span class="do">## character(0)</span></span>
<span id="cb776-7"><a href="ch6.html#cb776-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb776-8"><a href="ch6.html#cb776-8" tabindex="-1"></a><span class="do">## [[3]]</span></span>
<span id="cb776-9"><a href="ch6.html#cb776-9" tabindex="-1"></a><span class="do">## [1] &quot;ab&quot;</span></span>
<span id="cb776-10"><a href="ch6.html#cb776-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb776-11"><a href="ch6.html#cb776-11" tabindex="-1"></a><span class="do">## [[4]]</span></span>
<span id="cb776-12"><a href="ch6.html#cb776-12" tabindex="-1"></a><span class="do">## [1] &quot;ab&quot; &quot;ab&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="ch6.html#cb777-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;ab&quot;</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb777-2"><a href="ch6.html#cb777-2" tabindex="-1"></a><span class="do">##      [,1] [,2]</span></span>
<span id="cb777-3"><a href="ch6.html#cb777-3" tabindex="-1"></a><span class="do">## [1,] &quot;ab&quot; &quot;&quot;  </span></span>
<span id="cb777-4"><a href="ch6.html#cb777-4" tabindex="-1"></a><span class="do">## [2,] &quot;&quot;   &quot;&quot;  </span></span>
<span id="cb777-5"><a href="ch6.html#cb777-5" tabindex="-1"></a><span class="do">## [3,] &quot;ab&quot; &quot;&quot;  </span></span>
<span id="cb777-6"><a href="ch6.html#cb777-6" tabindex="-1"></a><span class="do">## [4,] &quot;ab&quot; &quot;ab&quot;</span></span></code></pre></div>
</div>
<div id="정규-표현식과-stringr의-함수" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> 정규 표현식과 <code>stringr</code>의 함수<a href="ch6.html#정규-표현식과-stringr의-함수" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>정규 표현식(regular expression)은 문자열에 있는 패턴을 표현하는 방식을 의미하는 것으로써, R에서만 다뤄지는 것이 아니라 문자열을 다루는 모든 프로그램에서 공통적으로 사용되는 매우 강력하고 유용한 기법이다. 이 절에서는 정규 표현식의 기초적인 내용을 살펴보고, 패키지 <code>stringr</code>의 함수와 함께 사용해보고자 한다.</p>
<p>문자열의 패턴 중 가장 단순한 형태는 문자열 자체이다. 예를 들어 문자형 벡터 <code>words</code>에서 소문자 <code>"x"</code>가 포함된 단어를 찾는 경우, 함수 <code>str_subset()</code>에서 사용되는 패턴은 소문자 <code>"x"</code>가 된다. 앞 절에서 살펴본 패키지 <code>stringr</code>의 함수들에 대한 예제에서 사용된 패턴은 모두 문자열 자체였다.</p>
<p>조금 복잡해진 문자열 패턴의 예로서 문자형 벡터 <code>words</code>에서 소문자 <code>"x"</code>로 끝나는 단어를 찾는 경우를 생각해 볼 수 있다. 이 경우에는 정규 표현식의 메타 문자 <code>$</code>을 사용하면 다음과 같이 간단하게 해당 단어를 찾을 수 있다.</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="ch6.html#cb778-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;x$&quot;</span>)</span>
<span id="cb778-2"><a href="ch6.html#cb778-2" tabindex="-1"></a><span class="do">## [1] &quot;box&quot; &quot;sex&quot; &quot;six&quot; &quot;tax&quot;</span></span></code></pre></div>
<p>이와 같이 정규 표현식을 패키지 <code>stringr</code>의 함수들과 함께 사용하면 한층 업그레이드된 강력한 분석 능력을 가질 수 있게 된다.</p>
<p><strong><span class="math inline">\(\bullet\)</span> 메타 문자(Meta character)</strong></p>
<p>정규 표현식에서 메타 문자란 특별한 의미를 갖고 있는 문자를 지칭하는 것으로써 다음의 문자들이 메타 문자에 해당한다.</p>
<pre><code>.  \  |  (  )  [  ]  {  }  ^  $  *  +  ?</code></pre>
<p>이제 각 메타 문자의 의미를 살펴보자.</p>
<ol style="list-style-type: decimal">
<li>점(<code>.</code>) : 모든 문자와 매치</li>
</ol>
<p>점(<code>.</code>)은 모든 문자와 매치가 된다. 문자형 벡터 <code>x</code>의 문자열 중에 소문자 <code>"a"</code>에 이어서 임의의 문자가 오는 패턴이 있는 문자열을 추출해 보자.</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="ch6.html#cb780-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;abac&quot;</span>, <span class="st">&quot;adc&quot;</span>, <span class="st">&quot;cba&quot;</span>)</span>
<span id="cb780-2"><a href="ch6.html#cb780-2" tabindex="-1"></a><span class="fu">str_subset</span>(x, <span class="st">&quot;a.&quot;</span>)</span>
<span id="cb780-3"><a href="ch6.html#cb780-3" tabindex="-1"></a><span class="do">## [1] &quot;abac&quot; &quot;adc&quot;</span></span></code></pre></div>
<p>벡터 <code>x</code>을 구성하는 각 문자열에서 소문자 <code>"a"</code>에 이어서 임의의 문자가 오는 패턴을 추출해 보자.</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="ch6.html#cb781-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;abac&quot;</span>, <span class="st">&quot;adc&quot;</span>, <span class="st">&quot;cba&quot;</span>)</span>
<span id="cb781-2"><a href="ch6.html#cb781-2" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;a.&quot;</span>)</span>
<span id="cb781-3"><a href="ch6.html#cb781-3" tabindex="-1"></a><span class="do">## [1] &quot;ab&quot; &quot;ad&quot; NA</span></span></code></pre></div>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="ch6.html#cb782-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;a.&quot;</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb782-2"><a href="ch6.html#cb782-2" tabindex="-1"></a><span class="do">##      [,1] [,2]</span></span>
<span id="cb782-3"><a href="ch6.html#cb782-3" tabindex="-1"></a><span class="do">## [1,] &quot;ab&quot; &quot;ac&quot;</span></span>
<span id="cb782-4"><a href="ch6.html#cb782-4" tabindex="-1"></a><span class="do">## [2,] &quot;ad&quot; &quot;&quot;  </span></span>
<span id="cb782-5"><a href="ch6.html#cb782-5" tabindex="-1"></a><span class="do">## [3,] &quot;&quot;   &quot;&quot;</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>역슬래시(<code>\</code>): 탈출 문자(Escape character)</li>
</ol>
<p>점(<code>.</code>)은 메타 문자로서 모든 문자와 매치된다. 그렇다면 문자 자체로서의 <code>"."</code>은 어떻게 매치해야 하는가? 예를 들어 다음의 벡터 <code>x</code>에서 문자열 중에 있는 점(<code>.</code>)을 함수 <code>str_extract()</code>로 추출해 보자.</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="ch6.html#cb783-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a.c&quot;</span>, <span class="st">&quot;abc&quot;</span>)</span>
<span id="cb783-2"><a href="ch6.html#cb783-2" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;.&quot;</span>)</span>
<span id="cb783-3"><a href="ch6.html#cb783-3" tabindex="-1"></a><span class="do">## [1] &quot;a&quot; &quot;a&quot;</span></span></code></pre></div>
<p>추출 결과는 점이 아니라 각 문자열의 첫 문자인 <code>"a"</code>가 출력되었다. 이러한 경우에는 메타 문자의 기능을 없애고 문자 자체의 의미만을 남겨두는 것이 필요한데, 이때 사용되는 것이 메타 문자의 기능에서 탈출시킨다는 의미를 갖고 있어서 탈출 문자라고 불리는 역슬래시(<code>\</code>)이다.</p>
<p>여기에서 한 가지 문제는 정규 표현식에서 탈출 문자로 사용되는 역슬래시가 문자열 자체에서도 탈출 문자로 사용된다는 점이다. 예를 들어, <code>"\n"</code>은 줄을 바꾸는 기호이고, <code>"\t"</code>은 탭 기호를 의미한다.<br />
따라서 문자 자체로써의 역슬래시 하나를 문자열에 포함시키기 위해서는 <code>"\\"</code>와 같이 두 개를 연속해서 사용해야 하며, 이러한 이유로 해서 정규 표현식 <code>\.</code>을 작성하기 위한 문자열은 <code>"\\."</code>이 되어야 한다.</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="ch6.html#cb784-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a.c&quot;</span>, <span class="st">&quot;abc&quot;</span>)</span>
<span id="cb784-2"><a href="ch6.html#cb784-2" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>)</span>
<span id="cb784-3"><a href="ch6.html#cb784-3" tabindex="-1"></a><span class="do">## [1] &quot;.&quot; NA</span></span></code></pre></div>
<p>또한 탈출 문자로 사용되는 역슬래시를 문자 자체로써 매치하려는 정규 표현식은 <code>\\</code>이 되며, 이것을 작성하기 위한 문자열은 <code>"\\\\"</code>이 된다.</p>
<p>다음의 벡터 <code>x</code>를 구성하는 문자열 중에 있는 역슬래시를 추출해 보자.</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="ch6.html#cb785-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a</span><span class="sc">\\</span><span class="st">b&quot;</span>, <span class="st">&quot;a</span><span class="sc">\\</span><span class="st">.b&quot;</span>, <span class="st">&quot;aeb&quot;</span>)</span>
<span id="cb785-2"><a href="ch6.html#cb785-2" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;</span><span class="sc">\\\\</span><span class="st">&quot;</span>)</span>
<span id="cb785-3"><a href="ch6.html#cb785-3" tabindex="-1"></a><span class="do">## [1] &quot;\\&quot; &quot;\\&quot; NA</span></span></code></pre></div>
<p>문자열을 그냥 출력하면 탈출 문자가 포함된 상태에서의 결과를 보여준다. 탈출 문자를 제거한 문자열 실제 모습을 보기 위해서는 함수 <code>writeLines()</code>를 사용해야 한다.</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="ch6.html#cb786-1" tabindex="-1"></a>x</span>
<span id="cb786-2"><a href="ch6.html#cb786-2" tabindex="-1"></a><span class="do">## [1] &quot;a\\b&quot;  &quot;a\\.b&quot; &quot;aeb&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="ch6.html#cb787-1" tabindex="-1"></a><span class="fu">writeLines</span>(x)</span>
<span id="cb787-2"><a href="ch6.html#cb787-2" tabindex="-1"></a><span class="do">## a\b</span></span>
<span id="cb787-3"><a href="ch6.html#cb787-3" tabindex="-1"></a><span class="do">## a\.b</span></span>
<span id="cb787-4"><a href="ch6.html#cb787-4" tabindex="-1"></a><span class="do">## aeb</span></span></code></pre></div>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="ch6.html#cb788-1" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">str_extract</span>(x, <span class="st">&quot;</span><span class="sc">\\\\</span><span class="st">&quot;</span>))</span>
<span id="cb788-2"><a href="ch6.html#cb788-2" tabindex="-1"></a><span class="do">## \</span></span>
<span id="cb788-3"><a href="ch6.html#cb788-3" tabindex="-1"></a><span class="do">## \</span></span>
<span id="cb788-4"><a href="ch6.html#cb788-4" tabindex="-1"></a><span class="do">## NA</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><code>^</code>과 <code>$</code>: 위치 지정</li>
</ol>
<p>정규 표현식은 문자열의 위치에 관계 없이 매치되는 것이 일반적이다. 하지만 어떤 경우에는 위치를 지정해서 문자열의 시작 부분 혹은 끝 부분과 매치가 되도록 하는 것이 매우 효과적일 수 있다. 메타 문자 <code>^</code>은 문자열의 시작 부분을, <code>$</code>는 문자열의 끝 부분을 각각 지정하는 데에 사용된다.</p>
<p>다음의 벡터 <code>x</code>에서 <code>"a"</code>로 시작하는 문자열과 <code>"a"</code>로 끝나는 문자열에서 문자 <code>"a"</code>를 각각 추출해 보자.</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="ch6.html#cb789-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;pear&quot;</span>)</span>
<span id="cb789-2"><a href="ch6.html#cb789-2" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;^a&quot;</span>)</span>
<span id="cb789-3"><a href="ch6.html#cb789-3" tabindex="-1"></a><span class="do">## [1] &quot;a&quot; NA  NA</span></span></code></pre></div>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="ch6.html#cb790-1" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;a$&quot;</span>)</span>
<span id="cb790-2"><a href="ch6.html#cb790-2" tabindex="-1"></a><span class="do">## [1] NA  &quot;a&quot; NA</span></span></code></pre></div>
<p>지정된 문자열만이 매치되도록 하기 위해서는 <code>^</code>와 <code>$</code>을 함께 사용하면 된다.</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="ch6.html#cb791-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;apple pie&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;apple cake&quot;</span>)</span>
<span id="cb791-2"><a href="ch6.html#cb791-2" tabindex="-1"></a><span class="fu">str_extract</span>(x,<span class="st">&quot;apple&quot;</span>)</span>
<span id="cb791-3"><a href="ch6.html#cb791-3" tabindex="-1"></a><span class="do">## [1] &quot;apple&quot; &quot;apple&quot; &quot;apple&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="ch6.html#cb792-1" tabindex="-1"></a><span class="fu">str_extract</span>(x,<span class="st">&quot;^apple$&quot;</span>)</span>
<span id="cb792-2"><a href="ch6.html#cb792-2" tabindex="-1"></a><span class="do">## [1] NA      &quot;apple&quot; NA</span></span></code></pre></div>
<p>벡터 <code>words</code>에 있는 단어 중 문자 <code>"y"</code>로 시작하는 단어와 <code>"x"</code>로 끝나는 단어, 그리고 두 문자로 이루어진 단어를 각각 추출해 보자.</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="ch6.html#cb793-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;^y&quot;</span>)</span>
<span id="cb793-2"><a href="ch6.html#cb793-2" tabindex="-1"></a><span class="do">## [1] &quot;year&quot;      &quot;yes&quot;       &quot;yesterday&quot; &quot;yet&quot;       &quot;you&quot;       &quot;young&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="ch6.html#cb794-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;x$&quot;</span>)</span>
<span id="cb794-2"><a href="ch6.html#cb794-2" tabindex="-1"></a><span class="do">## [1] &quot;box&quot; &quot;sex&quot; &quot;six&quot; &quot;tax&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="ch6.html#cb795-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;^..$&quot;</span>)</span>
<span id="cb795-2"><a href="ch6.html#cb795-2" tabindex="-1"></a><span class="do">##  [1] &quot;as&quot; &quot;at&quot; &quot;be&quot; &quot;by&quot; &quot;do&quot; &quot;go&quot; &quot;he&quot; &quot;if&quot; &quot;in&quot; &quot;it&quot; &quot;no&quot; &quot;of&quot; &quot;on&quot; &quot;or&quot; &quot;so&quot;</span></span>
<span id="cb795-3"><a href="ch6.html#cb795-3" tabindex="-1"></a><span class="do">## [16] &quot;to&quot; &quot;up&quot; &quot;we&quot;</span></span></code></pre></div>
<p>벡터 <code>words</code>에 있는 단어 중 세 문자로 이루어진 단어의 개수를 알아보자.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="ch6.html#cb796-1" tabindex="-1"></a>words <span class="sc">|&gt;</span> </span>
<span id="cb796-2"><a href="ch6.html#cb796-2" tabindex="-1"></a>  <span class="fu">str_count</span>(<span class="st">&quot;^...$&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb796-3"><a href="ch6.html#cb796-3" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb796-4"><a href="ch6.html#cb796-4" tabindex="-1"></a><span class="do">## [1] 110</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><code>[ ]</code>: 문자 클래스</li>
</ol>
<p>문자 클래스는 대괄호 안에 나열된 문자를 의미하는 것인데, 나열된 문자 중 한 문자와 매치가 된다.</p>
<p>다음의 벡터 <code>x</code>에서 <code>"e"</code> 또는 <code>"o"</code>가 있는 문자열을 추출해 보자.</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="ch6.html#cb797-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;adapt&quot;</span>, <span class="st">&quot;adept&quot;</span>, <span class="st">&quot;adopt&quot;</span>)</span>
<span id="cb797-2"><a href="ch6.html#cb797-2" tabindex="-1"></a><span class="fu">str_subset</span>(x, <span class="st">&quot;[eo]&quot;</span>)</span>
<span id="cb797-3"><a href="ch6.html#cb797-3" tabindex="-1"></a><span class="do">## [1] &quot;adept&quot; &quot;adopt&quot;</span></span></code></pre></div>
<p>패키지 <code>stringr</code>의 <code>fruit</code>은 80가지의 과일 이름으로 구성되어 있는 문자형 벡터이다. 이름이 모음으로 시작하는 과일을 <code>fruit</code>에서 찾아보자.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="ch6.html#cb798-1" tabindex="-1"></a><span class="fu">str_subset</span>(fruit, <span class="st">&quot;^[aeiou]&quot;</span>)</span>
<span id="cb798-2"><a href="ch6.html#cb798-2" tabindex="-1"></a><span class="do">## [1] &quot;apple&quot;      &quot;apricot&quot;    &quot;avocado&quot;    &quot;eggplant&quot;   &quot;elderberry&quot;</span></span>
<span id="cb798-3"><a href="ch6.html#cb798-3" tabindex="-1"></a><span class="do">## [6] &quot;olive&quot;      &quot;orange&quot;     &quot;ugli fruit&quot;</span></span></code></pre></div>
<p>문자 클래스에는 어떤 문자도 올 수 있지만 첫 문자가 <code>^</code>이면 정반대 의미의 매치가 이루어진다. 예를 들어 <code>[abc]</code>는 셋 중 어느 하나와 매치가 되지만 <code>[^abc]</code>는 세 문자를 제외한 다른 문자와 매치가 된다. 다음의 벡터 <code>x</code>에서 첫 문자가 <code>"a"</code> 또는 <code>"b"</code>가 아닌 문자열을 추출해 보자.</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="ch6.html#cb799-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;abc&quot;</span>, <span class="st">&quot;bcd&quot;</span>, <span class="st">&quot;cde&quot;</span>)</span>
<span id="cb799-2"><a href="ch6.html#cb799-2" tabindex="-1"></a><span class="fu">str_subset</span>(x, <span class="st">&quot;^[^ab]&quot;</span>)</span>
<span id="cb799-3"><a href="ch6.html#cb799-3" tabindex="-1"></a><span class="do">## [1] &quot;cde&quot;</span></span></code></pre></div>
<p>소문자 <code>"a"</code> 부터 <code>"z"</code>까지 중 어느 한 문자와의 매치를 <code>[abcdefghijklmnopqrstuvwxyz]</code>와 같이 구성할 수 있지만, 효율적인 방식은 아니라고 하겠고, 대신 하이픈을 이용해서 <code>[a-z]</code>로 할 수 있다. 따라서 소문자와 대문자를 포함한 모든 영문자 중 어느한 문자와의 매치는 <code>[A-Za-z]</code>로 작성할 수 있고, 숫자까지 포함시키고자 한다면, <code>[0-9A-Za-z]</code>로 작성할 수 있다.</p>
<p>하지만 더 효율적인 방식은 다음과 같이 미리 설정된 문자 클래스를 사용하는 것이다.</p>
<ul>
<li><p><code>[:punct:]</code> : 마침표, 쉼표 등의 구두점과 매치</p></li>
<li><p><code>[:alpha:]</code> : 글자와 매치</p></li>
<li><p><code>[:digit:]</code> : 숫자와 매치</p></li>
<li><p><code>[:alnum:]</code> : 숫자 및 글자와 매치</p></li>
<li><p><code>[:space:]</code> : 빈칸과 매치</p></li>
</ul>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="ch6.html#cb800-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;I have $20.&quot;</span>, <span class="st">&quot;내 키는 175cm 이다.&quot;</span>)</span>
<span id="cb800-2"><a href="ch6.html#cb800-2" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;[:punct:]&quot;</span>)</span>
<span id="cb800-3"><a href="ch6.html#cb800-3" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb800-4"><a href="ch6.html#cb800-4" tabindex="-1"></a><span class="do">## [1] &quot;.&quot;</span></span>
<span id="cb800-5"><a href="ch6.html#cb800-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb800-6"><a href="ch6.html#cb800-6" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb800-7"><a href="ch6.html#cb800-7" tabindex="-1"></a><span class="do">## [1] &quot;.&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="ch6.html#cb801-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;[:alpha:]&quot;</span>)</span>
<span id="cb801-2"><a href="ch6.html#cb801-2" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb801-3"><a href="ch6.html#cb801-3" tabindex="-1"></a><span class="do">## [1] &quot;I&quot; &quot;h&quot; &quot;a&quot; &quot;v&quot; &quot;e&quot;</span></span>
<span id="cb801-4"><a href="ch6.html#cb801-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb801-5"><a href="ch6.html#cb801-5" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb801-6"><a href="ch6.html#cb801-6" tabindex="-1"></a><span class="do">## [1] &quot;내&quot; &quot;키&quot; &quot;는&quot; &quot;c&quot;  &quot;m&quot;  &quot;이&quot; &quot;다&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="ch6.html#cb802-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;[:digit:]&quot;</span>)</span>
<span id="cb802-2"><a href="ch6.html#cb802-2" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb802-3"><a href="ch6.html#cb802-3" tabindex="-1"></a><span class="do">## [1] &quot;2&quot; &quot;0&quot;</span></span>
<span id="cb802-4"><a href="ch6.html#cb802-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb802-5"><a href="ch6.html#cb802-5" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb802-6"><a href="ch6.html#cb802-6" tabindex="-1"></a><span class="do">## [1] &quot;1&quot; &quot;7&quot; &quot;5&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="ch6.html#cb803-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;[:alnum:]&quot;</span>)</span>
<span id="cb803-2"><a href="ch6.html#cb803-2" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb803-3"><a href="ch6.html#cb803-3" tabindex="-1"></a><span class="do">## [1] &quot;I&quot; &quot;h&quot; &quot;a&quot; &quot;v&quot; &quot;e&quot; &quot;2&quot; &quot;0&quot;</span></span>
<span id="cb803-4"><a href="ch6.html#cb803-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb803-5"><a href="ch6.html#cb803-5" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb803-6"><a href="ch6.html#cb803-6" tabindex="-1"></a><span class="do">##  [1] &quot;내&quot; &quot;키&quot; &quot;는&quot; &quot;1&quot;  &quot;7&quot;  &quot;5&quot;  &quot;c&quot;  &quot;m&quot;  &quot;이&quot; &quot;다&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="ch6.html#cb804-1" tabindex="-1"></a><span class="fu">str_split</span>(x, <span class="st">&quot;[:space:]&quot;</span>)</span>
<span id="cb804-2"><a href="ch6.html#cb804-2" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb804-3"><a href="ch6.html#cb804-3" tabindex="-1"></a><span class="do">## [1] &quot;I&quot;    &quot;have&quot; &quot;$20.&quot;</span></span>
<span id="cb804-4"><a href="ch6.html#cb804-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb804-5"><a href="ch6.html#cb804-5" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb804-6"><a href="ch6.html#cb804-6" tabindex="-1"></a><span class="do">## [1] &quot;내&quot;    &quot;키는&quot;  &quot;175cm&quot; &quot;이다.&quot;</span></span></code></pre></div>
<p>탈출 문자를 사용한 다음과 같은 방식도 사용할 수 있다.</p>
<ul>
<li><p><code>\d</code> : 숫자와 매치</p></li>
<li><p><code>\D</code> : 숫자가 아닌 것과 매치</p></li>
<li><p><code>\w</code> : 숫자 및 글자와 매치</p></li>
<li><p><code>\W</code> : 숫자 및 글자가 아닌 것과 매치</p></li>
<li><p><code>\s</code> : 빈칸과 매치</p></li>
</ul>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="ch6.html#cb805-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Don&#39;t eat!&quot;</span>, <span class="st">&quot;1+2=3&quot;</span>)</span>
<span id="cb805-2"><a href="ch6.html#cb805-2" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span>
<span id="cb805-3"><a href="ch6.html#cb805-3" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb805-4"><a href="ch6.html#cb805-4" tabindex="-1"></a><span class="do">## character(0)</span></span>
<span id="cb805-5"><a href="ch6.html#cb805-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb805-6"><a href="ch6.html#cb805-6" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb805-7"><a href="ch6.html#cb805-7" tabindex="-1"></a><span class="do">## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="ch6.html#cb806-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">D&quot;</span>)</span>
<span id="cb806-2"><a href="ch6.html#cb806-2" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb806-3"><a href="ch6.html#cb806-3" tabindex="-1"></a><span class="do">##  [1] &quot;D&quot; &quot;o&quot; &quot;n&quot; &quot;&#39;&quot; &quot;t&quot; &quot; &quot; &quot;e&quot; &quot;a&quot; &quot;t&quot; &quot;!&quot;</span></span>
<span id="cb806-4"><a href="ch6.html#cb806-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb806-5"><a href="ch6.html#cb806-5" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb806-6"><a href="ch6.html#cb806-6" tabindex="-1"></a><span class="do">## [1] &quot;+&quot; &quot;=&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="ch6.html#cb807-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w&quot;</span>)</span>
<span id="cb807-2"><a href="ch6.html#cb807-2" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb807-3"><a href="ch6.html#cb807-3" tabindex="-1"></a><span class="do">## [1] &quot;D&quot; &quot;o&quot; &quot;n&quot; &quot;t&quot; &quot;e&quot; &quot;a&quot; &quot;t&quot;</span></span>
<span id="cb807-4"><a href="ch6.html#cb807-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb807-5"><a href="ch6.html#cb807-5" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb807-6"><a href="ch6.html#cb807-6" tabindex="-1"></a><span class="do">## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="ch6.html#cb808-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(x, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">W&quot;</span>)</span>
<span id="cb808-2"><a href="ch6.html#cb808-2" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb808-3"><a href="ch6.html#cb808-3" tabindex="-1"></a><span class="do">## [1] &quot;&#39;&quot; &quot; &quot; &quot;!&quot;</span></span>
<span id="cb808-4"><a href="ch6.html#cb808-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb808-5"><a href="ch6.html#cb808-5" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb808-6"><a href="ch6.html#cb808-6" tabindex="-1"></a><span class="do">## [1] &quot;+&quot; &quot;=&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="ch6.html#cb809-1" tabindex="-1"></a><span class="fu">str_split</span>(x, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s&quot;</span>)</span>
<span id="cb809-2"><a href="ch6.html#cb809-2" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb809-3"><a href="ch6.html#cb809-3" tabindex="-1"></a><span class="do">## [1] &quot;Don&#39;t&quot; &quot;eat!&quot; </span></span>
<span id="cb809-4"><a href="ch6.html#cb809-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb809-5"><a href="ch6.html#cb809-5" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb809-6"><a href="ch6.html#cb809-6" tabindex="-1"></a><span class="do">## [1] &quot;1+2=3&quot;</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li><code>|</code> : 대안 제시</li>
</ol>
<p>메타 문자 <code>|</code>은 OR의 의미를 갖고 있다.
한 개 이상의 패턴을 문자 <code>|</code>으로 연결해 놓으면, 그 중 어느 하나와 매치가 된다.
예를 들어 <code>"abc|def"</code>는 <code>"abc"</code> 혹은 <code>"def"</code>와 매치가 된다.</p>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="ch6.html#cb810-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;abc&quot;</span>, <span class="st">&quot;def&quot;</span> , <span class="st">&quot;ghi&quot;</span>)</span>
<span id="cb810-2"><a href="ch6.html#cb810-2" tabindex="-1"></a><span class="fu">str_detect</span>(x, <span class="st">&quot;a|d&quot;</span>)</span>
<span id="cb810-3"><a href="ch6.html#cb810-3" tabindex="-1"></a><span class="do">## [1]  TRUE  TRUE FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="ch6.html#cb811-1" tabindex="-1"></a><span class="fu">str_detect</span>(x, <span class="st">&quot;a|d|g&quot;</span>)</span>
<span id="cb811-2"><a href="ch6.html#cb811-2" tabindex="-1"></a><span class="do">## [1] TRUE TRUE TRUE</span></span></code></pre></div>
<p>문자 <code>|</code>은 우선 순위가 낮은 연산자이다.
이것 때문에 제시되는 패턴의 범위가 명확하지 않은 경우에는 괄호를 사용하여 범위를 명확하게 할 수 있다.
예를 들어 <code>"ab(c|d)ef"</code>는 <code>"abcef"</code> 또는 <code>"abdef"</code>와 매치가 된다.</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="ch6.html#cb812-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;abd&quot;</span>, <span class="st">&quot;acd&quot;</span>, <span class="st">&quot;abc&quot;</span>)</span>
<span id="cb812-2"><a href="ch6.html#cb812-2" tabindex="-1"></a><span class="fu">str_detect</span>(x, <span class="st">&quot;ab|cd&quot;</span>)</span>
<span id="cb812-3"><a href="ch6.html#cb812-3" tabindex="-1"></a><span class="do">## [1] TRUE TRUE TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="ch6.html#cb813-1" tabindex="-1"></a><span class="fu">str_detect</span>(x, <span class="st">&quot;a(b|c)d&quot;</span>)</span>
<span id="cb813-2"><a href="ch6.html#cb813-2" tabindex="-1"></a><span class="do">## [1]  TRUE  TRUE FALSE</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li><code>?</code>, <code>+</code>, <code>*</code> : 반복 연산자</li>
</ol>
<p>반복 연산자를 이용하면 제시되는 패턴의 매치 횟수를 조절할 수 있다.
반복 연산자로 사용되는 각 메타 문자의 의미는 다음과 같다.</p>
<ul>
<li><p><code>?</code> : 한 번 이하의 반복 (가능한 반복 횟수 = 0, 1)</p></li>
<li><p><code>+</code> : 한 번 이상의 반복 (가능한 반복 횟수 ≥ 1)</p></li>
<li><p><code>*</code> : 0번 이상의 반복 (가능한 반복 횟수 ≥ 0)</p></li>
</ul>
<p>반복 연산자는 반복 대상이 되는 패턴 바로 뒤에 붙이면 된다.
예를 들어 <code>colou?r</code>은 <code>u</code>의 1회 반복으로 <code>colour</code>과 매치가 되기도 하고,
0회 반복, 즉 제거되어 <code>color</code>와도 매치가 된다.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="ch6.html#cb814-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;color&quot;</span>, <span class="st">&quot;colour&quot;</span>)</span>
<span id="cb814-2"><a href="ch6.html#cb814-2" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;colou?r&quot;</span>)</span>
<span id="cb814-3"><a href="ch6.html#cb814-3" tabindex="-1"></a><span class="do">## [1] &quot;color&quot;  &quot;colour&quot;</span></span></code></pre></div>
<p>반복 대상이 되는 패턴이 두 개 이상의 문자인 경우에는 반드시 괄호로 감싸야 한다.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="ch6.html#cb815-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ba&quot;</span>, <span class="st">&quot;bana&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;bananana&quot;</span>)</span>
<span id="cb815-2"><a href="ch6.html#cb815-2" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;bana(na)?&quot;</span>)</span>
<span id="cb815-3"><a href="ch6.html#cb815-3" tabindex="-1"></a><span class="do">## [1] NA       &quot;bana&quot;   &quot;banana&quot; &quot;banana&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="ch6.html#cb816-1" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;bana(na)+&quot;</span>)</span>
<span id="cb816-2"><a href="ch6.html#cb816-2" tabindex="-1"></a><span class="do">## [1] NA         NA         &quot;banana&quot;   &quot;bananana&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="ch6.html#cb817-1" tabindex="-1"></a><span class="fu">str_extract</span>(x, <span class="st">&quot;bana(na)*&quot;</span>)</span>
<span id="cb817-2"><a href="ch6.html#cb817-2" tabindex="-1"></a><span class="do">## [1] NA         &quot;bana&quot;     &quot;banana&quot;   &quot;bananana&quot;</span></span></code></pre></div>
<p>정확한 반복 횟수를 지정하려면 중괄호 <code>{ }</code>를 사용하면 된다.</p>
<ul>
<li><p><code>{n}</code> : 정확히 n번 반복</p></li>
<li><p><code>{n, m}</code> : n번에서 m번 사이 반복</p></li>
<li><p><code>{n,}</code> : n번 이상 반복</p></li>
<li><p><code>{,m}</code> : m번 이하 반복</p></li>
</ul>
<p>벡터 <code>words</code>에서 세 개의 자음으로 시작하는 단어는 다음과 같이 찾을 수 있다.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="ch6.html#cb818-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;^[^aeiou]{3}&quot;</span>)</span>
<span id="cb818-2"><a href="ch6.html#cb818-2" tabindex="-1"></a><span class="do">##  [1] &quot;Christ&quot;    &quot;Christmas&quot; &quot;dry&quot;       &quot;fly&quot;       &quot;mrs&quot;       &quot;scheme&quot;   </span></span>
<span id="cb818-3"><a href="ch6.html#cb818-3" tabindex="-1"></a><span class="do">##  [7] &quot;school&quot;    &quot;straight&quot;  &quot;strategy&quot;  &quot;street&quot;    &quot;strike&quot;    &quot;strong&quot;   </span></span>
<span id="cb818-4"><a href="ch6.html#cb818-4" tabindex="-1"></a><span class="do">## [13] &quot;structure&quot; &quot;system&quot;    &quot;three&quot;     &quot;through&quot;   &quot;throw&quot;     &quot;try&quot;      </span></span>
<span id="cb818-5"><a href="ch6.html#cb818-5" tabindex="-1"></a><span class="do">## [19] &quot;type&quot;      &quot;why&quot;</span></span></code></pre></div>
<p>세 개 이상의 모음이 연속으로 있는 단어는 다음과 같이 찾을 수 있다.</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="ch6.html#cb819-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;[aeiou]{3,}&quot;</span>)</span>
<span id="cb819-2"><a href="ch6.html#cb819-2" tabindex="-1"></a><span class="do">## [1] &quot;beauty&quot;   &quot;obvious&quot;  &quot;previous&quot; &quot;quiet&quot;    &quot;serious&quot;  &quot;various&quot;</span></span></code></pre></div>
<p>모음-자음의 쌍이 세 번 이상 연속으로 나타나는 단어는 다음과 같이 찾을 수 있다</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="ch6.html#cb820-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;([aeiou][^aeiou]){3,}&quot;</span>)</span>
<span id="cb820-2"><a href="ch6.html#cb820-2" tabindex="-1"></a><span class="do">##  [1] &quot;america&quot;    &quot;benefit&quot;    &quot;business&quot;   &quot;definite&quot;   &quot;develop&quot;   </span></span>
<span id="cb820-3"><a href="ch6.html#cb820-3" tabindex="-1"></a><span class="do">##  [6] &quot;document&quot;   &quot;economy&quot;    &quot;educate&quot;    &quot;eleven&quot;     &quot;evening&quot;   </span></span>
<span id="cb820-4"><a href="ch6.html#cb820-4" tabindex="-1"></a><span class="do">## [11] &quot;evidence&quot;   &quot;general&quot;    &quot;holiday&quot;    &quot;however&quot;    &quot;imagine&quot;   </span></span>
<span id="cb820-5"><a href="ch6.html#cb820-5" tabindex="-1"></a><span class="do">## [16] &quot;operate&quot;    &quot;original&quot;   &quot;particular&quot; &quot;politic&quot;    &quot;positive&quot;  </span></span>
<span id="cb820-6"><a href="ch6.html#cb820-6" tabindex="-1"></a><span class="do">## [21] &quot;separate&quot;   &quot;similar&quot;    &quot;specific&quot;   &quot;television&quot; &quot;therefore&quot; </span></span>
<span id="cb820-7"><a href="ch6.html#cb820-7" tabindex="-1"></a><span class="do">## [26] &quot;university&quot;</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><code>( )</code>: 그룹 지정 및 재참조(backreference)</li>
</ol>
<p>괄호는 문자 <code>|</code>와 패턴의 우선 순위를 조절하기 위하여 패턴의 그룹을 구성할 때 사용됐고,
문자 <code>+</code> 또는 <code>*</code> 등의 반복 연산자의 경우에도 반복 대상이 되는 패턴을 그룹으로 구성할 때 사용됐다.
이와 같이 그룹을 구성하는 것은 나름의 목적이 있는 것이지만, 또 다른 이점은 그룹으로 구성된 패턴을 재참조할 수 있다는 점이다.
재참조는 매치된 패턴을 반복할 때 매우 유용하게 사용되는 것으로써, 재참조의 표현식은 <code>\1</code>, <code>\2</code> 등으로 나타낼 수 있다.
여기서 <code>\1</code>은 첫 번째 매치된 패턴의 그룹을, 그리고 <code>\2</code>은 두 번째 매치된 패턴의 그룹을 각각 의미한다.</p>
<p>예를 들어 벡터 <code>fruit</code>에서 한 개의 문자가 두 번 반복해서 나타나는 과일 이름은 다음과 같이 찾을 수 있다.
<code>"(.)"</code>으로 매치된 한 문자를 <code>"\\1"</code>로 재참조, 즉 동일한 문자를 다시 매치하는 패턴을 구성하여, 한 개의 문자가 두 번 반복해서 나타나는 문자열을 찾아낸 것이다.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="ch6.html#cb821-1" tabindex="-1"></a><span class="fu">str_subset</span>(fruit, <span class="st">&quot;(.)</span><span class="sc">\\</span><span class="st">1&quot;</span>)</span>
<span id="cb821-2"><a href="ch6.html#cb821-2" tabindex="-1"></a><span class="do">##  [1] &quot;apple&quot;             &quot;bell pepper&quot;       &quot;bilberry&quot;         </span></span>
<span id="cb821-3"><a href="ch6.html#cb821-3" tabindex="-1"></a><span class="do">##  [4] &quot;blackberry&quot;        &quot;blackcurrant&quot;      &quot;blood orange&quot;     </span></span>
<span id="cb821-4"><a href="ch6.html#cb821-4" tabindex="-1"></a><span class="do">##  [7] &quot;blueberry&quot;         &quot;boysenberry&quot;       &quot;cherry&quot;           </span></span>
<span id="cb821-5"><a href="ch6.html#cb821-5" tabindex="-1"></a><span class="do">## [10] &quot;chili pepper&quot;      &quot;cloudberry&quot;        &quot;cranberry&quot;        </span></span>
<span id="cb821-6"><a href="ch6.html#cb821-6" tabindex="-1"></a><span class="do">## [13] &quot;currant&quot;           &quot;eggplant&quot;          &quot;elderberry&quot;       </span></span>
<span id="cb821-7"><a href="ch6.html#cb821-7" tabindex="-1"></a><span class="do">## [16] &quot;goji berry&quot;        &quot;gooseberry&quot;        &quot;huckleberry&quot;      </span></span>
<span id="cb821-8"><a href="ch6.html#cb821-8" tabindex="-1"></a><span class="do">## [19] &quot;lychee&quot;            &quot;mulberry&quot;          &quot;passionfruit&quot;     </span></span>
<span id="cb821-9"><a href="ch6.html#cb821-9" tabindex="-1"></a><span class="do">## [22] &quot;persimmon&quot;         &quot;pineapple&quot;         &quot;purple mangosteen&quot;</span></span>
<span id="cb821-10"><a href="ch6.html#cb821-10" tabindex="-1"></a><span class="do">## [25] &quot;raspberry&quot;         &quot;redcurrant&quot;        &quot;salal berry&quot;      </span></span>
<span id="cb821-11"><a href="ch6.html#cb821-11" tabindex="-1"></a><span class="do">## [28] &quot;strawberry&quot;        &quot;tamarillo&quot;</span></span></code></pre></div>
<p>두 개의 문자가 두 번 반복해서 나타나는 과일 이름은 다음과 같이 찾을 수 있다.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="ch6.html#cb822-1" tabindex="-1"></a><span class="fu">str_subset</span>(fruit, <span class="st">&quot;(..)</span><span class="sc">\\</span><span class="st">1&quot;</span>)</span>
<span id="cb822-2"><a href="ch6.html#cb822-2" tabindex="-1"></a><span class="do">## [1] &quot;banana&quot;      &quot;coconut&quot;     &quot;cucumber&quot;    &quot;jujube&quot;      &quot;papaya&quot;     </span></span>
<span id="cb822-3"><a href="ch6.html#cb822-3" tabindex="-1"></a><span class="do">## [6] &quot;salal berry&quot;</span></span></code></pre></div>
<p>벡터 <code>words</code>에서 첫 글자와 마지막 글자가 같은 글자인 단어는 다음과 같이 찾을 수 있다.</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="ch6.html#cb823-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;^(.).*</span><span class="sc">\\</span><span class="st">1$&quot;</span>)</span>
<span id="cb823-2"><a href="ch6.html#cb823-2" tabindex="-1"></a><span class="do">##  [1] &quot;america&quot;    &quot;area&quot;       &quot;dad&quot;        &quot;dead&quot;       &quot;depend&quot;    </span></span>
<span id="cb823-3"><a href="ch6.html#cb823-3" tabindex="-1"></a><span class="do">##  [6] &quot;educate&quot;    &quot;else&quot;       &quot;encourage&quot;  &quot;engine&quot;     &quot;europe&quot;    </span></span>
<span id="cb823-4"><a href="ch6.html#cb823-4" tabindex="-1"></a><span class="do">## [11] &quot;evidence&quot;   &quot;example&quot;    &quot;excuse&quot;     &quot;exercise&quot;   &quot;expense&quot;   </span></span>
<span id="cb823-5"><a href="ch6.html#cb823-5" tabindex="-1"></a><span class="do">## [16] &quot;experience&quot; &quot;eye&quot;        &quot;health&quot;     &quot;high&quot;       &quot;knock&quot;     </span></span>
<span id="cb823-6"><a href="ch6.html#cb823-6" tabindex="-1"></a><span class="do">## [21] &quot;level&quot;      &quot;local&quot;      &quot;nation&quot;     &quot;non&quot;        &quot;rather&quot;    </span></span>
<span id="cb823-7"><a href="ch6.html#cb823-7" tabindex="-1"></a><span class="do">## [26] &quot;refer&quot;      &quot;remember&quot;   &quot;serious&quot;    &quot;stairs&quot;     &quot;test&quot;      </span></span>
<span id="cb823-8"><a href="ch6.html#cb823-8" tabindex="-1"></a><span class="do">## [31] &quot;tonight&quot;    &quot;transport&quot;  &quot;treat&quot;      &quot;trust&quot;      &quot;window&quot;    </span></span>
<span id="cb823-9"><a href="ch6.html#cb823-9" tabindex="-1"></a><span class="do">## [36] &quot;yesterday&quot;</span></span></code></pre></div>
<p>또한<code>words</code>에서 한 문자가 세 번 이상 사용된 단어는 다음과 같이 찾을 수 있다.</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="ch6.html#cb824-1" tabindex="-1"></a><span class="fu">str_subset</span>(words, <span class="st">&quot;(.).*</span><span class="sc">\\</span><span class="st">1.*</span><span class="sc">\\</span><span class="st">1&quot;</span>)</span>
<span id="cb824-2"><a href="ch6.html#cb824-2" tabindex="-1"></a><span class="do">##  [1] &quot;appropriate&quot; &quot;available&quot;   &quot;believe&quot;     &quot;between&quot;     &quot;business&quot;   </span></span>
<span id="cb824-3"><a href="ch6.html#cb824-3" tabindex="-1"></a><span class="do">##  [6] &quot;degree&quot;      &quot;difference&quot;  &quot;discuss&quot;     &quot;eleven&quot;      &quot;environment&quot;</span></span>
<span id="cb824-4"><a href="ch6.html#cb824-4" tabindex="-1"></a><span class="do">## [11] &quot;evidence&quot;    &quot;exercise&quot;    &quot;expense&quot;     &quot;experience&quot;  &quot;individual&quot; </span></span>
<span id="cb824-5"><a href="ch6.html#cb824-5" tabindex="-1"></a><span class="do">## [16] &quot;paragraph&quot;   &quot;receive&quot;     &quot;remember&quot;    &quot;represent&quot;   &quot;telephone&quot;  </span></span>
<span id="cb824-6"><a href="ch6.html#cb824-6" tabindex="-1"></a><span class="do">## [21] &quot;therefore&quot;   &quot;tomorrow&quot;</span></span></code></pre></div>
</div>
</div>
<div id="연습문제-4" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> 연습문제<a href="ch6.html#연습문제-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>1.</strong> 패키지 <code>stringr</code>의 <code>fruit</code>은 80 종류 과일 이름으로 구성된 문자형 벡터이다.</p>
<ul>
<li><p>이름에 “berry”가 들어 있는 과일을 <code>fruit</code>에서 찾아 모두 출력해 보자.</p></li>
<li><p>이름에 “berry”가 들어 있는 과일 중에는 “goji berry”와 같이 “berry”가 앞 글자와 한 칸 떨어져 있는 과일도 포함되어 있다. 이런 과일만을 찾아 모두 출력해 보자.</p></li>
<li><p>이름에 “berry”가 들어 있는 과일 중 “blueberry”와 같이 “berry”가 앞 글자와 붙어 있는 과일만을 찾아 모두 출력해 보자.</p></li>
<li><p><code>fruit</code>에서 이름이 가장 긴 과일은 무엇인가? 단, 빈 칸도 이름에 포함되는 것으로 본다.</p></li>
</ul>
<p><strong>2.</strong> 패키지 <code>stringr</code>에 있는 문자형 벡터 <code>sentences</code>에는 720개의 문장이 문자열로 입력되어 있다. 처음 세 문장은 다음과 같다.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="ch6.html#cb825-1" tabindex="-1"></a>sentences[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb825-2"><a href="ch6.html#cb825-2" tabindex="-1"></a><span class="do">## [1] &quot;The birch canoe slid on the smooth planks.&quot; </span></span>
<span id="cb825-3"><a href="ch6.html#cb825-3" tabindex="-1"></a><span class="do">## [2] &quot;Glue the sheet to the dark blue background.&quot;</span></span>
<span id="cb825-4"><a href="ch6.html#cb825-4" tabindex="-1"></a><span class="do">## [3] &quot;It&#39;s easy to tell the depth of a well.&quot;</span></span></code></pre></div>
<ul>
<li>벡터 <code>sentences</code>에 있는 모든 구두점(마침표, 쉼표 등)을 제거하고, 단어별로 분리한 결과를 새로운 벡터 <code>sentences_1</code>에 할당하라. 처음 10개 단어는 다음과 같다.</li>
</ul>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="ch6.html#cb826-1" tabindex="-1"></a>sentences_1[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb826-2"><a href="ch6.html#cb826-2" tabindex="-1"></a><span class="do">##  [1] &quot;The&quot;    &quot;birch&quot;  &quot;canoe&quot;  &quot;slid&quot;   &quot;on&quot;     &quot;the&quot;    &quot;smooth&quot; &quot;planks&quot;</span></span>
<span id="cb826-3"><a href="ch6.html#cb826-3" tabindex="-1"></a><span class="do">##  [9] &quot;Glue&quot;   &quot;the&quot;</span></span></code></pre></div>
<ul>
<li>벡터 <code>sentences_1</code>를 구성하고 있는 단어의 빈도를 계산하고자 한다. 단어를 모두 소문자로 변환하고, 단어별 빈도를 계산해서 가장 빈도가 높은 다섯 단어를 다음과 같이 출력하라.</li>
</ul>
<pre><code>## # A tibble: 1,889 × 2
##   value     n
##   &lt;chr&gt; &lt;int&gt;
## 1 the     744
## 2 a       213
## 3 of      132
## 4 to      123
## 5 and     118
## # ℹ 1,884 more rows</code></pre>
<ul>
<li>불용어(stop word)는 ‘the’, ‘a’, ‘is’ 등과 같이 문장을 구성하는 필수 요소이지만 문맥적으로 큰 의미가 없는 단어를 의미한다. 불용어의 리스트는 패키지 <code>tidytext</code>에 있는 데이터 프레임 <code>stop_words</code>의 첫 번째 변수 <code>word</code>에 입력되어 있다. 패키지 <code>tidytext</code>를 설치해서 불용어 리스트를 획득하고, 그것을 이용하여 앞 문제에서 이루어진 작업 결과 중 불용어를 제거한 후 가장 빈도가 높은 다섯 단어를 선정하라.</li>
</ul>
<p><strong>3.</strong> 함수 <code>colors()</code>를 실행하면 657개의 색 이름 문자형 벡터가 출력되는데, 그것을 <code>color_1</code>에 할당하라. 처음 10개 요소는 다음과 같다.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="ch6.html#cb828-1" tabindex="-1"></a>color_1[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb828-2"><a href="ch6.html#cb828-2" tabindex="-1"></a><span class="do">##  [1] &quot;white&quot;         &quot;aliceblue&quot;     &quot;antiquewhite&quot;  &quot;antiquewhite1&quot;</span></span>
<span id="cb828-3"><a href="ch6.html#cb828-3" tabindex="-1"></a><span class="do">##  [5] &quot;antiquewhite2&quot; &quot;antiquewhite3&quot; &quot;antiquewhite4&quot; &quot;aquamarine&quot;   </span></span>
<span id="cb828-4"><a href="ch6.html#cb828-4" tabindex="-1"></a><span class="do">##  [9] &quot;aquamarine1&quot;   &quot;aquamarine2&quot;</span></span></code></pre></div>
<ul>
<li><p>벡터 <code>color_1</code>를 구성하고 있는 색 이름 중에는 숫자로 끝나는 색 이름이 있다. 이러한 색 이름만 선택해서 벡터 <code>color_2</code>에 할당하라. 모두 몇 종류의 색이 있는가?</p></li>
<li><p>벡터 <code>color_2</code>의 색 이름 중 <code>grey</code>색은 <code>grey0</code>부터 <code>grey100</code>까지 101 종류가 있고, <code>gray</code>색도 <code>gray0</code>부터 <code>gray100</code>까지 101 종류가 있다. 이 두 종류의 색을 <code>color_2</code>에서 모두 제거하라. 몇 종류의 색이 <code>color_2</code>에 남아 있는가?</p></li>
<li><p>벡터 <code>color_1</code>를 구성하고 있는 색 이름에서 숫자로 끝나는 색 이름을 모두 제거하고 벡터 <code>color_3</code>에 할당하라. 모두 몇 종류의 색이 <code>color_3</code>에 있는가?</p></li>
<li><p>벡터 <code>color_3</code>에 있는 색 이름 중 벡터 <code>fruit</code>에 있는 과일 이름과 같은 색 이름은 무엇인가?</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-programming.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
